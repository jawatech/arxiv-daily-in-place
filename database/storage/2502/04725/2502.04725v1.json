{"2502.04725": {"publish_time": "2025-02-07", "title": "Can Diffusion Models Learn Hidden Inter-Feature Rules Behind Images?", "paper_summary": "Despite the remarkable success of diffusion models (DMs) in data generation,\nthey exhibit specific failure cases with unsatisfactory outputs. We focus on\none such limitation: the ability of DMs to learn hidden rules between image\nfeatures. Specifically, for image data with dependent features ($\\mathbf{x}$)\nand ($\\mathbf{y}$) (e.g., the height of the sun ($\\mathbf{x}$) and the length\nof the shadow ($\\mathbf{y}$)), we investigate whether DMs can accurately\ncapture the inter-feature rule ($p(\\mathbf{y}|\\mathbf{x})$). Empirical\nevaluations on mainstream DMs (e.g., Stable Diffusion 3.5) reveal consistent\nfailures, such as inconsistent lighting-shadow relationships and mismatched\nobject-mirror reflections. Inspired by these findings, we design four synthetic\ntasks with strongly correlated features to assess DMs' rule-learning abilities.\nExtensive experiments show that while DMs can identify coarse-grained rules,\nthey struggle with fine-grained ones. Our theoretical analysis demonstrates\nthat DMs trained via denoising score matching (DSM) exhibit constant errors in\nlearning hidden rules, as the DSM objective is not compatible with rule\nconformity. To mitigate this, we introduce a common technique - incorporating\nadditional classifier guidance during sampling, which achieves (limited)\nimprovements. Our analysis reveals that the subtle signals of fine-grained\nrules are challenging for the classifier to capture, providing insights for\nfuture exploration.", "paper_summary_zh": "\u5118\u7ba1\u64f4\u6563\u6a21\u578b (DM) \u5728\u8cc7\u6599\u751f\u6210\u65b9\u9762\u53d6\u5f97\u986f\u8457\u7684\u6210\u529f\uff0c\u4f46\u5b83\u5011\u6703\u51fa\u73fe\u7279\u5b9a\u5931\u6557\u6848\u4f8b\uff0c\u7522\u751f\u4e0d\u4ee4\u4eba\u6eff\u610f\u7684\u8f38\u51fa\u3002\u6211\u5011\u5c08\u6ce8\u65bc\u5176\u4e2d\u4e00\u500b\u9650\u5236\uff1aDM \u5b78\u7fd2\u5f71\u50cf\u7279\u5fb5\u4e4b\u9593\u96b1\u85cf\u898f\u5247\u7684\u80fd\u529b\u3002\u5177\u9ad4\u4f86\u8aaa\uff0c\u5c0d\u65bc\u5177\u6709\u4f9d\u8cf4\u7279\u5fb5 ($\\mathbf{x}$) \u548c ($\\mathbf{y}$) \u7684\u5f71\u50cf\u8cc7\u6599\uff08\u4f8b\u5982\uff0c\u592a\u967d\u9ad8\u5ea6 ($\\mathbf{x}$) \u548c\u9670\u5f71\u9577\u5ea6 ($\\mathbf{y}$\uff09\uff09\uff0c\u6211\u5011\u63a2\u8a0e DM \u662f\u5426\u80fd\u6e96\u78ba\u6355\u6349\u7279\u5fb5\u9593\u898f\u5247 ($p(\\mathbf{y}|\\mathbf{x})$)\u3002\u5c0d\u4e3b\u6d41 DM\uff08\u4f8b\u5982 Stable Diffusion 3.5\uff09\u7684\u7d93\u9a57\u8a55\u4f30\u63ed\u793a\u4e86\u4e00\u81f4\u7684\u5931\u6557\uff0c\u4f8b\u5982\u4e0d\u4e00\u81f4\u7684\u5149\u5f71\u95dc\u4fc2\u548c\u4e0d\u5339\u914d\u7684\u7269\u9ad4\u93e1\u50cf\u53cd\u5c04\u3002\u53d7\u9019\u4e9b\u767c\u73fe\u7684\u555f\u767c\uff0c\u6211\u5011\u8a2d\u8a08\u4e86\u56db\u9805\u5177\u6709\u5f37\u76f8\u95dc\u7279\u5fb5\u7684\u5408\u6210\u4efb\u52d9\uff0c\u4ee5\u8a55\u4f30 DM \u7684\u898f\u5247\u5b78\u7fd2\u80fd\u529b\u3002\u5927\u91cf\u7684\u5be6\u9a57\u8868\u660e\uff0c\u96d6\u7136 DM \u53ef\u4ee5\u8b58\u5225\u7c97\u7565\u7684\u898f\u5247\uff0c\u4f46\u5b83\u5011\u96e3\u4ee5\u61c9\u4ed8\u7d30\u7dfb\u7684\u898f\u5247\u3002\u6211\u5011\u7684\u7406\u8ad6\u5206\u6790\u8868\u660e\uff0c\u900f\u904e\u53bb\u566a\u5206\u6578\u5339\u914d (DSM) \u8a13\u7df4\u7684 DM \u5728\u5b78\u7fd2\u96b1\u85cf\u898f\u5247\u6642\u6703\u51fa\u73fe\u6046\u5b9a\u8aa4\u5dee\uff0c\u56e0\u70ba DSM \u76ee\u6a19\u8207\u898f\u5247\u4e00\u81f4\u6027\u4e0d\u76f8\u5bb9\u3002\u70ba\u4e86\u6e1b\u8f15\u9019\u500b\u554f\u984c\uff0c\u6211\u5011\u5f15\u5165\u4e86\u4e00\u7a2e\u5e38\u898b\u7684\u6280\u8853 - \u5728\u63a1\u6a23\u671f\u9593\u52a0\u5165\u984d\u5916\u7684\u5206\u985e\u5668\u6307\u5c0e\uff0c\u9019\u5be6\u73fe\u4e86\uff08\u6709\u9650\u7684\uff09\u6539\u9032\u3002\u6211\u5011\u7684\u5206\u6790\u8868\u660e\uff0c\u7d30\u7dfb\u898f\u5247\u7684\u5fae\u5999\u8a0a\u865f\u5c0d\u65bc\u5206\u985e\u5668\u4f86\u8aaa\u5f88\u96e3\u6355\u6349\uff0c\u9019\u70ba\u672a\u4f86\u7684\u63a2\u7d22\u63d0\u4f9b\u4e86\u898b\u89e3\u3002", "author": "Yujin Han et.al.", "authors": "Yujin Han, Andi Han, Wei Huang, Chaochao Lu, Difan Zou", "id": "2502.04725v1", "paper_url": "http://arxiv.org/abs/2502.04725v1", "repo": "null"}}