{"2411.15100": {"publish_time": "2024-11-22", "title": "XGrammar: Flexible and Efficient Structured Generation Engine for Large Language Models", "paper_summary": "The applications of LLM Agents are becoming increasingly complex and diverse,\nleading to a high demand for structured outputs that can be parsed into code,\nstructured function calls, and embodied agent commands. These developments\nbring significant demands for structured generation in LLM inference.\nContext-free grammar is a flexible approach to enable structured generation via\nconstrained decoding. However, executing context-free grammar requires going\nthrough several stack states over all tokens in vocabulary during runtime,\nbringing non-negligible overhead for structured generation. In this paper, we\npropose XGrammar, a flexible and efficient structure generation engine for\nlarge language models. XGrammar accelerates context-free grammar execution by\ndividing the vocabulary into context-independent tokens that can be prechecked\nand context-dependent tokens that need to be interpreted during runtime. We\nfurther build transformations to expand the grammar context and reduce the\nnumber of context-independent tokens. Additionally, we build an efficient\npersistent stack to accelerate the context-dependent token checks. Finally, we\nco-design the grammar engine with LLM inference engine to overlap grammar\ncomputation with GPU executions. Evaluation results show that XGrammar can\nachieve up to 100x speedup over existing solutions. Combined with an LLM\ninference engine, it can generate near-zero overhead structure generation in\nend-to-end low-LLM serving.", "paper_summary_zh": "LLM \u4ee3\u7406\u7684\u61c9\u7528\u8d8a\u4f86\u8d8a\u8907\u96dc\u4e14\u591a\u5143\uff0c\n\u5c0e\u81f4\u5c0d\u53ef\u89e3\u6790\u6210\u7a0b\u5f0f\u78bc\u3001\u7d50\u69cb\u5316\u51fd\u5f0f\u547c\u53eb\u548c\u5177\u9ad4\u4ee3\u7406\u6307\u4ee4\u7684\u7d50\u69cb\u5316\u8f38\u51fa\u7684\u9700\u6c42\u5f88\u9ad8\u3002\u9019\u4e9b\u767c\u5c55\u5c0d LLM \u63a8\u8ad6\u4e2d\u7684\u7d50\u69cb\u5316\u7522\u751f\u986f\u8457\u9700\u6c42\u3002\n\u7121\u4e0a\u4e0b\u6587\u8a9e\u6cd5\u662f\u4e00\u7a2e\u9748\u6d3b\u7684\u65b9\u6cd5\uff0c\u53ef\u900f\u904e\u53d7\u9650\u89e3\u78bc\u555f\u7528\u7d50\u69cb\u5316\u7522\u751f\u3002\u7136\u800c\uff0c\u57f7\u884c\u7121\u4e0a\u4e0b\u6587\u8a9e\u6cd5\u9700\u8981\u5728\u57f7\u884c\u671f\u9593\u904d\u6b77\u8a5e\u5f59\u8868\u4e2d\u6240\u6709\u7b26\u865f\u7684\u5e7e\u500b\u5806\u758a\u72c0\u614b\uff0c\u70ba\u7d50\u69cb\u5316\u7522\u751f\u5e36\u4f86\u4e0d\u53ef\u5ffd\u8996\u7684\u8ca0\u64d4\u3002\u5728\u672c\u6587\u4e2d\uff0c\u6211\u5011\u63d0\u51fa XGrammar\uff0c\u9019\u662f\u4e00\u500b\u5927\u578b\u8a9e\u8a00\u6a21\u578b\u7684\u9748\u6d3b\u4e14\u9ad8\u6548\u7684\u7d50\u69cb\u7522\u751f\u5f15\u64ce\u3002XGrammar \u900f\u904e\u5c07\u8a5e\u5f59\u8868\u5206\u70ba\u53ef\u5728\u9810\u5148\u6aa2\u67e5\u7684\u8207\u8a9e\u5883\u7121\u95dc\u7684\u7b26\u865f\u548c\u9700\u8981\u5728\u57f7\u884c\u671f\u9593\u89e3\u91cb\u7684\u8207\u8a9e\u5883\u76f8\u95dc\u7684\u7b26\u865f\uff0c\u52a0\u901f\u7121\u4e0a\u4e0b\u6587\u8a9e\u6cd5\u7684\u57f7\u884c\u3002\u6211\u5011\u9032\u4e00\u6b65\u5efa\u7acb\u8f49\u63db\u4ee5\u64f4\u5145\u8a9e\u6cd5\u8a9e\u5883\u4e26\u6e1b\u5c11\u8207\u8a9e\u5883\u7121\u95dc\u7684\u7b26\u865f\u6578\u91cf\u3002\u6b64\u5916\uff0c\u6211\u5011\u5efa\u7acb\u4e00\u500b\u9ad8\u6548\u7684\u6301\u7e8c\u5806\u758a\uff0c\u4ee5\u52a0\u901f\u8207\u8a9e\u5883\u76f8\u95dc\u7684\u7b26\u865f\u6aa2\u67e5\u3002\u6700\u5f8c\uff0c\u6211\u5011\u5c07\u8a9e\u6cd5\u5f15\u64ce\u8207 LLM \u63a8\u8ad6\u5f15\u64ce\u5171\u540c\u8a2d\u8a08\uff0c\u8b93\u8a9e\u6cd5\u904b\u7b97\u8207 GPU \u57f7\u884c\u91cd\u758a\u3002\u8a55\u4f30\u7d50\u679c\u986f\u793a\uff0cXGrammar \u53ef\u4ee5\u6bd4\u73fe\u6709\u89e3\u6c7a\u65b9\u6848\u5feb\u4e0a 100 \u500d\u3002\u7d50\u5408 LLM \u63a8\u8ad6\u5f15\u64ce\uff0c\u5b83\u53ef\u4ee5\u5728\u7aef\u5230\u7aef\u7684\u4f4e LLM \u670d\u52d9\u4e2d\u7522\u751f\u8fd1\u4e4e\u96f6\u8ca0\u64d4\u7684\u7d50\u69cb\u7522\u751f\u3002", "author": "Yixin Dong et.al.", "authors": "Yixin Dong, Charlie F. Ruan, Yaxing Cai, Ruihang Lai, Ziyi Xu, Yilong Zhao, Tianqi Chen", "id": "2411.15100v1", "paper_url": "http://arxiv.org/abs/2411.15100v1", "repo": "null"}}