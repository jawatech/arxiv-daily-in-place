{"2502.04567": {"publish_time": "2025-02-06", "title": "Preference Optimization via Contrastive Divergence: Your Reward Model is Secretly an NLL Estimator", "paper_summary": "Existing studies on preference optimization (PO) have centered on\nconstructing pairwise preference data following simple heuristics, such as\nmaximizing the margin between preferred and dispreferred completions based on\nhuman (or AI) ranked scores. However, none of these heuristics has a full\ntheoretical justification. In this work, we develop a novel PO framework that\nprovides theoretical guidance to effectively sample dispreferred completions.\nTo achieve this, we formulate PO as minimizing the negative log-likelihood\n(NLL) of a probability model and propose to estimate its normalization constant\nvia a sampling strategy. As we will demonstrate, these estimative samples can\nact as dispreferred completions in PO. We then select contrastive divergence\n(CD) as the sampling strategy, and propose a novel MC-PO algorithm that applies\nthe Monte Carlo (MC) kernel from CD to sample hard negatives w.r.t. the\nparameterized reward model. Finally, we propose the OnMC-PO algorithm, an\nextension of MC-PO to the online setting. On popular alignment benchmarks,\nMC-PO outperforms existing SOTA baselines, and OnMC-PO leads to further\nimprovement.", "paper_summary_zh": "\u73fe\u6709\u95dc\u65bc\u504f\u597d\u6700\u4f73\u5316 (PO) \u7684\u7814\u7a76\uff0c\u4e3b\u8981\u96c6\u4e2d\u65bc\u5efa\u69cb\u6210\u5c0d\u504f\u597d\u8cc7\u6599\uff0c\u4e26\u9075\u5faa\u7c21\u55ae\u7684\u555f\u767c\u5f0f\u65b9\u6cd5\uff0c\u4f8b\u5982\u6839\u64da\u4eba\u985e (\u6216 AI) \u6392\u540d\u7684\u5206\u6578\uff0c\u6700\u5927\u5316\u504f\u597d\u5b8c\u6210\u548c\u975e\u504f\u597d\u5b8c\u6210\u4e4b\u9593\u7684\u908a\u969b\u3002\u7136\u800c\uff0c\u9019\u4e9b\u555f\u767c\u5f0f\u65b9\u6cd5\u90fd\u6c92\u6709\u5b8c\u6574\u7684\u7406\u8ad6\u4f9d\u64da\u3002\u5728\u9019\u9805\u5de5\u4f5c\u4e2d\uff0c\u6211\u5011\u958b\u767c\u4e86\u4e00\u500b\u5275\u65b0\u7684 PO \u67b6\u69cb\uff0c\u63d0\u4f9b\u7406\u8ad6\u6307\u5c0e\uff0c\u4ee5\u6709\u6548\u62bd\u6a23\u975e\u504f\u597d\u5b8c\u6210\u3002\u70ba\u9054\u6210\u6b64\u76ee\u7684\uff0c\u6211\u5011\u5c07 PO \u516c\u5f0f\u5316\u70ba\u6700\u5c0f\u5316\u6a5f\u7387\u6a21\u578b\u7684\u8ca0\u5c0d\u6578\u4f3c\u7136 (NLL)\uff0c\u4e26\u5efa\u8b70\u900f\u904e\u62bd\u6a23\u7b56\u7565\u4f86\u4f30\u8a08\u5176\u6b63\u898f\u5316\u5e38\u6578\u3002\u6b63\u5982\u6211\u5011\u5c07\u5c55\u793a\u7684\uff0c\u9019\u4e9b\u4f30\u8a08\u6a23\u672c\u53ef\u4ee5\u5728 PO \u4e2d\u4f5c\u70ba\u975e\u504f\u597d\u5b8c\u6210\u3002\u7136\u5f8c\uff0c\u6211\u5011\u9078\u64c7\u5c0d\u6bd4\u6563\u5ea6 (CD) \u4f5c\u70ba\u62bd\u6a23\u7b56\u7565\uff0c\u4e26\u63d0\u51fa\u4e00\u500b\u5275\u65b0\u7684 MC-PO \u6f14\u7b97\u6cd5\uff0c\u5c07 CD \u4e2d\u7684\u8499\u5730\u5361\u7f85 (MC) \u6838\u5fc3\u61c9\u7528\u65bc\u62bd\u6a23\u76f8\u5c0d\u65bc\u53c3\u6578\u5316\u734e\u52f5\u6a21\u578b\u7684\u56f0\u96e3\u8ca0\u503c\u3002\u6700\u5f8c\uff0c\u6211\u5011\u63d0\u51fa OnMC-PO \u6f14\u7b97\u6cd5\uff0c\u9019\u662f MC-PO \u5728\u7dda\u4e0a\u8a2d\u5b9a\u4e2d\u7684\u5ef6\u4f38\u3002\u5728\u6d41\u884c\u6bd4\u5c0d\u57fa\u6e96\u4e2d\uff0cMC-PO \u512a\u65bc\u73fe\u6709\u7684 SOTA \u57fa\u6e96\uff0c\u800c OnMC-PO \u9032\u4e00\u6b65\u63d0\u5347\u4e86\u6548\u80fd\u3002", "author": "Zhuotong Chen et.al.", "authors": "Zhuotong Chen, Fang Liu, Xuan Zhu, Yanjun Qi, Mohammad Ghavamzadeh", "id": "2502.04567v1", "paper_url": "http://arxiv.org/abs/2502.04567v1", "repo": "null"}}