{"2404.07815": {"publish_time": "2024-04-11", "title": "Post-Hoc Reversal: Are We Selecting Models Prematurely?", "paper_summary": "Trained models are often composed with post-hoc transforms such as\ntemperature scaling (TS), ensembling and stochastic weight averaging (SWA) to\nimprove performance, robustness, uncertainty estimation, etc. However, such\ntransforms are typically applied only after the base models have already been\nfinalized by standard means. In this paper, we challenge this practice with an\nextensive empirical study. In particular, we demonstrate a phenomenon that we\ncall post-hoc reversal, where performance trends are reversed after applying\nthese post-hoc transforms. This phenomenon is especially prominent in\nhigh-noise settings. For example, while base models overfit badly early in\ntraining, both conventional ensembling and SWA favor base models trained for\nmore epochs. Post-hoc reversal can also suppress the appearance of double\ndescent and mitigate mismatches between test loss and test error seen in base\nmodels. Based on our findings, we propose post-hoc selection, a simple\ntechnique whereby post-hoc metrics inform model development decisions such as\nearly stopping, checkpointing, and broader hyperparameter choices. Our\nexperimental analyses span real-world vision, language, tabular and graph\ndatasets from domains like satellite imaging, language modeling, census\nprediction and social network analysis. On an LLM instruction tuning dataset,\npost-hoc selection results in > 1.5x MMLU improvement compared to naive\nselection. Code is available at\nhttps://github.com/rishabh-ranjan/post-hoc-reversal.", "paper_summary_zh": "\u8bad\u7ec3\u540e\u7684\u6a21\u578b\u901a\u5e38\u7531\u4e8b\u540e\u8f6c\u6362\uff08\u4f8b\u5982\u6e29\u5ea6\u7f29\u653e (TS)\u3001\u96c6\u6210\u548c\u968f\u673a\u6743\u91cd\u5e73\u5747 (SWA)\uff09\u7ec4\u6210\uff0c\u4ee5\u63d0\u9ad8\u6027\u80fd\u3001\u9c81\u68d2\u6027\u3001\u4e0d\u786e\u5b9a\u6027\u4f30\u8ba1\u7b49\u3002\u7136\u800c\uff0c\u6b64\u7c7b\u8f6c\u6362\u901a\u5e38\u4ec5\u5728\u57fa\u7840\u6a21\u578b\u5df2\u901a\u8fc7\u6807\u51c6\u65b9\u5f0f\u6700\u7ec8\u786e\u5b9a\u540e\u624d\u5e94\u7528\u3002\u5728\u672c\u6587\u4e2d\uff0c\u6211\u4eec\u901a\u8fc7\u4e00\u9879\u5e7f\u6cdb\u7684\u5b9e\u8bc1\u7814\u7a76\u5bf9\u8fd9\u79cd\u505a\u6cd5\u63d0\u51fa\u4e86\u8d28\u7591\u3002\u7279\u522b\u662f\uff0c\u6211\u4eec\u5c55\u793a\u4e86\u4e00\u79cd\u6211\u4eec\u79f0\u4e4b\u4e3a\u4e8b\u540e\u9006\u8f6c\u7684\u73b0\u8c61\uff0c\u5176\u4e2d\u5728\u5e94\u7528\u8fd9\u4e9b\u4e8b\u540e\u8f6c\u6362\u540e\uff0c\u6027\u80fd\u8d8b\u52bf\u4f1a\u53d1\u751f\u9006\u8f6c\u3002\u8fd9\u79cd\u73b0\u8c61\u5728\u9ad8\u566a\u58f0\u8bbe\u7f6e\u4e2d\u5c24\u4e3a\u7a81\u51fa\u3002\u4f8b\u5982\uff0c\u867d\u7136\u57fa\u7840\u6a21\u578b\u5728\u8bad\u7ec3\u65e9\u671f\u4e25\u91cd\u8fc7\u62df\u5408\uff0c\u4f46\u4f20\u7edf\u7684\u96c6\u6210\u548c SWA \u90fd\u504f\u7231\u8bad\u7ec3\u66f4\u591a\u4e2a epoch \u7684\u57fa\u7840\u6a21\u578b\u3002\u4e8b\u540e\u9006\u8f6c\u8fd8\u53ef\u4ee5\u6291\u5236\u53cc\u91cd\u4e0b\u964d\u7684\u51fa\u73b0\uff0c\u5e76\u51cf\u8f7b\u57fa\u7840\u6a21\u578b\u4e2d\u770b\u5230\u7684\u6d4b\u8bd5\u635f\u5931\u548c\u6d4b\u8bd5\u8bef\u5dee\u4e4b\u95f4\u7684\u4e0d\u5339\u914d\u3002\u6839\u636e\u6211\u4eec\u7684\u53d1\u73b0\uff0c\u6211\u4eec\u63d0\u51fa\u4e86\u4e8b\u540e\u9009\u62e9\uff0c\u8fd9\u662f\u4e00\u79cd\u7b80\u5355\u7684\u6280\u672f\uff0c\u5176\u4e2d\u4e8b\u540e\u6307\u6807\u4e3a\u6a21\u578b\u5f00\u53d1\u51b3\u7b56\u63d0\u4f9b\u4fe1\u606f\uff0c\u4f8b\u5982\u63d0\u524d\u505c\u6b62\u3001\u68c0\u67e5\u70b9\u548c\u66f4\u5e7f\u6cdb\u7684\u8d85\u53c2\u6570\u9009\u62e9\u3002\u6211\u4eec\u7684\u5b9e\u9a8c\u5206\u6790\u6db5\u76d6\u4e86\u6765\u81ea\u536b\u661f\u6210\u50cf\u3001\u8bed\u8a00\u5efa\u6a21\u3001\u4eba\u53e3\u666e\u67e5\u9884\u6d4b\u548c\u793e\u4ea4\u7f51\u7edc\u5206\u6790\u7b49\u9886\u57df\u7684\u771f\u5b9e\u4e16\u754c\u89c6\u89c9\u3001\u8bed\u8a00\u3001\u8868\u683c\u548c\u56fe\u5f62\u6570\u636e\u96c6\u3002\u5728 LLM \u6307\u4ee4\u8c03\u6574\u6570\u636e\u96c6\u4e0a\uff0c\u4e0e\u6734\u7d20\u9009\u62e9\u76f8\u6bd4\uff0c\u4e8b\u540e\u9009\u62e9\u5bfc\u81f4 MMLU \u63d0\u5347 > 1.5 \u500d\u3002\u4ee3\u7801\u53ef\u5728 https://github.com/rishabh-ranjan/post-hoc-reversal \u83b7\u5f97\u3002", "author": "Rishabh Ranjan et.al.", "authors": "Rishabh Ranjan, Saurabh Garg, Mrigank Raman, Carlos Guestrin, Zachary Chase Lipton", "id": "2404.07815v1", "paper_url": "http://arxiv.org/abs/2404.07815v1", "repo": "https://github.com/rishabh-ranjan/post-hoc-reversal"}}