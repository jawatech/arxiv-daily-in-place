{"2408.01960": {"publish_time": "2024-08-04", "title": "AnomalySD: Few-Shot Multi-Class Anomaly Detection with Stable Diffusion Model", "paper_summary": "Anomaly detection is a critical task in industrial manufacturing, aiming to\nidentify defective parts of products. Most industrial anomaly detection methods\nassume the availability of sufficient normal data for training. This assumption\nmay not hold true due to the cost of labeling or data privacy policies.\nAdditionally, mainstream methods require training bespoke models for different\nobjects, which incurs heavy costs and lacks flexibility in practice. To address\nthese issues, we seek help from Stable Diffusion (SD) model due to its\ncapability of zero/few-shot inpainting, which can be leveraged to inpaint\nanomalous regions as normal. In this paper, a few-shot multi-class anomaly\ndetection framework that adopts Stable Diffusion model is proposed, named\nAnomalySD. To adapt SD to anomaly detection task, we design different\nhierarchical text descriptions and the foreground mask mechanism for\nfine-tuning SD. In the inference stage, to accurately mask anomalous regions\nfor inpainting, we propose multi-scale mask strategy and prototype-guided mask\nstrategy to handle diverse anomalous regions. Hierarchical text prompts are\nalso utilized to guide the process of inpainting in the inference stage. The\nanomaly score is estimated based on inpainting result of all masks. Extensive\nexperiments on the MVTec-AD and VisA datasets demonstrate the superiority of\nour approach. We achieved anomaly classification and segmentation results of\n93.6%/94.8% AUROC on the MVTec-AD dataset and 86.1%/96.5% AUROC on the VisA\ndataset under multi-class and one-shot settings.", "paper_summary_zh": "\u7570\u5e38\u5075\u6e2c\u662f\u5de5\u696d\u88fd\u9020\u4e2d\u7684\u4e00\u9805\u91cd\u8981\u4efb\u52d9\uff0c\u65e8\u5728\u8b58\u5225\u7522\u54c1\u7684\u7455\u75b5\u90e8\u5206\u3002\u5927\u591a\u6578\u5de5\u696d\u7570\u5e38\u5075\u6e2c\u65b9\u6cd5\u5047\u8a2d\u6709\u8db3\u5920\u7684\u6b63\u5e38\u8cc7\u6599\u53ef\u7528\u65bc\u8a13\u7df4\u3002\u7531\u65bc\u6a19\u8a18\u6216\u8cc7\u6599\u96b1\u79c1\u653f\u7b56\u7684\u6210\u672c\uff0c\u6b64\u5047\u8a2d\u53ef\u80fd\u4e0d\u6210\u7acb\u3002\u6b64\u5916\uff0c\u4e3b\u6d41\u65b9\u6cd5\u9700\u8981\u70ba\u4e0d\u540c\u7684\u7269\u4ef6\u8a13\u7df4\u5ba2\u88fd\u5316\u6a21\u578b\uff0c\u9019\u6703\u7522\u751f\u9ad8\u6602\u7684\u6210\u672c\uff0c\u4e14\u5728\u5be6\u52d9\u4e0a\u7f3a\u4e4f\u5f48\u6027\u3002\u70ba\u4e86\u89e3\u6c7a\u9019\u4e9b\u554f\u984c\uff0c\u6211\u5011\u5c0b\u6c42 Stable Diffusion\uff08SD\uff09\u6a21\u578b\u7684\u5354\u52a9\uff0c\u56e0\u70ba\u5b83\u5177\u6709\u96f6/\u5c11\u6b21\u6578 inpainting \u7684\u80fd\u529b\uff0c\u53ef\u7528\u65bc\u5c07\u7570\u5e38\u5340\u57df inpaint \u70ba\u6b63\u5e38\u3002\u5728\u672c\u6587\u4e2d\uff0c\u63d0\u51fa\u4e86\u4e00\u500b\u63a1\u7528 Stable Diffusion \u6a21\u578b\u7684\u5c11\u6b21\u6578\u591a\u985e\u5225\u7570\u5e38\u5075\u6e2c\u67b6\u69cb\uff0c\u547d\u540d\u70ba AnomalySD\u3002\u70ba\u4e86\u5c07 SD \u8abf\u6574\u70ba\u7570\u5e38\u5075\u6e2c\u4efb\u52d9\uff0c\u6211\u5011\u8a2d\u8a08\u4e86\u4e0d\u540c\u7684\u968e\u5c64\u5f0f\u6587\u5b57\u63cf\u8ff0\u548c\u524d\u666f\u906e\u7f69\u6a5f\u5236\uff0c\u7528\u65bc\u5fae\u8abf SD\u3002\u5728\u63a8\u8ad6\u968e\u6bb5\uff0c\u70ba\u4e86\u6e96\u78ba\u906e\u7f69\u7570\u5e38\u5340\u57df\u4ee5\u9032\u884c inpainting\uff0c\u6211\u5011\u63d0\u51fa\u4e86\u591a\u5c3a\u5ea6\u906e\u7f69\u7b56\u7565\u548c\u539f\u578b\u5f15\u5c0e\u906e\u7f69\u7b56\u7565\u4f86\u8655\u7406\u4e0d\u540c\u7684\u7570\u5e38\u5340\u57df\u3002\u968e\u5c64\u5f0f\u6587\u5b57\u63d0\u793a\u4e5f\u7528\u65bc\u5f15\u5c0e\u63a8\u8ad6\u968e\u6bb5\u7684 inpainting \u7a0b\u5e8f\u3002\u7570\u5e38\u5206\u6578\u662f\u6839\u64da\u6240\u6709\u906e\u7f69\u7684 inpainting \u7d50\u679c\u4f30\u8a08\u7684\u3002\u5728 MVTec-AD \u548c VisA \u8cc7\u6599\u96c6\u4e0a\u7684\u5ee3\u6cdb\u5be6\u9a57\u8b49\u660e\u4e86\u6211\u5011\u65b9\u6cd5\u7684\u512a\u8d8a\u6027\u3002\u5728\u591a\u985e\u5225\u548c\u4e00\u6b21\u6027\u8a2d\u5b9a\u4e0b\uff0c\u6211\u5011\u5728 MVTec-AD \u8cc7\u6599\u96c6\u4e0a\u9054\u5230\u4e86 93.6%/94.8% AUROC \u7684\u7570\u5e38\u5206\u985e\u548c\u5206\u5272\u7d50\u679c\uff0c\u5728 VisA \u8cc7\u6599\u96c6\u4e0a\u9054\u5230\u4e86 86.1%/96.5% AUROC\u3002", "author": "Zhenyu Yan et.al.", "authors": "Zhenyu Yan, Qingqing Fang, Wenxi Lv, Qinliang Su", "id": "2408.01960v1", "paper_url": "http://arxiv.org/abs/2408.01960v1", "repo": "null"}}