{"2407.02819": {"publish_time": "2024-07-03", "title": "Efficient Training of Language Models with Compact and Consistent Next Token Distributions", "paper_summary": "Maximizing the likelihood of the next token is an established, statistically\nsound objective for pre-training language models. In this paper we show that we\ncan train better models faster by pre-aggregating the corpus with a collapsed\n$n$-gram distribution. Previous studies have proposed corpus-level $n$-gram\nstatistics as a regularizer; however, the construction and querying of such\n$n$-grams, if done naively, prove to be costly and significantly impede\ntraining speed, thereby limiting their application in modern large language\nmodel pre-training.\n  We introduce an alternative compact representation of the next token\ndistribution that, in expectation, aligns with the complete $n$-gram\ndistribution while markedly reducing variance across mini-batches compared to\nthe standard next-token loss. Empirically, we demonstrate that both the\n$n$-gram regularized model and our approximation yield substantial improvements\nin model quality and convergence rate compared to existing methods.\nFurthermore, our approximation facilitates scalability of gains to larger\ndatasets and models compared to the straightforward $n$-gram regularization\nmethod.", "paper_summary_zh": "\u6700\u5927\u5316\u4e0b\u4e00\u500b\u7b26\u865f\u7684\u53ef\u80fd\u6027\u662f\u9810\u8a13\u7df4\u8a9e\u8a00\u6a21\u578b\u5df2\u5efa\u7acb\u7684\u3001\u5728\u7d71\u8a08\u4e0a\u5408\u7406\u7684\u76ee\u6a19\u3002\u5728\u672c\u6587\u4e2d\uff0c\u6211\u5011\u5c55\u793a\u4e86\u6211\u5011\u53ef\u4ee5\u900f\u904e\u4f7f\u7528\u6298\u758a\u7684 $n$-gram \u5206\u5e03\u9810\u5148\u5f59\u7e3d\u8a9e\u6599\u5eab\uff0c\u4f86\u66f4\u5feb\u5730\u8a13\u7df4\u51fa\u66f4\u597d\u7684\u6a21\u578b\u3002\u5148\u524d\u7684\u7814\u7a76\u5df2\u63d0\u51fa\u8a9e\u6599\u5eab\u7d1a\u5225\u7684 $n$-gram \u7d71\u8a08\u8cc7\u6599\u4f5c\u70ba\u6b63\u5247\u5316\u5668\uff1b\u7136\u800c\uff0c\u5982\u679c\u5929\u771f\u5730\u9032\u884c\u6b64\u985e $n$-gram \u7684\u5efa\u69cb\u548c\u67e5\u8a62\uff0c\u8b49\u660e\u4ee3\u50f9\u9ad8\u6602\uff0c\u4e14\u6703\u986f\u8457\u963b\u7919\u8a13\u7df4\u901f\u5ea6\uff0c\u5f9e\u800c\u9650\u5236\u5b83\u5011\u5728\u73fe\u4ee3\u5927\u578b\u8a9e\u8a00\u6a21\u578b\u9810\u8a13\u7df4\u4e2d\u7684\u61c9\u7528\u3002\n\u6211\u5011\u5f15\u5165\u4e86\u4e0b\u4e00\u500b\u7b26\u865f\u5206\u4f48\u7684\u66ff\u4ee3\u7dca\u6e4a\u8868\u793a\u6cd5\uff0c\u5728\u9810\u671f\u4e2d\uff0c\u5b83\u8207\u5b8c\u6574\u7684 $n$-gram \u5206\u4f48\u4e00\u81f4\uff0c\u540c\u6642\u986f\u8457\u964d\u4f4e\u4e86\u8207\u6a19\u6e96\u4e0b\u4e00\u500b\u7b26\u865f\u640d\u5931\u76f8\u6bd4\u7684\u8ff7\u4f60\u6279\u6b21\u9593\u7684\u8b8a\u7570\u3002\u7d93\u9a57\u4e0a\uff0c\u6211\u5011\u8b49\u660e\u4e86 $n$-gram \u6b63\u5247\u5316\u6a21\u578b\u548c\u6211\u5011\u7684\u8fd1\u4f3c\u503c\u5728\u6a21\u578b\u54c1\u8cea\u548c\u6536\u6582\u901f\u5ea6\u65b9\u9762\u90fd\u6bd4\u73fe\u6709\u65b9\u6cd5\u6709\u986f\u8457\u6539\u5584\u3002\n\u6b64\u5916\uff0c\u8207\u76f4\u63a5\u7684 $n$-gram \u6b63\u5247\u5316\u65b9\u6cd5\u76f8\u6bd4\uff0c\u6211\u5011\u7684\u8fd1\u4f3c\u503c\u4fc3\u9032\u4e86\u6536\u76ca\u5c0d\u66f4\u5927\u8cc7\u6599\u96c6\u548c\u6a21\u578b\u7684\u53ef\u64f4\u5145\u6027\u3002", "author": "Ashutosh Sathe et.al.", "authors": "Ashutosh Sathe, Sunita Sarawagi", "id": "2407.02819v1", "paper_url": "http://arxiv.org/abs/2407.02819v1", "repo": "null"}}