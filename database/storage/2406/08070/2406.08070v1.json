{"2406.08070": {"publish_time": "2024-06-12", "title": "CFG++: Manifold-constrained Classifier Free Guidance for Diffusion Models", "paper_summary": "Classifier-free guidance (CFG) is a fundamental tool in modern diffusion\nmodels for text-guided generation. Although effective, CFG has notable\ndrawbacks. For instance, DDIM with CFG lacks invertibility, complicating image\nediting; furthermore, high guidance scales, essential for high-quality outputs,\nfrequently result in issues like mode collapse. Contrary to the widespread\nbelief that these are inherent limitations of diffusion models, this paper\nreveals that the problems actually stem from the off-manifold phenomenon\nassociated with CFG, rather than the diffusion models themselves. More\nspecifically, inspired by the recent advancements of diffusion model-based\ninverse problem solvers (DIS), we reformulate text-guidance as an inverse\nproblem with a text-conditioned score matching loss, and develop CFG++, a novel\napproach that tackles the off-manifold challenges inherent in traditional CFG.\nCFG++ features a surprisingly simple fix to CFG, yet it offers significant\nimprovements, including better sample quality for text-to-image generation,\ninvertibility, smaller guidance scales, reduced mode collapse, etc.\nFurthermore, CFG++ enables seamless interpolation between unconditional and\nconditional sampling at lower guidance scales, consistently outperforming\ntraditional CFG at all scales. Experimental results confirm that our method\nsignificantly enhances performance in text-to-image generation, DDIM inversion,\nediting, and solving inverse problems, suggesting a wide-ranging impact and\npotential applications in various fields that utilize text guidance. Project\nPage: https://cfgpp-diffusion.github.io/.", "paper_summary_zh": "<paragraph>\u7121\u5206\u985e\u5668\u5f15\u5c0e (CFG) \u662f\u73fe\u4ee3\u64f4\u6563\u6a21\u578b\u4e2d\u7528\u65bc\u6587\u5b57\u5f15\u5c0e\u751f\u6210\u7684\u57fa\u790e\u5de5\u5177\u3002\u96d6\u7136\u6709\u6548\uff0c\u4f46 CFG \u6709\u986f\u8457\u7684\u7f3a\u9ede\u3002\u4f8b\u5982\uff0c\u5e36\u6709 CFG \u7684 DDIM \u7f3a\u4e4f\u53ef\u9006\u6027\uff0c\u4f7f\u5f71\u50cf\u7de8\u8f2f\u8907\u96dc\u5316\uff1b\u6b64\u5916\uff0c\u5c0d\u65bc\u9ad8\u54c1\u8cea\u8f38\u51fa\u81f3\u95dc\u91cd\u8981\u7684\u9ad8\u5f15\u5c0e\u6bd4\u4f8b\uff0c\u7d93\u5e38\u5c0e\u81f4\u6a21\u5f0f\u5d29\u6f70\u7b49\u554f\u984c\u3002\u8207\u5ee3\u6cdb\u8a8d\u70ba\u9019\u4e9b\u662f\u64f4\u6563\u6a21\u578b\u7684\u56fa\u6709\u9650\u5236\u76f8\u53cd\uff0c\u672c\u6587\u63ed\u793a\u9019\u4e9b\u554f\u984c\u5be6\u969b\u4e0a\u6e90\u81ea\u8207 CFG \u76f8\u95dc\u7684\u6d41\u5f62\u5916\u73fe\u8c61\uff0c\u800c\u4e0d\u662f\u64f4\u6563\u6a21\u578b\u672c\u8eab\u3002\u66f4\u5177\u9ad4\u5730\u8aaa\uff0c\u53d7\u5230\u57fa\u65bc\u64f4\u6563\u6a21\u578b\u7684\u9006\u554f\u984c\u6c42\u89e3\u5668 (DIS) \u7684\u6700\u65b0\u9032\u5c55\u7684\u555f\u767c\uff0c\u6211\u5011\u5c07\u6587\u5b57\u5f15\u5c0e\u91cd\u65b0\u8868\u8ff0\u70ba\u4e00\u500b\u5177\u6709\u6587\u5b57\u689d\u4ef6\u5206\u6578\u5339\u914d\u640d\u5931\u7684\u9006\u554f\u984c\uff0c\u4e26\u958b\u767c\u4e86 CFG++\uff0c\u9019\u662f\u4e00\u7a2e\u65b0\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5\u89e3\u6c7a\u50b3\u7d71 CFG \u4e2d\u56fa\u6709\u7684\u6d41\u5f62\u5916\u6311\u6230\u3002CFG++ \u5c0d CFG \u6709\u4e00\u500b\u9a5a\u4eba\u5730\u7c21\u55ae\u7684\u4fee\u5fa9\uff0c\u4f46\u5b83\u63d0\u4f9b\u4e86\u986f\u8457\u7684\u6539\u9032\uff0c\u5305\u62ec\u6587\u5b57\u8f49\u5f71\u50cf\u751f\u6210\u7684\u66f4\u597d\u7bc4\u672c\u54c1\u8cea\u3001\u53ef\u9006\u6027\u3001\u66f4\u5c0f\u7684\u5f15\u5c0e\u6bd4\u4f8b\u3001\u6e1b\u5c11\u6a21\u5f0f\u5d29\u6f70\u7b49\u3002\u6b64\u5916\uff0cCFG++ \u80fd\u5920\u5728\u8f03\u4f4e\u7684\u5f15\u5c0e\u6bd4\u4f8b\u4e0b\u5728\u7121\u689d\u4ef6\u548c\u689d\u4ef6\u62bd\u6a23\u4e4b\u9593\u9032\u884c\u7121\u7e2b\u63d2\u503c\uff0c\u5728\u6240\u6709\u6bd4\u4f8b\u4e0b\u90fd\u6301\u7e8c\u512a\u65bc\u50b3\u7d71 CFG\u3002\u5be6\u9a57\u7d50\u679c\u8b49\u5be6\uff0c\u6211\u5011\u7684\u6a21\u578b\u986f\u8457\u589e\u5f37\u4e86\u6587\u5b57\u8f49\u5f71\u50cf\u751f\u6210\u3001DDIM \u53cd\u6f14\u3001\u7de8\u8f2f\u548c\u89e3\u6c7a\u9006\u554f\u984c\u7684\u6548\u80fd\uff0c\u9019\u8868\u660e\u5728\u5229\u7528\u6587\u5b57\u5f15\u5c0e\u7684\u5404\u500b\u9818\u57df\u4e2d\u5177\u6709\u5ee3\u6cdb\u7684\u5f71\u97ff\u548c\u6f5b\u5728\u61c9\u7528\u3002\u5c08\u6848\u9801\u9762\uff1ahttps://cfgpp-diffusion.github.io/\u3002</paragraph>", "author": "Hyungjin Chung et.al.", "authors": "Hyungjin Chung, Jeongsol Kim, Geon Yeong Park, Hyelin Nam, Jong Chul Ye", "id": "2406.08070v1", "paper_url": "http://arxiv.org/abs/2406.08070v1", "repo": "null"}}