{"2406.03853": {"publish_time": "2024-06-06", "title": "Speculative Decoding via Early-exiting for Faster LLM Inference with Thompson Sampling Control Mechanism", "paper_summary": "The recent advancements in large language models (LLMs) have been\nextraordinary, yet the escalating inference costs associated with them present\nchallenges in real-world applications. To address these challenges, we propose\na novel approach called Early-exiting Speculative Decoding (EESD) with lossless\nacceleration. Specifically, EESD utilizes a segment of the LLM to generate\ndraft tokens, incorporating Early-exiting structures after the first N layers.\nTo enhance the quality of draft tokens, a self-distillation method is\nintegrated. This early-exiting design not only reduces deployment and training\ncosts but also significantly accelerates the token generation speed. Moreover,\nwe introduce a novel sampling mechanism that leverages Thompson Sampling to\nregulate the generation processes, automatically determining the quantity of\ndraft tokens in each round. The original LLM is then employed to validate these\ndraft tokens through a single forward pass, and thus guarantees that the final\noutput text maintains a distribution consistent with vanilla auto-regressive\ndecoding. The experimental results on both 13B and 70B models demonstrate that\nour approach decodes tokens at a markedly accelerated rate compared to prior\nmethods, showing the effectiveness of our approach.", "paper_summary_zh": "\u5927\u578b\u8a9e\u8a00\u6a21\u578b (LLM) \u8fd1\u671f\u7684\u9032\u5c55\u975e\u51e1\uff0c\u4f46\u8207\u4e4b\u76f8\u95dc\u7684\u63a8\u8ad6\u6210\u672c\u4e0d\u65b7\u589e\u52a0\uff0c\u5c0d\u5be6\u969b\u61c9\u7528\u69cb\u6210\u4e86\u6311\u6230\u3002\u70ba\u4e86\u61c9\u5c0d\u9019\u4e9b\u6311\u6230\uff0c\u6211\u5011\u63d0\u51fa\u4e86\u4e00\u7a2e\u540d\u70ba\u65e9\u671f\u9000\u51fa\u63a8\u8ad6\u89e3\u78bc (EESD) \u7684\u65b0\u65b9\u6cd5\uff0c\u5177\u6709\u7121\u640d\u52a0\u901f\u529f\u80fd\u3002\u5177\u9ad4\u4f86\u8aaa\uff0cEESD \u5229\u7528 LLM \u7684\u4e00\u90e8\u5206\u4f86\u751f\u6210\u8349\u7a3f\u4ee3\u5e63\uff0c\u4e26\u5728\u7b2c\u4e00\u500b N \u5c64\u4e4b\u5f8c\u52a0\u5165\u65e9\u671f\u9000\u51fa\u7d50\u69cb\u3002\u70ba\u4e86\u63d0\u9ad8\u8349\u7a3f\u4ee3\u5e63\u7684\u54c1\u8cea\uff0c\u6574\u5408\u4e86\u4e00\u7a2e\u81ea\u84b8\u993e\u65b9\u6cd5\u3002\u9019\u7a2e\u65e9\u671f\u9000\u51fa\u7684\u8a2d\u8a08\u4e0d\u50c5\u964d\u4f4e\u4e86\u90e8\u7f72\u548c\u8a13\u7df4\u6210\u672c\uff0c\u9084\u986f\u8457\u52a0\u5feb\u4e86\u4ee3\u5e63\u751f\u6210\u901f\u5ea6\u3002\u6b64\u5916\uff0c\u6211\u5011\u5f15\u5165\u4e86\u4e00\u7a2e\u65b0\u7a4e\u7684\u62bd\u6a23\u6a5f\u5236\uff0c\u5b83\u5229\u7528 Thompson \u62bd\u6a23\u4f86\u8abf\u7bc0\u751f\u6210\u904e\u7a0b\uff0c\u81ea\u52d5\u78ba\u5b9a\u6bcf\u4e00\u8f2a\u4e2d\u8349\u7a3f\u4ee3\u5e63\u7684\u6578\u91cf\u3002\u7136\u5f8c\u4f7f\u7528\u539f\u59cb LLM \u901a\u904e\u55ae\u6b21\u524d\u5411\u50b3\u905e\u4f86\u9a57\u8b49\u9019\u4e9b\u8349\u7a3f\u4ee3\u5e63\uff0c\u5f9e\u800c\u4fdd\u8b49\u6700\u7d42\u8f38\u51fa\u6587\u672c\u4fdd\u6301\u8207\u9999\u8349\u81ea\u8ff4\u6b78\u89e3\u78bc\u4e00\u81f4\u7684\u5206\u5e03\u3002\u5728 13B \u548c 70B \u6a21\u578b\u4e0a\u7684\u5be6\u9a57\u7d50\u679c\u8868\u660e\uff0c\u8207\u5148\u524d\u7684\u6280\u8853\u76f8\u6bd4\uff0c\u6211\u5011\u7684\u6280\u8853\u4ee5\u986f\u8457\u52a0\u901f\u7684\u901f\u5ea6\u89e3\u78bc\u4ee3\u5e63\uff0c\u986f\u793a\u4e86\u6211\u5011\u6280\u8853\u7684\u6709\u6548\u6027\u3002", "author": "Jiahao Liu et.al.", "authors": "Jiahao Liu, Qifan Wang, Jingang Wang, Xunliang Cai", "id": "2406.03853v1", "paper_url": "http://arxiv.org/abs/2406.03853v1", "repo": "null"}}