{"2407.08103": {"publish_time": "2024-07-11", "title": "Automata-based constraints for language model decoding", "paper_summary": "LMs are often expected to generate strings in some formal language; for\nexample, structured data, API calls, or code snippets. Although LMs can be\ntuned to improve their adherence to formal syntax, this does not guarantee\nconformance, especially with smaller LMs suitable for large-scale deployment.\nIn addition, tuning requires significant resources, making it impractical for\nuncommon or task-specific formats. To prevent downstream parsing errors we\nwould ideally constrain the LM to only produce valid output, but this is\nseverely complicated by tokenization, which is typically both ambiguous and\nmisaligned with the formal grammar. We solve these issues through the\napplication of automata theory, deriving an efficient closed-form solution for\nthe regular languages, a broad class of formal languages with many practical\napplications, including API calls or schema-guided JSON and YAML. We also\ndiscuss pragmatic extensions for coping with the issue of high branching\nfactor. Finally, we extend our techniques to deterministic context-free\nlanguages, which similarly admit an efficient closed-form solution. In spite of\nits flexibility and representative power, our approach only requires access to\nper-token decoding logits and lowers into simple calculations that are\nindependent of LM size, making it both efficient and easy to apply to almost\nany LM architecture.", "paper_summary_zh": "\u8a9e\u8a00\u6a21\u578b\u901a\u5e38\u6703\u88ab\u671f\u5f85\u7522\u751f\u4e00\u4e9b\u5f62\u5f0f\u8a9e\u8a00\u7684\u5b57\u4e32\uff1b\u4f8b\u5982\u7d50\u69cb\u5316\u8cc7\u6599\u3001API \u547c\u53eb\u6216\u7a0b\u5f0f\u78bc\u7247\u6bb5\u3002\u96d6\u7136\u8a9e\u8a00\u6a21\u578b\u53ef\u4ee5\u8abf\u6574\u4ee5\u6539\u5584\u5b83\u5011\u5c0d\u5f62\u5f0f\u8a9e\u6cd5\u7684\u9075\u5faa\uff0c\u9019\u4e26\u4e0d\u4fdd\u8b49\u76f8\u5bb9\u6027\uff0c\u7279\u5225\u662f\u5c0d\u65bc\u9069\u5408\u5927\u898f\u6a21\u90e8\u7f72\u7684\u5c0f\u578b\u8a9e\u8a00\u6a21\u578b\u3002\u6b64\u5916\uff0c\u8abf\u6574\u9700\u8981\u5927\u91cf\u7684\u8cc7\u6e90\uff0c\u9019\u4f7f\u5f97\u5b83\u5c0d\u65bc\u4e0d\u5e38\u898b\u6216\u7279\u5b9a\u65bc\u4efb\u52d9\u7684\u683c\u5f0f\u4f86\u8aaa\u4e0d\u5207\u5be6\u969b\u3002\u70ba\u4e86\u9632\u6b62\u4e0b\u6e38\u7684\u89e3\u6790\u932f\u8aa4\uff0c\u6211\u5011\u7406\u60f3\u4e0a\u6703\u9650\u5236\u8a9e\u8a00\u6a21\u578b\u53ea\u7522\u751f\u6709\u6548\u7684\u8f38\u51fa\uff0c\u4f46\u9019\u6703\u56e0\u70ba\u901a\u5e38\u6a21\u7a1c\u5169\u53ef\u4e14\u8207\u5f62\u5f0f\u6587\u6cd5\u4e0d\u4e00\u81f4\u7684\u6a19\u8a18\u5316\u800c\u8b8a\u5f97\u975e\u5e38\u8907\u96dc\u3002\u6211\u5011\u900f\u904e\u61c9\u7528\u81ea\u52d5\u6a5f\u7406\u8ad6\u4f86\u89e3\u6c7a\u9019\u4e9b\u554f\u984c\uff0c\u70ba\u6b63\u5247\u8a9e\u8a00\u5c0e\u51fa\u4e00\u500b\u6709\u6548\u7684\u9589\u5408\u5f62\u5f0f\u89e3\uff0c\u6b63\u5247\u8a9e\u8a00\u662f\u5f62\u5f0f\u8a9e\u8a00\u7684\u4e00\u5927\u985e\u5225\uff0c\u6709\u8a31\u591a\u5be6\u969b\u61c9\u7528\uff0c\u5305\u62ec API \u547c\u53eb\u6216\u53d7\u67b6\u69cb\u5f15\u5c0e\u7684 JSON \u548c YAML\u3002\u6211\u5011\u9084\u6703\u8a0e\u8ad6\u7528\u65bc\u61c9\u5c0d\u9ad8\u5206\u652f\u4fc2\u6578\u554f\u984c\u7684\u52d9\u5be6\u64f4\u5145\u3002\u6700\u5f8c\uff0c\u6211\u5011\u5c07\u6211\u5011\u7684\u6280\u8853\u64f4\u5145\u5230\u78ba\u5b9a\u4e0a\u4e0b\u6587\u7121\u95dc\u8a9e\u8a00\uff0c\u5b83\u540c\u6a23\u627f\u8a8d\u4e00\u500b\u6709\u6548\u7684\u9589\u5408\u5f62\u5f0f\u89e3\u3002\u5118\u7ba1\u5177\u6709\u9748\u6d3b\u6027\u8207\u4ee3\u8868\u80fd\u529b\uff0c\u6211\u5011\u7684\u505a\u6cd5\u53ea\u9700\u8981\u5b58\u53d6\u6bcf\u500b\u6a19\u8a18\u7684\u89e3\u78bc logit\uff0c\u4e26\u964d\u4f4e\u70ba\u8207\u8a9e\u8a00\u6a21\u578b\u5927\u5c0f\u7121\u95dc\u7684\u7c21\u55ae\u8a08\u7b97\uff0c\u9019\u4f7f\u5f97\u5b83\u65e2\u6709\u6548\u7387\u53c8\u5bb9\u6613\u61c9\u7528\u65bc\u5e7e\u4e4e\u4efb\u4f55\u8a9e\u8a00\u6a21\u578b\u67b6\u69cb\u3002", "author": "Terry Koo et.al.", "authors": "Terry Koo, Frederick Liu, Luheng He", "id": "2407.08103v1", "paper_url": "http://arxiv.org/abs/2407.08103v1", "repo": "null"}}