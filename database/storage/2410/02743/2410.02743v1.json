{"2410.02743": {"publish_time": "2024-10-03", "title": "MA-RLHF: Reinforcement Learning from Human Feedback with Macro Actions", "paper_summary": "Reinforcement learning from human feedback (RLHF) has demonstrated\neffectiveness in aligning large language models (LLMs) with human preferences.\nHowever, token-level RLHF suffers from the credit assignment problem over long\nsequences, where delayed rewards make it challenging for the model to discern\nwhich actions contributed to successful outcomes. This hinders learning\nefficiency and slows convergence. In this paper, we propose MA-RLHF, a simple\nyet effective RLHF framework that incorporates macro actions -- sequences of\ntokens or higher-level language constructs -- into the learning process. By\noperating at this higher level of abstraction, our approach reduces the\ntemporal distance between actions and rewards, facilitating faster and more\naccurate credit assignment. This results in more stable policy gradient\nestimates and enhances learning efficiency within each episode, all without\nincreasing computational complexity during training or inference. We validate\nour approach through extensive experiments across various model sizes and\ntasks, including text summarization, dialogue generation, question answering,\nand program synthesis. Our method achieves substantial performance improvements\nover standard RLHF, with performance gains of up to 30% in text summarization\nand code generation, 18% in dialogue, and 8% in question answering tasks.\nNotably, our approach reaches parity with vanilla RLHF 1.7x to 2x faster in\nterms of training time and continues to outperform it with further training. We\nwill make our code and data publicly available at\nhttps://github.com/ernie-research/MA-RLHF .", "paper_summary_zh": "\u4eba\u985e\u56de\u994b\u5f37\u5316\u5b78\u7fd2 (RLHF) \u5df2\u8b49\u660e\u6709\u6548\u80fd\u4f7f\u5927\u578b\u8a9e\u8a00\u6a21\u578b (LLM) \u8207\u4eba\u985e\u504f\u597d\u4fdd\u6301\u4e00\u81f4\u3002\n\u7136\u800c\uff0c\u4ee3\u5e63\u7d1a RLHF \u5728\u9577\u5e8f\u5217\u4e2d\u6703\u9047\u5230\u4fe1\u7528\u5206\u914d\u554f\u984c\uff0c\u5ef6\u9072\u7684\u734e\u52f5\u4f7f\u5f97\u6a21\u578b\u96e3\u4ee5\u8fa8\u5225\u54ea\u4e9b\u52d5\u4f5c\u4fc3\u6210\u4e86\u6210\u529f\u7684\u7d50\u679c\u3002\u9019\u6703\u963b\u7919\u5b78\u7fd2\u6548\u7387\u4e26\u6e1b\u7de9\u6536\u6582\u3002\u5728\u672c\u6587\u4e2d\uff0c\u6211\u5011\u63d0\u51fa MA-RLHF\uff0c\u4e00\u500b\u7c21\u55ae\u4f46\u6709\u6548\u7684 RLHF \u6846\u67b6\uff0c\u5b83\u5c07\u5de8\u52d5\u4f5c\u5e8f\uff08\u4ee3\u5e63\u5e8f\u5217\u6216\u66f4\u9ad8\u7d1a\u7684\u8a9e\u8a00\u7d50\u69cb\uff09\u7d0d\u5165\u5b78\u7fd2\u904e\u7a0b\u4e2d\u3002\u900f\u904e\u5728\u9019\u500b\u66f4\u9ad8\u5c64\u6b21\u7684\u62bd\u8c61\u4e2d\u904b\u4f5c\uff0c\u6211\u5011\u7684\u505a\u6cd5\u7e2e\u77ed\u4e86\u52d5\u4f5c\u548c\u734e\u52f5\u4e4b\u9593\u7684\u6642\u9593\u8ddd\u96e2\uff0c\u4fc3\u9032\u4e86\u66f4\u5feb\u901f\u4e14\u66f4\u6e96\u78ba\u7684\u4fe1\u7528\u5206\u914d\u3002\u9019\u6703\u7522\u751f\u66f4\u7a69\u5b9a\u7684\u7b56\u7565\u68af\u5ea6\u4f30\u8a08\uff0c\u4e26\u5728\u6bcf\u500b\u60c5\u7bc0\u4e2d\u589e\u5f37\u5b78\u7fd2\u6548\u7387\uff0c\u800c\u7121\u9700\u589e\u52a0\u8a13\u7df4\u6216\u63a8\u8ad6\u671f\u9593\u7684\u904b\u7b97\u8907\u96dc\u6027\u3002\u6211\u5011\u900f\u904e\u5404\u7a2e\u6a21\u578b\u5927\u5c0f\u548c\u4efb\u52d9\u7684\u5ee3\u6cdb\u5be6\u9a57\u9a57\u8b49\u4e86\u6211\u5011\u7684\u505a\u6cd5\uff0c\u5305\u62ec\u6587\u672c\u6458\u8981\u3001\u5c0d\u8a71\u7522\u751f\u3001\u554f\u984c\u89e3\u7b54\u548c\u7a0b\u5f0f\u5408\u6210\u3002\u6211\u5011\u7684\u505a\u6cd5\u5728\u6a19\u6e96 RLHF \u4e0a\u5be6\u73fe\u4e86\u986f\u8457\u7684\u6548\u80fd\u63d0\u5347\uff0c\u5728\u6587\u672c\u6458\u8981\u548c\u7a0b\u5f0f\u7522\u751f\u4e2d\u6548\u80fd\u63d0\u5347\u9ad8\u9054 30%\uff0c\u5728\u5c0d\u8a71\u4e2d\u63d0\u5347 18%\uff0c\u5728\u554f\u984c\u89e3\u7b54\u4efb\u52d9\u4e2d\u63d0\u5347 8%\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u6211\u5011\u7684\u505a\u6cd5\u5728\u8a13\u7df4\u6642\u9593\u65b9\u9762\u6bd4\u50b3\u7d71 RLHF \u5feb 1.7 \u500d\u5230 2 \u500d\uff0c\u4e26\u6301\u7e8c\u5728\u9032\u4e00\u6b65\u7684\u8a13\u7df4\u4e2d\u8868\u73fe\u512a\u65bc\u5b83\u3002\u6211\u5011\u5c07\u5728 https://github.com/ernie-research/MA-RLHF \u516c\u958b\u6211\u5011\u7684\u7a0b\u5f0f\u78bc\u548c\u8cc7\u6599\u3002", "author": "Yekun Chai et.al.", "authors": "Yekun Chai, Haoran Sun, Huang Fang, Shuohuan Wang, Yu Sun, Hua Wu", "id": "2410.02743v1", "paper_url": "http://arxiv.org/abs/2410.02743v1", "repo": "null"}}