{"2501.06848": {"publish_time": "2025-01-12", "title": "A General Framework for Inference-time Scaling and Steering of Diffusion Models", "paper_summary": "Diffusion models produce impressive results in modalities ranging from images\nand video to protein design and text. However, generating samples with\nuser-specified properties remains a challenge. Recent research proposes\nfine-tuning models to maximize rewards that capture desired properties, but\nthese methods require expensive training and are prone to mode collapse. In\nthis work, we propose Feynman Kac (FK) steering, an inference-time framework\nfor steering diffusion models with reward functions. FK steering works by\nsampling a system of multiple interacting diffusion processes, called\nparticles, and resampling particles at intermediate steps based on scores\ncomputed using functions called potentials. Potentials are defined using\nrewards for intermediate states and are selected such that a high value\nindicates that the particle will yield a high-reward sample. We explore various\nchoices of potentials, intermediate rewards, and samplers. We evaluate FK\nsteering on text-to-image and text diffusion models. For steering text-to-image\nmodels with a human preference reward, we find that FK steering a 0.8B\nparameter model outperforms a 2.6B parameter fine-tuned model on prompt\nfidelity, with faster sampling and no training. For steering text diffusion\nmodels with rewards for text quality and specific text attributes, we find that\nFK steering generates lower perplexity, more linguistically acceptable outputs\nand enables gradient-free control of attributes like toxicity. Our results\ndemonstrate that inference-time scaling and steering of diffusion models, even\nwith off-the-shelf rewards, can provide significant sample quality gains and\ncontrollability benefits. Code is available at\nhttps://github.com/zacharyhorvitz/Fk-Diffusion-Steering .", "paper_summary_zh": "\u64f4\u6563\u6a21\u578b\u5728\u5f71\u50cf\u3001\u5f71\u7247\u3001\u86cb\u767d\u8a2d\u8a08\u548c\u6587\u5b57\u7b49\u6a21\u5f0f\u4e2d\u7522\u751f\u4ee4\u4eba\u5370\u8c61\u6df1\u523b\u7684\u7d50\u679c\u3002\u7136\u800c\uff0c\u7522\u751f\u5177\u6709\u4f7f\u7528\u8005\u6307\u5b9a\u5c6c\u6027\u7684\u6a23\u672c\u4ecd\u7136\u662f\u4e00\u9805\u6311\u6230\u3002\u6700\u8fd1\u7684\u7814\u7a76\u63d0\u51fa\u5fae\u8abf\u6a21\u578b\u4ee5\u6700\u5927\u5316\u6355\u6349\u6240\u9700\u5c6c\u6027\u7684\u734e\u52f5\uff0c\u4f46\u9019\u4e9b\u65b9\u6cd5\u9700\u8981\u6602\u8cb4\u7684\u8a13\u7df4\u4e14\u5bb9\u6613\u5d29\u6f70\u3002\u5728\u9019\u9805\u5de5\u4f5c\u4e2d\uff0c\u6211\u5011\u63d0\u51fa\u8cbb\u66fc\u5361\u514b (FK) \u5c0e\u5f15\uff0c\u4e00\u500b\u7528\u65bc\u4f7f\u7528\u734e\u52f5\u51fd\u6578\u5c0e\u5f15\u64f4\u6563\u6a21\u578b\u7684\u63a8\u8ad6\u6642\u9593\u67b6\u69cb\u3002FK \u5c0e\u5f15\u900f\u904e\u53d6\u6a23\u4e00\u500b\u7531\u591a\u500b\u4ea4\u4e92\u64f4\u6563\u904e\u7a0b\u7d44\u6210\u7684\u7cfb\u7d71\uff08\u7a31\u70ba\u7c92\u5b50\uff09\u4f86\u904b\u4f5c\uff0c\u4e26\u6839\u64da\u4f7f\u7528\u7a31\u70ba\u52e2\u51fd\u6578\u7684\u51fd\u6578\u8a08\u7b97\u7684\u5206\u6578\u5728\u4e2d\u9593\u6b65\u9a5f\u4e2d\u91cd\u65b0\u53d6\u6a23\u7c92\u5b50\u3002\u52e2\u51fd\u6578\u4f7f\u7528\u4e2d\u9593\u72c0\u614b\u7684\u734e\u52f5\u4f86\u5b9a\u7fa9\uff0c\u4e26\u9078\u64c7\u4e00\u500b\u9ad8\u503c\u8868\u793a\u7c92\u5b50\u5c07\u7522\u751f\u9ad8\u734e\u52f5\u6a23\u672c\u3002\u6211\u5011\u63a2\u7d22\u5404\u7a2e\u52e2\u51fd\u6578\u3001\u4e2d\u9593\u734e\u52f5\u548c\u53d6\u6a23\u5668\u7684\u9078\u64c7\u3002\u6211\u5011\u8a55\u4f30\u6587\u672c\u5230\u5f71\u50cf\u548c\u6587\u672c\u64f4\u6563\u6a21\u578b\u4e0a\u7684 FK \u5c0e\u5f15\u3002\u5c0d\u65bc\u4f7f\u7528\u4eba\u985e\u504f\u597d\u734e\u52f5\u4f86\u5c0e\u5f15\u6587\u672c\u5230\u5f71\u50cf\u6a21\u578b\uff0c\u6211\u5011\u767c\u73fe FK \u5c0e\u5f15\u4e00\u500b 0.8B \u53c3\u6578\u6a21\u578b\u5728\u63d0\u793a\u4fdd\u771f\u5ea6\u4e0a\u512a\u65bc\u4e00\u500b 2.6B \u53c3\u6578\u5fae\u8abf\u6a21\u578b\uff0c\u4e14\u53d6\u6a23\u901f\u5ea6\u66f4\u5feb\u4e14\u7121\u9700\u8a13\u7df4\u3002\u5c0d\u65bc\u4f7f\u7528\u6587\u672c\u54c1\u8cea\u548c\u7279\u5b9a\u6587\u672c\u5c6c\u6027\u734e\u52f5\u4f86\u5c0e\u5f15\u6587\u672c\u64f4\u6563\u6a21\u578b\uff0c\u6211\u5011\u767c\u73fe FK \u5c0e\u5f15\u7522\u751f\u8f03\u4f4e\u7684\u56f0\u60d1\u5ea6\u3001\u66f4\u5177\u8a9e\u8a00\u53ef\u63a5\u53d7\u6027\u7684\u8f38\u51fa\uff0c\u4e26\u80fd\u5c0d\u6bd2\u6027\u7b49\u5c6c\u6027\u9032\u884c\u7121\u68af\u5ea6\u63a7\u5236\u3002\u6211\u5011\u7684\u7d50\u679c\u8b49\u660e\uff0c\u5373\u4f7f\u4f7f\u7528\u73fe\u6210\u7684\u734e\u52f5\uff0c\u64f4\u6563\u6a21\u578b\u7684\u63a8\u8ad6\u6642\u9593\u7e2e\u653e\u548c\u5c0e\u5f15\u4e5f\u80fd\u63d0\u4f9b\u986f\u8457\u7684\u6a23\u672c\u54c1\u8cea\u63d0\u5347\u548c\u53ef\u63a7\u6027\u512a\u52e2\u3002\u7a0b\u5f0f\u78bc\u53ef\u5728 https://github.com/zacharyhorvitz/Fk-Diffusion-Steering \u53d6\u5f97\u3002", "author": "Raghav Singhal et.al.", "authors": "Raghav Singhal, Zachary Horvitz, Ryan Teehan, Mengye Ren, Zhou Yu, Kathleen McKeown, Rajesh Ranganath", "id": "2501.06848v1", "paper_url": "http://arxiv.org/abs/2501.06848v1", "repo": "https://github.com/zacharyhorvitz/fk-diffusion-steering"}}