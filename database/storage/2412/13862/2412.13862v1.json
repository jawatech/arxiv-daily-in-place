{"2412.13862": {"publish_time": "2024-12-18", "title": "Energy-Based Preference Model Offers Better Offline Alignment than the Bradley-Terry Preference Model", "paper_summary": "Since the debut of DPO, it has been shown that aligning a target LLM with\nhuman preferences via the KL-constrained RLHF loss is mathematically equivalent\nto a special kind of reward modeling task. Concretely, the task requires: 1)\nusing the target LLM to parameterize the reward model, and 2) tuning the reward\nmodel so that it has a 1:1 linear relationship with the true reward. However,\nwe identify a significant issue: the DPO loss might have multiple minimizers,\nof which only one satisfies the required linearity condition. The problem\narises from a well-known issue of the underlying Bradley-Terry preference\nmodel: it does not always have a unique maximum likelihood estimator (MLE).\nConsequently,the minimizer of the RLHF loss might be unattainable because it is\nmerely one among many minimizers of the DPO loss. As a better alternative, we\npropose an energy-based model (EBM) that always has a unique MLE, inherently\nsatisfying the linearity requirement. To approximate the MLE in practice, we\npropose a contrastive loss named Energy Preference Alignment (EPA), wherein\neach positive sample is contrasted against one or more strong negatives as well\nas many free weak negatives. Theoretical properties of our EBM enable the\napproximation error of EPA to almost surely vanish when a sufficient number of\nnegatives are used. Empirically, we demonstrate that EPA consistently delivers\nbetter performance on open benchmarks compared to DPO, thereby showing the\nsuperiority of our EBM.", "paper_summary_zh": "\u81ea DPO \u554f\u4e16\u4ee5\u4f86\uff0c\u5df2\u7d93\u8b49\u660e\u900f\u904e KL \u7d04\u675f RLHF \u640d\u5931\u5c07\u76ee\u6a19 LLM \u8207\u4eba\u985e\u504f\u597d\u5c0d\u9f4a\u5728\u6578\u5b78\u4e0a\u7b49\u540c\u65bc\u4e00\u7a2e\u7279\u6b8a\u985e\u578b\u7684\u734e\u52f5\u5efa\u6a21\u4efb\u52d9\u3002\u5177\u9ad4\u800c\u8a00\uff0c\u8a72\u4efb\u52d9\u9700\u8981\uff1a1) \u4f7f\u7528\u76ee\u6a19 LLM \u5c07\u734e\u52f5\u6a21\u578b\u53c3\u6578\u5316\uff0c\u4ee5\u53ca 2) \u8abf\u6574\u734e\u52f5\u6a21\u578b\uff0c\u4f7f\u5176\u8207\u771f\u5be6\u734e\u52f5\u5177\u6709 1:1 \u7684\u7dda\u6027\u95dc\u4fc2\u3002\u7136\u800c\uff0c\u6211\u5011\u767c\u73fe\u4e00\u500b\u91cd\u8981\u554f\u984c\uff1aDPO \u640d\u5931\u53ef\u80fd\u6709\u591a\u500b\u6700\u5c0f\u5316\u5668\uff0c\u5176\u4e2d\u53ea\u6709\u4e00\u500b\u6eff\u8db3\u6240\u9700\u7684\u7dda\u6027\u689d\u4ef6\u3002\u9019\u500b\u554f\u984c\u6e90\u81ea\u65bc\u57fa\u790e Bradley-Terry \u504f\u597d\u6a21\u578b\u7684\u4e00\u500b\u773e\u6240\u5468\u77e5\u7684\u554f\u984c\uff1a\u5b83\u4e26\u4e0d\u7e3d\u662f\u5177\u6709\u552f\u4e00\u7684\u6700\u5927\u4f3c\u7136\u4f30\u8a08\u5668 (MLE)\u3002\u56e0\u6b64\uff0cRLHF \u640d\u5931\u7684\u6700\u5c0f\u5316\u5668\u53ef\u80fd\u662f\u7121\u6cd5\u9054\u6210\u7684\uff0c\u56e0\u70ba\u5b83\u53ea\u662f DPO \u640d\u5931\u7684\u8a31\u591a\u6700\u5c0f\u5316\u5668\u4e4b\u4e00\u3002\u4f5c\u70ba\u4e00\u500b\u66f4\u597d\u7684\u66ff\u4ee3\u65b9\u6848\uff0c\u6211\u5011\u63d0\u51fa\u4e86\u4e00\u500b\u59cb\u7d42\u5177\u6709\u552f\u4e00 MLE \u7684\u57fa\u65bc\u80fd\u91cf\u7684\u6a21\u578b (EBM)\uff0c\u5b83\u56fa\u6709\u5730\u6eff\u8db3\u7dda\u6027\u8981\u6c42\u3002\u70ba\u4e86\u5728\u5be6\u52d9\u4e2d\u4f30\u8a08 MLE\uff0c\u6211\u5011\u63d0\u51fa\u4e86\u4e00\u500b\u540d\u70ba\u80fd\u91cf\u504f\u597d\u5c0d\u9f4a (EPA) \u7684\u5c0d\u6bd4\u640d\u5931\uff0c\u5176\u4e2d\u6bcf\u500b\u6b63\u6a23\u672c\u90fd\u8207\u4e00\u500b\u6216\u591a\u500b\u5f37\u8ca0\u6a23\u672c\u4ee5\u53ca\u8a31\u591a\u81ea\u7531\u5f31\u8ca0\u6a23\u672c\u9032\u884c\u5c0d\u6bd4\u3002\u6211\u5011\u7684 EBM \u7684\u7406\u8ad6\u6027\u8cea\u4f7f EPA \u7684\u8fd1\u4f3c\u8aa4\u5dee\u5e7e\u4e4e\u53ef\u4ee5\u5728\u4f7f\u7528\u8db3\u5920\u6578\u91cf\u7684\u8ca0\u6a23\u672c\u6642\u6d88\u5931\u3002\u6839\u64da\u7d93\u9a57\uff0c\u6211\u5011\u8b49\u660e EPA \u5728\u958b\u653e\u57fa\u6e96\u6e2c\u8a66\u4e2d\u59cb\u7d42\u63d0\u4f9b\u6bd4 DPO \u66f4\u597d\u7684\u6548\u80fd\uff0c\u5f9e\u800c\u986f\u793a\u51fa\u6211\u5011\u7684 EBM \u7684\u512a\u8d8a\u6027\u3002", "author": "Yuzhong Hong et.al.", "authors": "Yuzhong Hong, Hanshan Zhang, Junwei Bao, Hongfei Jiang, Yang Song", "id": "2412.13862v1", "paper_url": "http://arxiv.org/abs/2412.13862v1", "repo": "null"}}