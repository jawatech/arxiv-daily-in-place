{"2411.05289": {"publish_time": "2024-11-08", "title": "SpecHub: Provable Acceleration to Multi-Draft Speculative Decoding", "paper_summary": "Large Language Models (LLMs) have become essential in advancing natural\nlanguage processing (NLP) tasks, but their sequential token generation limits\ninference speed. Multi-Draft Speculative Decoding (MDSD) offers a promising\nsolution by using a smaller draft model to generate multiple token sequences,\nwhich the target LLM verifies in parallel. However, current heuristic\napproaches, such as Recursive Rejection Sampling (RRS), suffer from low\nacceptance rates in subsequent drafts, limiting the advantages of using\nmultiple drafts. Meanwhile, Optimal Transport with Membership Cost (OTM) can\ntheoretically improve acceptance rates, but its computational cost is too high\nfor real-time use. We present SpecHub, a novel, efficient sampling-verification\nmethod for MDSD that improves acceptance rates with only linear computational\noverhead. By simplifying the OTM problem into a compact Linear Programming\nmodel, SpecHub significantly reduces computational complexity. It further\naccelerates sampling by leveraging a sparse joint distribution, focusing\ncomputation on high-probability token sequences. In extensive experiments,\nSpechub consistently generates 0.05-0.27 and 0.02-0.16 more tokens per step\nthan RRS and RRS without replacement. We attach our code at\n\\url{https://github.com/MasterGodzilla/Speculative_decoding_OT}.", "paper_summary_zh": "\u5927\u578b\u8a9e\u8a00\u6a21\u578b (LLM) \u5df2\u6210\u70ba\u63a8\u9032\u81ea\u7136\u8a9e\u8a00\u8655\u7406 (NLP) \u4efb\u52d9\u7684\u95dc\u9375\uff0c\u4f46\u5176\u5e8f\u5217\u6a19\u8a18\u7522\u751f\u9650\u5236\u4e86\u63a8\u8ad6\u901f\u5ea6\u3002\u591a\u8349\u7a3f\u63a8\u6e2c\u6027\u89e3\u78bc (MDSD) \u63d0\u4f9b\u4e86\u4e00\u500b\u6709\u524d\u666f\u7684\u89e3\u6c7a\u65b9\u6848\uff0c\u5b83\u4f7f\u7528\u8f03\u5c0f\u7684\u8349\u7a3f\u6a21\u578b\u4f86\u7522\u751f\u591a\u500b\u6a19\u8a18\u5e8f\u5217\uff0c\u76ee\u6a19 LLM \u6703\u4e26\u884c\u9a57\u8b49\u9019\u4e9b\u5e8f\u5217\u3002\u7136\u800c\uff0c\u76ee\u524d\u7684\u555f\u767c\u5f0f\u65b9\u6cd5\uff08\u4f8b\u5982\u905e\u8ff4\u62d2\u7d55\u63a1\u6a23 (RRS)\uff09\u5728\u5f8c\u7e8c\u8349\u7a3f\u4e2d\u63a5\u53d7\u7387\u4f4e\uff0c\u9019\u9650\u5236\u4e86\u4f7f\u7528\u591a\u500b\u8349\u7a3f\u7684\u512a\u9ede\u3002\u8207\u6b64\u540c\u6642\uff0c\u5177\u6709\u6210\u54e1\u6210\u672c\u7684\u6700\u512a\u50b3\u8f38 (OTM) \u5728\u7406\u8ad6\u4e0a\u53ef\u4ee5\u63d0\u9ad8\u63a5\u53d7\u7387\uff0c\u4f46\u5176\u904b\u7b97\u6210\u672c\u5c0d\u65bc\u5be6\u6642\u4f7f\u7528\u4f86\u8aaa\u592a\u9ad8\u3002\u6211\u5011\u63d0\u51fa SpecHub\uff0c\u9019\u662f\u4e00\u7a2e\u65b0\u7a4e\u3001\u9ad8\u6548\u7684 MDSD \u63a1\u6a23\u9a57\u8b49\u65b9\u6cd5\uff0c\u5b83\u50c5\u901a\u904e\u7dda\u6027\u904b\u7b97\u958b\u92b7\u4f86\u63d0\u9ad8\u63a5\u53d7\u7387\u3002\u901a\u904e\u5c07 OTM \u554f\u984c\u7c21\u5316\u70ba\u4e00\u500b\u7dca\u6e4a\u7684\u7dda\u6027\u898f\u5283\u6a21\u578b\uff0cSpecHub \u5927\u5e45\u964d\u4f4e\u4e86\u904b\u7b97\u8907\u96dc\u5ea6\u3002\u5b83\u9032\u4e00\u6b65\u5229\u7528\u7a00\u758f\u806f\u5408\u5206\u4f48\u4f86\u52a0\u901f\u63a1\u6a23\uff0c\u5c07\u904b\u7b97\u96c6\u4e2d\u5728\u9ad8\u6982\u7387\u6a19\u8a18\u5e8f\u5217\u4e0a\u3002\u5728\u5ee3\u6cdb\u7684\u5be6\u9a57\u4e2d\uff0cSpechub \u6bcf\u500b\u6b65\u9a5f\u7522\u751f\u7684\u6a19\u8a18\u6bd4 RRS \u548c\u672a\u66ff\u63db\u7684 RRS \u6301\u7e8c\u591a\u51fa 0.05-0.27 \u548c 0.02-0.16 \u500b\u3002\u6211\u5011\u5c07\u6211\u5011\u7684\u4ee3\u78bc\u9644\u52a0\u5728 \\url{https://github.com/MasterGodzilla/Speculative_decoding_OT}\u3002", "author": "Ryan Sun et.al.", "authors": "Ryan Sun, Tianyi Zhou, Xun Chen, Lichao Sun", "id": "2411.05289v1", "paper_url": "http://arxiv.org/abs/2411.05289v1", "repo": "https://github.com/mastergodzilla/speculative_decoding_ot"}}