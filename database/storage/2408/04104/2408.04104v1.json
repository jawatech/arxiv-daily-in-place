{"2408.04104": {"publish_time": "2024-08-07", "title": "Hardware-Assisted Virtualization of Neural Processing Units for Cloud Platforms", "paper_summary": "Cloud platforms today have been deploying hardware accelerators like neural\nprocessing units (NPUs) for powering machine learning (ML) inference services.\nTo maximize the resource utilization while ensuring reasonable quality of\nservice, a natural approach is to virtualize NPUs for efficient resource\nsharing for multi-tenant ML services. However, virtualizing NPUs for modern\ncloud platforms is not easy. This is not only due to the lack of system\nabstraction support for NPU hardware, but also due to the lack of architectural\nand ISA support for enabling fine-grained dynamic operator scheduling for\nvirtualized NPUs.\n  We present TCloud, a holistic NPU virtualization framework. We investigate\nvirtualization techniques for NPUs across the entire software and hardware\nstack. TCloud consists of (1) a flexible NPU abstraction called vNPU, which\nenables fine-grained virtualization of the heterogeneous compute units in a\nphysical NPU (pNPU); (2) a vNPU resource allocator that enables pay-as-you-go\ncomputing model and flexible vNPU-to-pNPU mappings for improved resource\nutilization and cost-effectiveness; (3) an ISA extension of modern NPU\narchitecture for facilitating fine-grained tensor operator scheduling for\nmultiple vNPUs. We implement TCloud based on a production-level NPU simulator.\nOur experiments show that TCloud improves the throughput of ML inference\nservices by up to 1.4$\\times$ and reduces the tail latency by up to\n4.6$\\times$, while improving the NPU utilization by 1.2$\\times$ on average,\ncompared to state-of-the-art NPU sharing approaches.", "paper_summary_zh": "\u73fe\u4eca\u7684\u96f2\u7aef\u5e73\u53f0\u5df2\u90e8\u7f72\u795e\u7d93\u8655\u7406\u55ae\u5143 (NPU) \u7b49\u786c\u9ad4\u52a0\u901f\u5668\uff0c\u7528\u65bc\u652f\u63f4\u6a5f\u5668\u5b78\u7fd2 (ML) \u63a8\u8ad6\u670d\u52d9\u3002\u70ba\u4e86\u5728\u78ba\u4fdd\u5408\u7406\u670d\u52d9\u54c1\u8cea\u7684\u540c\u6642\u6700\u5927\u5316\u8cc7\u6e90\u4f7f\u7528\u7387\uff0c\u4e00\u7a2e\u81ea\u7136\u7684\u65b9\u6cd5\u662f\u5c07 NPU \u865b\u64ec\u5316\uff0c\u4ee5\u6709\u6548\u7387\u5730\u70ba\u591a\u79df\u6236 ML \u670d\u52d9\u5171\u4eab\u8cc7\u6e90\u3002\u7136\u800c\uff0c\u70ba\u73fe\u4ee3\u96f2\u7aef\u5e73\u53f0\u865b\u64ec\u5316 NPU \u4e26\u4e0d\u5bb9\u6613\u3002\u9019\u4e0d\u50c5\u662f\u56e0\u70ba\u7f3a\u4e4f\u5c0d NPU \u786c\u9ad4\u7684\u7cfb\u7d71\u62bd\u8c61\u652f\u63f4\uff0c\u9084\u56e0\u70ba\u7f3a\u4e4f\u67b6\u69cb\u548c ISA \u652f\u63f4\uff0c\u7121\u6cd5\u5c0d\u865b\u64ec\u5316 NPU \u9032\u884c\u7d30\u7c92\u5ea6\u7684\u52d5\u614b\u904b\u7b97\u5b50\u6392\u7a0b\u3002\n\u6211\u5011\u63d0\u51fa TCloud\uff0c\u4e00\u500b\u6574\u9ad4\u7684 NPU \u865b\u64ec\u5316\u67b6\u69cb\u3002\u6211\u5011\u7814\u7a76\u4e86\u91dd\u5c0d\u6574\u500b\u8edf\u9ad4\u548c\u786c\u9ad4\u5806\u758a\u7684 NPU \u865b\u64ec\u5316\u6280\u8853\u3002TCloud \u5305\u542b (1) \u4e00\u500b\u7a31\u70ba vNPU \u7684\u5f48\u6027 NPU \u62bd\u8c61\uff0c\u5b83\u80fd\u5c0d\u5be6\u9ad4 NPU (pNPU) \u4e2d\u7684\u7570\u8cea\u904b\u7b97\u55ae\u5143\u9032\u884c\u7d30\u7c92\u5ea6\u7684\u865b\u64ec\u5316\uff1b(2) \u4e00\u500b vNPU \u8cc7\u6e90\u5206\u914d\u5668\uff0c\u5b83\u80fd\u652f\u63f4\u6309\u9700\u4ed8\u8cbb\u7684\u904b\u7b97\u6a21\u5f0f\u548c\u5f48\u6027\u7684 vNPU \u5c0d\u61c9 pNPU \u6620\u5c04\uff0c\u4ee5\u6539\u5584\u8cc7\u6e90\u4f7f\u7528\u7387\u548c\u6210\u672c\u6548\u76ca\uff1b(3) \u73fe\u4ee3 NPU \u67b6\u69cb\u7684 ISA \u5ef6\u4f38\uff0c\u7528\u65bc\u4fc3\u9032\u91dd\u5c0d\u591a\u500b vNPU \u7684\u7d30\u7c92\u5ea6\u5f35\u91cf\u904b\u7b97\u5b50\u6392\u7a0b\u3002\u6211\u5011\u6839\u64da\u751f\u7522\u7d1a\u5225\u7684 NPU \u6a21\u64ec\u5668\u5be6\u4f5c TCloud\u3002\u6211\u5011\u7684\u5be6\u9a57\u986f\u793a\uff0c\u8207\u6700\u5148\u9032\u7684 NPU \u5171\u4eab\u65b9\u6cd5\u76f8\u6bd4\uff0cTCloud \u5c07 ML \u63a8\u8ad6\u670d\u52d9\u7684\u541e\u5410\u91cf\u63d0\u5347\u4e86 1.4 \u500d\uff0c\u5c07\u5c3e\u90e8\u5ef6\u9072\u964d\u4f4e\u4e86 4.6 \u500d\uff0c\u540c\u6642\u5c07 NPU \u4f7f\u7528\u7387\u5e73\u5747\u63d0\u5347\u4e86 1.2 \u500d\u3002", "author": "Yuqi Xue et.al.", "authors": "Yuqi Xue, Yiqi Liu, Lifeng Nai, Jian Huang", "id": "2408.04104v1", "paper_url": "http://arxiv.org/abs/2408.04104v1", "repo": "null"}}