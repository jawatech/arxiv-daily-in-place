{"2502.01659": {"publish_time": "2025-01-31", "title": "Longer Attention Span: Increasing Transformer Context Length with Sparse Graph Processing Techniques", "paper_summary": "Transformers have demonstrated great success in numerous domains including\nnatural language processing and bioinformatics. This success stems from the use\nof the attention mechanism by these models in order to represent and propagate\npairwise interactions between individual tokens of sequential data. However,\nthe primary limitation of this operation is its quadratic memory and time\ncomplexity in relation to the input's context length - the length of a sequence\nover which the interactions need to be captured. This significantly limits the\nlength of sequences that can be inferred upon by these models. Extensive\nresearch has been conducted to reduce the number of pairwise interactions to\nsub-quadratic in relation to the context length by introducing sparsity into\nthe attention mechanism through the development of sparse attention masks.\nHowever, efficient implementations that achieve \"true sparsity\" are lacking.\n  In this work, we address this issue by proposing a graph computing view of\nattention where tokens are perceived as nodes of the graph and the attention\nmask determines the edges of the graph. Using this view, we develop graph\nprocessing algorithms to implement the attention mechanism. Both theoretically\nand empirically, we demonstrate that our algorithms only perform the needed\ncomputations, i.e., they are work optimal. We also perform extensive\nexperimentation using popular attention masks to explore the impact of sparsity\non execution time and achievable context length. Our experiments demonstrate\nsignificant speedups in execution times compared to state-of-the-art attention\nimplementations such as FlashAttention for large sequence lengths. We also\ndemonstrate that our algorithms are able to achieve extremely long sequence\nlengths of as high as 160 million on a single NVIDIA A100 GPU (SXM4 80GB).", "paper_summary_zh": "\u8b8a\u5f62\u91d1\u525b\u5df2\u5728\u8a31\u591a\u9818\u57df\u5c55\u73fe\u51fa\u5de8\u5927\u7684\u6210\u529f\uff0c\u5305\u62ec\u81ea\u7136\u8a9e\u8a00\u8655\u7406\u548c\u751f\u7269\u8cc7\u8a0a\u5b78\u3002\u9019\u7a2e\u6210\u529f\u6e90\u81ea\u65bc\u9019\u4e9b\u6a21\u578b\u4f7f\u7528\u6ce8\u610f\u6a5f\u5236\u4f86\u8868\u793a\u548c\u50b3\u64ad\u5e8f\u5217\u8cc7\u6599\u4e2d\u5404\u500b\u6a19\u8a18\u4e4b\u9593\u6210\u5c0d\u7684\u4e92\u52d5\u3002\u7136\u800c\uff0c\u9019\u7a2e\u904b\u7b97\u7684\u4e3b\u8981\u9650\u5236\u5728\u65bc\u5176\u4e8c\u6b21\u8a18\u61b6\u9ad4\u548c\u6642\u9593\u8907\u96dc\u5ea6\u8207\u8f38\u5165\u7684\u5167\u5bb9\u9577\u5ea6\u6709\u95dc\uff0c\u4e5f\u5c31\u662f\u9700\u8981\u64f7\u53d6\u4e92\u52d5\u7684\u5e8f\u5217\u9577\u5ea6\u3002\u9019\u6703\u986f\u8457\u9650\u5236\u9019\u4e9b\u6a21\u578b\u53ef\u4ee5\u63a8\u8ad6\u7684\u5e8f\u5217\u9577\u5ea6\u3002\u5df2\u7d93\u9032\u884c\u4e86\u5927\u91cf\u7684\u7814\u7a76\u4f86\u6e1b\u5c11\u6210\u5c0d\u4e92\u52d5\u7684\u6578\u91cf\uff0c\u4f7f\u5176\u8207\u5167\u5bb9\u9577\u5ea6\u6210\u6b21\u4e8c\u6b21\u95dc\u4fc2\uff0c\u65b9\u6cd5\u662f\u900f\u904e\u958b\u767c\u7a00\u758f\u6ce8\u610f\u906e\u7f69\u4f86\u5c07\u7a00\u758f\u6027\u5f15\u5165\u6ce8\u610f\u6a5f\u5236\u3002\u7136\u800c\uff0c\u7f3a\u4e4f\u80fd\u9054\u6210\u300c\u771f\u5be6\u7a00\u758f\u6027\u300d\u7684\u9ad8\u6548\u5be6\u4f5c\u3002\u5728\u9019\u9805\u5de5\u4f5c\u4e2d\uff0c\u6211\u5011\u900f\u904e\u63d0\u51fa\u6ce8\u610f\u529b\u7684\u5716\u5f62\u904b\u7b97\u6aa2\u8996\u4f86\u89e3\u6c7a\u9019\u500b\u554f\u984c\uff0c\u5176\u4e2d\u6a19\u8a18\u88ab\u8996\u70ba\u5716\u5f62\u7684\u7bc0\u9ede\uff0c\u800c\u6ce8\u610f\u529b\u906e\u7f69\u5247\u6c7a\u5b9a\u5716\u5f62\u4e2d\u7684\u908a\u7de3\u3002\u4f7f\u7528\u9019\u7a2e\u6aa2\u8996\uff0c\u6211\u5011\u958b\u767c\u4e86\u5716\u5f62\u8655\u7406\u6f14\u7b97\u6cd5\u4f86\u5be6\u4f5c\u6ce8\u610f\u529b\u6a5f\u5236\u3002\u6211\u5011\u5728\u7406\u8ad6\u4e0a\u548c\u7d93\u9a57\u4e0a\u90fd\u8b49\u660e\u4e86\u6211\u5011\u7684\u6f14\u7b97\u6cd5\u53ea\u57f7\u884c\u5fc5\u8981\u7684\u904b\u7b97\uff0c\u4e5f\u5c31\u662f\u8aaa\uff0c\u5b83\u5011\u662f\u5de5\u4f5c\u6700\u512a\u7684\u3002\u6211\u5011\u4e5f\u4f7f\u7528\u6d41\u884c\u7684\u6ce8\u610f\u529b\u906e\u7f69\u9032\u884c\u5ee3\u6cdb\u7684\u5be6\u9a57\uff0c\u4ee5\u63a2\u8a0e\u7a00\u758f\u6027\u5c0d\u57f7\u884c\u6642\u9593\u548c\u53ef\u9054\u6210\u7684\u5167\u5bb9\u9577\u5ea6\u7684\u5f71\u97ff\u3002\u6211\u5011\u7684\u5be6\u9a57\u8b49\u660e\uff0c\u8207\u6700\u5148\u9032\u7684\u6ce8\u610f\u529b\u5be6\u4f5c\uff08\u4f8b\u5982 FlashAttention\uff09\u76f8\u6bd4\uff0c\u5c0d\u65bc\u5927\u578b\u5e8f\u5217\u9577\u5ea6\uff0c\u6211\u5011\u7684\u6f14\u7b97\u6cd5\u5728\u57f7\u884c\u6642\u9593\u65b9\u9762\u6709\u986f\u8457\u7684\u52a0\u901f\u3002\u6211\u5011\u4e5f\u8b49\u660e\u4e86\u6211\u5011\u7684\u6f14\u7b97\u6cd5\u80fd\u5920\u5728\u55ae\u4e00\u7684 NVIDIA A100 GPU (SXM4 80GB) \u4e0a\u9054\u6210\u6975\u9577\u7684\u5e8f\u5217\u9577\u5ea6\uff0c\u6700\u9ad8\u53ef\u9054 1.6 \u5104\u3002", "author": "Nathaniel Tomczak et.al.", "authors": "Nathaniel Tomczak, Sanmukh Kuppannagari", "id": "2502.01659v2", "paper_url": "http://arxiv.org/abs/2502.01659v2", "repo": "null"}}