{"2409.04040": {"publish_time": "2024-09-06", "title": "A First Look At Efficient And Secure On-Device LLM Inference Against KV Leakage", "paper_summary": "Running LLMs on end devices has garnered significant attention recently due\nto their advantages in privacy preservation. With the advent of lightweight LLM\nmodels and specially designed GPUs, on-device LLM inference has achieved the\nnecessary accuracy and performance metrics. However, we have identified that\nLLM inference on GPUs can leak privacy-sensitive intermediate information,\nspecifically the KV pairs. An attacker could exploit these KV pairs to\nreconstruct the entire user conversation, leading to significant\nvulnerabilities. Existing solutions, such as Fully Homomorphic Encryption (FHE)\nand Trusted Execution Environments (TEE), are either too computation-intensive\nor resource-limited. To address these issues, we designed KV-Shield, which\noperates in two phases. In the initialization phase, it permutes the weight\nmatrices so that all KV pairs are correspondingly permuted. During the runtime\nphase, the attention vector is inversely permuted to ensure the correctness of\nthe layer output. All permutation-related operations are executed within the\nTEE, ensuring that insecure GPUs cannot access the original KV pairs, thus\npreventing conversation reconstruction. Finally, we theoretically analyze the\ncorrectness of KV-Shield, along with its advantages and overhead.", "paper_summary_zh": "\u6700\u8fd1\uff0c\u5728\u7ec8\u7aef\u8bbe\u5907\u4e0a\u8fd0\u884c LLM \u5df2\u5f15\u8d77\u5e7f\u6cdb\u5173\u6ce8\uff0c\u56e0\u4e3a\u5b83\u5728\u9690\u79c1\u4fdd\u62a4\u65b9\u9762\u5177\u6709\u4f18\u52bf\u3002\u968f\u7740\u8f7b\u91cf\u7ea7 LLM \u6a21\u578b\u548c\u4e13\u95e8\u8bbe\u8ba1\u7684 GPU \u7684\u51fa\u73b0\uff0c\u8bbe\u5907\u4e0a\u7684 LLM \u63a8\u65ad\u5df2\u8fbe\u5230\u5fc5\u8981\u7684\u51c6\u786e\u6027\u548c\u6027\u80fd\u6307\u6807\u3002\u7136\u800c\uff0c\u6211\u4eec\u53d1\u73b0 GPU \u4e0a\u7684 LLM \u63a8\u65ad\u53ef\u80fd\u4f1a\u6cc4\u9732\u9690\u79c1\u654f\u611f\u7684\u4e2d\u95f4\u4fe1\u606f\uff0c\u7279\u522b\u662f KV \u5bf9\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b KV \u5bf9\u91cd\u5efa\u6574\u4e2a\u7528\u6237\u5bf9\u8bdd\uff0c\u4ece\u800c\u5bfc\u81f4\u91cd\u5927\u6f0f\u6d1e\u3002\u73b0\u6709\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u4f8b\u5982\u5168\u540c\u6001\u52a0\u5bc6 (FHE) \u548c\u53ef\u4fe1\u6267\u884c\u73af\u5883 (TEE)\uff0c\u8981\u4e48\u8ba1\u7b97\u5bc6\u96c6\uff0c\u8981\u4e48\u8d44\u6e90\u6709\u9650\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff0c\u6211\u4eec\u8bbe\u8ba1\u4e86 KV-Shield\uff0c\u5b83\u5206\u4e24\u4e2a\u9636\u6bb5\u8fd0\u884c\u3002\u5728\u521d\u59cb\u5316\u9636\u6bb5\uff0c\u5b83\u5bf9\u6743\u91cd\u77e9\u9635\u8fdb\u884c\u6392\u5217\uff0c\u4ee5\u4fbf\u6240\u6709 KV \u5bf9\u76f8\u5e94\u5730\u8fdb\u884c\u6392\u5217\u3002\u5728\u8fd0\u884c\u65f6\u9636\u6bb5\uff0c\u5bf9\u6ce8\u610f\u529b\u5411\u91cf\u8fdb\u884c\u53cd\u5411\u6392\u5217\uff0c\u4ee5\u786e\u4fdd\u5c42\u8f93\u51fa\u7684\u6b63\u786e\u6027\u3002\u6240\u6709\u4e0e\u6392\u5217\u76f8\u5173\u7684\u64cd\u4f5c\u90fd\u5728 TEE \u5185\u6267\u884c\uff0c\u786e\u4fdd\u4e0d\u5b89\u5168\u7684 GPU \u65e0\u6cd5\u8bbf\u95ee\u539f\u59cb KV \u5bf9\uff0c\u4ece\u800c\u9632\u6b62\u5bf9\u8bdd\u91cd\u5efa\u3002\u6700\u540e\uff0c\u6211\u4eec\u4ece\u7406\u8bba\u4e0a\u5206\u6790\u4e86 KV-Shield \u7684\u6b63\u786e\u6027\uff0c\u4ee5\u53ca\u5b83\u7684\u4f18\u70b9\u548c\u5f00\u9500\u3002", "author": "Huan Yang et.al.", "authors": "Huan Yang, Deyu Zhang, Yudong Zhao, Yuanchun Li, Yunxin Liu", "id": "2409.04040v1", "paper_url": "http://arxiv.org/abs/2409.04040v1", "repo": "null"}}