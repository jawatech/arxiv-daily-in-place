{"2407.11550": {"publish_time": "2024-07-16", "title": "Optimizing KV Cache Eviction in LLMs: Adaptive Allocation for Enhanced Budget Utilization", "paper_summary": "Large Language Models have excelled in various fields but encounter\nefficiency limitations due to the extensive KV cache required for long\nsequences inference. Many efforts try to evict non-critical cache elements\nduring runtime, thereby reducing cache size within a given memory budget while\npreserving generation quality. Our reexamination of their underlying principles\ndiscerns that prevailing strategies essentially aim to minimize an upper bound\nof eviction loss within a specific budget allocation. However, we observe that\nthe current practice of uniformly allocating budgets across different attention\nheads during the eviction procedure tends to degrade the quality of generation\nposten-eviction. In light of these findings, we propose a simple yet effective\nadaptive allocation algorithm that not only theoretically ensures its loss\nupper bound does not exceed that of previous uniform allocation methods, but\nalso effectively aligns with the characteristics of the self-attention\nmechanism, thus practically reducing the upper bound. Further, integrating this\nalgorithm with two of the most advanced methods yields Ada-SnapKV and\nAda-Pyramid. Extensive experimental validation across 16 datasets and the\nNeedle-in-a-Haystack test confirm that Ada-SnapKV and Ada-Pyramid achieve\nfurther enhancements, establishing new benchmarks in state-of-the-art\nperformance.", "paper_summary_zh": "\u5927\u578b\u8a9e\u8a00\u6a21\u578b\u5728\u5404\u7a2e\u9818\u57df\u8868\u73fe\u51fa\u8272\uff0c\u4f46\u7531\u65bc\u9577\u5e8f\u5217\u63a8\u8ad6\u9700\u8981\u5927\u91cf\u7684 KV \u5feb\u53d6\uff0c\u56e0\u6b64\u6703\u9047\u5230\u6548\u7387\u9650\u5236\u3002\u8a31\u591a\u65b9\u6cd5\u5617\u8a66\u5728\u57f7\u884c\u671f\u9593\u9a45\u9010\u975e\u95dc\u9375\u5feb\u53d6\u5143\u7d20\uff0c\u5f9e\u800c\u5728\u7d66\u5b9a\u7684\u8a18\u61b6\u9ad4\u9810\u7b97\u4e2d\u6e1b\u5c11\u5feb\u53d6\u5927\u5c0f\uff0c\u540c\u6642\u4fdd\u6301\u751f\u6210\u54c1\u8cea\u3002\u6211\u5011\u91cd\u65b0\u5be9\u8996\u5176\u57fa\u672c\u539f\u5247\uff0c\u767c\u73fe\u666e\u904d\u7684\u7b56\u7565\u57fa\u672c\u4e0a\u65e8\u5728\u6700\u5c0f\u5316\u7279\u5b9a\u9810\u7b97\u5206\u914d\u4e2d\u7684\u9a45\u9010\u640d\u5931\u7684\u4e0a\u9650\u3002\u7136\u800c\uff0c\u6211\u5011\u89c0\u5bdf\u5230\u5728\u9a45\u9010\u904e\u7a0b\u4e2d\u5c07\u9810\u7b97\u5747\u52fb\u5206\u914d\u7d66\u4e0d\u540c\u6ce8\u610f\u529b\u5c64\u7684\u73fe\u884c\u505a\u6cd5\u5f80\u5f80\u6703\u964d\u4f4e\u9a45\u9010\u5f8c\u7684\u751f\u6210\u54c1\u8cea\u3002\u6839\u64da\u9019\u4e9b\u767c\u73fe\uff0c\u6211\u5011\u63d0\u51fa\u4e00\u500b\u7c21\u55ae\u4f46\u6709\u6548\u7684\u81ea\u9069\u61c9\u5206\u914d\u6f14\u7b97\u6cd5\uff0c\u5b83\u4e0d\u50c5\u5728\u7406\u8ad6\u4e0a\u78ba\u4fdd\u5176\u640d\u5931\u4e0a\u9650\u4e0d\u8d85\u904e\u5148\u524d\u7684\u5747\u52fb\u5206\u914d\u65b9\u6cd5\uff0c\u800c\u4e14\u6709\u6548\u5730\u7b26\u5408\u81ea\u6ce8\u610f\u529b\u6a5f\u5236\u7684\u7279\u6027\uff0c\u5f9e\u800c\u5be6\u969b\u4e0a\u964d\u4f4e\u4e86\u4e0a\u9650\u3002\u6b64\u5916\uff0c\u5c07\u6b64\u6f14\u7b97\u6cd5\u8207\u5169\u7a2e\u6700\u5148\u9032\u7684\u65b9\u6cd5\u6574\u5408\uff0c\u7522\u751f Ada-SnapKV \u548c Ada-Pyramid\u3002\u5728 16 \u500b\u8cc7\u6599\u96c6\u548c Needle-in-a-Haystack \u6e2c\u8a66\u4e2d\u7684\u5ee3\u6cdb\u5be6\u9a57\u9a57\u8b49\u8b49\u5be6\uff0cAda-SnapKV \u548c Ada-Pyramid \u9032\u4e00\u6b65\u63d0\u5347\uff0c\u5728\u6700\u5148\u9032\u7684\u6548\u80fd\u4e2d\u5efa\u7acb\u65b0\u7684\u57fa\u6e96\u3002", "author": "Yuan Feng et.al.", "authors": "Yuan Feng, Junlin Lv, Yukun Cao, Xike Xie, S. Kevin Zhou", "id": "2407.11550v1", "paper_url": "http://arxiv.org/abs/2407.11550v1", "repo": "null"}}