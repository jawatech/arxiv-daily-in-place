{"2407.16607": {"publish_time": "2024-07-23", "title": "Data Mixture Inference: What do BPE Tokenizers Reveal about their Training Data?", "paper_summary": "The pretraining data of today's strongest language models is opaque; in\nparticular, little is known about the proportions of various domains or\nlanguages represented. In this work, we tackle a task which we call data\nmixture inference, which aims to uncover the distributional make-up of training\ndata. We introduce a novel attack based on a previously overlooked source of\ninformation -- byte-pair encoding (BPE) tokenizers, used by the vast majority\nof modern language models. Our key insight is that the ordered list of merge\nrules learned by a BPE tokenizer naturally reveals information about the token\nfrequencies in its training data: the first merge is the most common byte pair,\nthe second is the most common pair after merging the first token, and so on.\nGiven a tokenizer's merge list along with data samples for each category of\ninterest, we formulate a linear program that solves for the proportion of each\ncategory in the tokenizer's training set. Importantly, to the extent to which\ntokenizer training data is representative of the pretraining data, we\nindirectly learn about pretraining data. In controlled experiments, we show\nthat our attack recovers mixture ratios with high precision for tokenizers\ntrained on known mixtures of natural languages, programming languages, and data\nsources. We then apply our approach to off-the-shelf tokenizers released with\nrecent LMs. We confirm much publicly disclosed information about these models,\nand also make several new inferences: GPT-4o's tokenizer is much more\nmultilingual than its predecessors, training on 39% non-English data; Llama3\nextends GPT-3.5's tokenizer primarily for multilingual (48%) use; GPT-3.5's and\nClaude's tokenizers are trained on predominantly code (~60%). We hope our work\nsheds light on current design practices for pretraining data, and inspires\ncontinued research into data mixture inference for LMs.", "paper_summary_zh": "\u7576\u4eca\u6700\u5f37\u5927\u7684\u8a9e\u8a00\u6a21\u578b\u7684\u9810\u8a13\u7df4\u8cc7\u6599\u662f\u4e0d\u900f\u660e\u7684\uff1b\u7279\u5225\u662f\uff0c\u5c0d\u65bc\u5404\u7a2e\u9818\u57df\u6216\u8a9e\u8a00\u7684\u6bd4\u4f8b\u77e5\u4e4b\u751a\u5c11\u3002\u5728\u9019\u9805\u5de5\u4f5c\u4e2d\uff0c\u6211\u5011\u8655\u7406\u4e00\u9805\u6211\u5011\u7a31\u4e4b\u70ba\u8cc7\u6599\u6df7\u5408\u63a8\u8ad6\u7684\u4efb\u52d9\uff0c\u5176\u76ee\u7684\u662f\u63ed\u793a\u8a13\u7df4\u8cc7\u6599\u7684\u5206\u5e03\u5f0f\u7d44\u6210\u3002\u6211\u5011\u5f15\u5165\u4e86\u4e00\u7a2e\u57fa\u65bc\u5148\u524d\u88ab\u5ffd\u8996\u7684\u8cc7\u8a0a\u4f86\u6e90\u7684\u65b0\u653b\u64ca\u2014\u2014\u4f4d\u5143\u7d44\u5c0d\u7de8\u78bc (BPE) \u4ee3\u5e63\u5668\uff0c\u5b83\u88ab\u7d55\u5927\u591a\u6578\u73fe\u4ee3\u8a9e\u8a00\u6a21\u578b\u6240\u4f7f\u7528\u3002\u6211\u5011\u7684\u95dc\u9375\u898b\u89e3\u662f\uff0cBPE \u4ee3\u5e63\u5668\u6240\u5b78\u7fd2\u7684\u5408\u4f75\u898f\u5247\u7684\u6709\u5e8f\u6e05\u55ae\u81ea\u7136\u5730\u63ed\u793a\u4e86\u5176\u8a13\u7df4\u8cc7\u6599\u4e2d\u4ee3\u5e63\u983b\u7387\u7684\u8cc7\u8a0a\uff1a\u7b2c\u4e00\u6b21\u5408\u4f75\u662f\u6700\u5e38\u898b\u7684\u4f4d\u5143\u7d44\u5c0d\uff0c\u7b2c\u4e8c\u6b21\u5408\u4f75\u662f\u6700\u5e38\u898b\u7684\u5c0d\uff0c\u4f9d\u6b64\u985e\u63a8\u3002\u7d66\u5b9a\u4e00\u500b\u4ee3\u5e63\u5668\u7684\u5408\u4f75\u6e05\u55ae\u4ee5\u53ca\u6bcf\u500b\u611f\u8208\u8da3\u985e\u5225\u7684\u8cc7\u6599\u7bc4\u4f8b\uff0c\u6211\u5011\u5236\u5b9a\u4e86\u4e00\u500b\u7dda\u6027\u7a0b\u5f0f\uff0c\u7528\u65bc\u89e3\u6c7a\u4ee3\u5e63\u5668\u8a13\u7df4\u96c6\u4e2d\u6bcf\u500b\u985e\u5225\u7684\u6bd4\u4f8b\u3002\u91cd\u8981\u7684\u662f\uff0c\u5728\u4ee3\u5e63\u5668\u8a13\u7df4\u8cc7\u6599\u4ee3\u8868\u9810\u8a13\u7df4\u8cc7\u6599\u7684\u7a0b\u5ea6\u4e0b\uff0c\u6211\u5011\u9593\u63a5\u4e86\u89e3\u4e86\u9810\u8a13\u7df4\u8cc7\u6599\u3002\u5728\u53d7\u63a7\u5be6\u9a57\u4e2d\uff0c\u6211\u5011\u5c55\u793a\u4e86\u6211\u5011\u7684\u653b\u64ca\u4ee5\u9ad8\u7cbe\u5ea6\u6062\u5fa9\u4e86\u5728\u5df2\u77e5\u81ea\u7136\u8a9e\u8a00\u3001\u7a0b\u5f0f\u8a9e\u8a00\u548c\u8cc7\u6599\u4f86\u6e90\u6df7\u5408\u7269\u4e0a\u8a13\u7df4\u7684\u4ee3\u5e63\u5668\u7684\u6df7\u5408\u6bd4\u7387\u3002\u7136\u5f8c\uff0c\u6211\u5011\u5c07\u6211\u5011\u7684\u505a\u6cd5\u61c9\u7528\u65bc\u8207\u8fd1\u671f LM \u4e00\u8d77\u767c\u5e03\u7684\u73fe\u6210\u4ee3\u5e63\u5668\u3002\u6211\u5011\u78ba\u8a8d\u4e86\u95dc\u65bc\u9019\u4e9b\u6a21\u578b\u7684\u5927\u91cf\u516c\u958b\u8cc7\u8a0a\uff0c\u4e26\u505a\u51fa\u4e86\u5e7e\u500b\u65b0\u7684\u63a8\u8ad6\uff1aGPT-4o \u7684\u4ee3\u5e63\u5668\u6bd4\u5176\u524d\u8eab\u66f4\u5177\u591a\u8a9e\u8a00\u6027\uff0c\u5728 39% \u7684\u975e\u82f1\u8a9e\u8cc7\u6599\u4e0a\u9032\u884c\u8a13\u7df4\uff1bLlama3 \u4e3b\u8981\u70ba\u591a\u8a9e\u8a00 (48%) \u4f7f\u7528\u800c\u64f4\u5145\u4e86 GPT-3.5 \u7684\u4ee3\u5e63\u5668\uff1bGPT-3.5 \u548c Claude \u7684\u4ee3\u5e63\u5668\u4e3b\u8981\u5728\u7a0b\u5f0f\u78bc (~60%) \u4e0a\u9032\u884c\u8a13\u7df4\u3002\u6211\u5011\u5e0c\u671b\u6211\u5011\u7684\u52aa\u529b\u80fd\u70ba\u9810\u8a13\u7df4\u8cc7\u6599\u7684\u7576\u524d\u8a2d\u8a08\u5be6\u52d9\u63d0\u4f9b\u555f\u767c\uff0c\u4e26\u6fc0\u52f5\u6301\u7e8c\u7814\u7a76 LM \u7684\u8cc7\u6599\u6df7\u5408\u63a8\u8ad6\u3002", "author": "Jonathan Hayase et.al.", "authors": "Jonathan Hayase, Alisa Liu, Yejin Choi, Sewoong Oh, Noah A. Smith", "id": "2407.16607v2", "paper_url": "http://arxiv.org/abs/2407.16607v2", "repo": "null"}}