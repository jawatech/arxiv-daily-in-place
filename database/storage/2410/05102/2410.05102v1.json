{"2410.05102": {"publish_time": "2024-10-07", "title": "SparsePO: Controlling Preference Alignment of LLMs via Sparse Token Masks", "paper_summary": "Preference Optimization (PO) has proven an effective step for aligning\nlanguage models to human-desired behaviors. Current variants, following the\noffline Direct Preference Optimization objective, have focused on a strict\nsetting where all tokens are contributing signals of KL divergence and rewards\nto the loss function. However, human preference is not affected by each word in\na sequence equally but is often dependent on specific words or phrases, e.g.\nexistence of toxic terms leads to non-preferred responses. Based on this\nobservation, we argue that not all tokens should be weighted equally during PO\nand propose a flexible objective termed SparsePO, that aims to automatically\nlearn to weight the KL divergence and reward corresponding to each token during\nPO training. We propose two different variants of weight-masks that can either\nbe derived from the reference model itself or learned on the fly. Notably, our\nmethod induces sparsity in the learned masks, allowing the model to learn how\nto best weight reward and KL divergence contributions at the token level,\nlearning an optimal level of mask sparsity. Extensive experiments on multiple\ndomains, including sentiment control, dialogue, text summarization and\ntext-to-code generation, illustrate that our approach assigns meaningful\nweights to tokens according to the target task, generates more responses with\nthe desired preference and improves reasoning tasks by up to 2 percentage\npoints compared to other token- and response-level PO methods.", "paper_summary_zh": "\u504f\u597d\u4f18\u5316 (PO) \u5df2\u88ab\u8bc1\u660e\u662f\u5c06\u8bed\u8a00\u6a21\u578b\u4e0e\u4eba\u7c7b\u671f\u671b\u884c\u4e3a\u5bf9\u9f50\u7684\u6709\u6548\u6b65\u9aa4\u3002\u9075\u5faa\u79bb\u7ebf\u76f4\u63a5\u504f\u597d\u4f18\u5316\u76ee\u6807\u7684\u5f53\u524d\u53d8\u4f53\u4e13\u6ce8\u4e8e\u4e00\u4e2a\u4e25\u683c\u7684\u8bbe\u7f6e\uff0c\u5176\u4e2d\u6240\u6709\u6807\u8bb0\u90fd\u5728\u4e3a\u635f\u5931\u51fd\u6570\u8d21\u732e KL \u6563\u5ea6\u548c\u5956\u52b1\u7684\u4fe1\u53f7\u3002\u7136\u800c\uff0c\u4eba\u7c7b\u504f\u597d\u4e0d\u4f1a\u53d7\u5230\u5e8f\u5217\u4e2d\u6bcf\u4e2a\u5355\u8bcd\u7684\u5f71\u54cd\uff0c\u800c\u901a\u5e38\u4f9d\u8d56\u4e8e\u7279\u5b9a\u5355\u8bcd\u6216\u77ed\u8bed\uff0c\u4f8b\u5982\u5b58\u5728\u6709\u6bd2\u672f\u8bed\u4f1a\u5bfc\u81f4\u975e\u9996\u9009\u54cd\u5e94\u3002\u57fa\u4e8e\u6b64\u89c2\u5bdf\uff0c\u6211\u4eec\u8ba4\u4e3a\u5728 PO \u671f\u95f4\u5e76\u975e\u6240\u6709\u6807\u8bb0\u90fd\u5e94\u8d4b\u4e88\u540c\u7b49\u6743\u91cd\uff0c\u5e76\u63d0\u51fa\u4e86\u4e00\u4e2a\u7075\u6d3b\u7684\u76ee\u6807\uff0c\u79f0\u4e3a SparsePO\uff0c\u65e8\u5728\u81ea\u52a8\u5b66\u4e60\u5728 PO \u8bad\u7ec3\u671f\u95f4\u4e3a\u6bcf\u4e2a\u6807\u8bb0\u52a0\u6743 KL \u6563\u5ea6\u548c\u5956\u52b1\u3002\u6211\u4eec\u63d0\u51fa\u4e86\u4e24\u79cd\u4e0d\u540c\u7684\u6743\u91cd\u63a9\u7801\u53d8\u4f53\uff0c\u5b83\u4eec\u53ef\u4ee5\u4ece\u53c2\u8003\u6a21\u578b\u672c\u8eab\u6d3e\u751f\u6216\u52a8\u6001\u5b66\u4e60\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u6211\u4eec\u7684\u65b9\u6cd5\u5728\u5b66\u4e60\u7684\u63a9\u7801\u4e2d\u5f15\u5165\u7a00\u758f\u6027\uff0c\u5141\u8bb8\u6a21\u578b\u5b66\u4e60\u5982\u4f55\u6700\u597d\u5730\u5bf9\u6807\u8bb0\u7ea7\u522b\u7684\u5956\u52b1\u548c KL \u6563\u5ea6\u8d21\u732e\u8fdb\u884c\u52a0\u6743\uff0c\u4ece\u800c\u5b66\u4e60\u6700\u4f73\u7684\u63a9\u7801\u7a00\u758f\u6027\u7ea7\u522b\u3002\u5728\u5305\u62ec\u60c5\u611f\u63a7\u5236\u3001\u5bf9\u8bdd\u3001\u6587\u672c\u6458\u8981\u548c\u6587\u672c\u5230\u4ee3\u7801\u751f\u6210\u5728\u5185\u7684\u591a\u4e2a\u9886\u57df\u7684\u5e7f\u6cdb\u5b9e\u9a8c\u8868\u660e\uff0c\u6211\u4eec\u7684\u65b9\u6cd5\u6839\u636e\u76ee\u6807\u4efb\u52a1\u4e3a\u6807\u8bb0\u5206\u914d\u4e86\u6709\u610f\u4e49\u7684\u6743\u91cd\uff0c\u751f\u6210\u4e86\u66f4\u591a\u5177\u6709\u6240\u9700\u504f\u597d\u7684\u54cd\u5e94\uff0c\u5e76\u4e14\u4e0e\u5176\u4ed6\u6807\u8bb0\u548c\u54cd\u5e94\u7ea7\u522b\u7684 PO \u65b9\u6cd5\u76f8\u6bd4\uff0c\u63a8\u7406\u4efb\u52a1\u63d0\u9ad8\u4e86 2 \u4e2a\u767e\u5206\u70b9\u3002", "author": "Fenia Christopoulou et.al.", "authors": "Fenia Christopoulou, Ronald Cardenas, Gerasimos Lampouras, Haitham Bou-Ammar, Jun Wang", "id": "2410.05102v1", "paper_url": "http://arxiv.org/abs/2410.05102v1", "repo": "null"}}