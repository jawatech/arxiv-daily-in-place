{"2406.12775": {"publish_time": "2024-06-18", "title": "Hopping Too Late: Exploring the Limitations of Large Language Models on Multi-Hop Queries", "paper_summary": "Large language models (LLMs) can solve complex multi-step problems, but\nlittle is known about how these computations are implemented internally.\nMotivated by this, we study how LLMs answer multi-hop queries such as \"The\nspouse of the performer of Imagine is\". These queries require two information\nextraction steps: a latent one for resolving the first hop (\"the performer of\nImagine\") into the bridge entity (John Lennon), and one for resolving the\nsecond hop (\"the spouse of John Lennon\") into the target entity (Yoko Ono).\nUnderstanding how the latent step is computed internally is key to\nunderstanding the overall computation. By carefully analyzing the internal\ncomputations of transformer-based LLMs, we discover that the bridge entity is\nresolved in the early layers of the model. Then, only after this resolution,\nthe two-hop query is solved in the later layers. Because the second hop\ncommences in later layers, there could be cases where these layers no longer\nencode the necessary knowledge for correctly predicting the answer. Motivated\nby this, we propose a novel \"back-patching\" analysis method whereby a hidden\nrepresentation from a later layer is patched back to an earlier layer. We find\nthat in up to 57% of previously incorrect cases there exists a back-patch that\nresults in the correct generation of the answer, showing that the later layers\nindeed sometimes lack the needed functionality. Overall our methods and\nfindings open further opportunities for understanding and improving latent\nreasoning in transformer-based LLMs.", "paper_summary_zh": "\u5927\u578b\u8a9e\u8a00\u6a21\u578b (LLM) \u80fd\u89e3\u6c7a\u8907\u96dc\u7684\u591a\u6b65\u9a5f\u554f\u984c\uff0c\u4f46\u5c0d\u65bc\u9019\u4e9b\u8a08\u7b97\u662f\u5982\u4f55\u5728\u5167\u90e8\u57f7\u884c\u7684\uff0c\u6211\u5011\u6240\u77e5\u751a\u5c11\u3002\u53d7\u6b64\u555f\u767c\uff0c\u6211\u5011\u7814\u7a76 LLM \u5982\u4f55\u56de\u7b54\u591a\u8df3\u67e5\u8a62\uff0c\u4f8b\u5982\u300cImagine \u7684\u8868\u6f14\u8005\u7684\u914d\u5076\u662f\u300d\u3002\u9019\u4e9b\u67e5\u8a62\u9700\u8981\u5169\u500b\u8cc7\u8a0a\u62bd\u53d6\u6b65\u9a5f\uff1a\u4e00\u500b\u6f5b\u5728\u6b65\u9a5f\uff0c\u7528\u65bc\u5c07\u7b2c\u4e00\u8df3\uff08\u300cImagine \u7684\u8868\u6f14\u8005\u300d\uff09\u89e3\u6790\u70ba\u6a4b\u63a5\u5be6\u9ad4\uff08\u7d04\u7ff0\u85cd\u5102\uff09\uff0c\u53e6\u4e00\u500b\u6b65\u9a5f\uff0c\u7528\u65bc\u5c07\u7b2c\u4e8c\u8df3\uff08\u300c\u7d04\u7ff0\u85cd\u5102\u7684\u914d\u5076\u300d\uff09\u89e3\u6790\u70ba\u76ee\u6a19\u5be6\u9ad4\uff08\u5c0f\u91ce\u6d0b\u5b50\uff09\u3002\u4e86\u89e3\u6f5b\u5728\u6b65\u9a5f\u5982\u4f55\u5728\u5167\u90e8\u8a08\u7b97\u662f\u4e86\u89e3\u6574\u9ad4\u8a08\u7b97\u7684\u95dc\u9375\u3002\u900f\u904e\u4ed4\u7d30\u5206\u6790\u57fa\u65bc\u8f49\u63db\u5668\u7684 LLM \u7684\u5167\u90e8\u8a08\u7b97\uff0c\u6211\u5011\u767c\u73fe\u6a4b\u63a5\u5be6\u9ad4\u662f\u5728\u6a21\u578b\u7684\u65e9\u671f\u5c64\u89e3\u6790\u7684\u3002\u7136\u5f8c\uff0c\u50c5\u5728\u9019\u500b\u89e3\u6790\u4e4b\u5f8c\uff0c\u5169\u8df3\u67e5\u8a62\u624d\u5728\u5f8c\u7e8c\u5c64\u89e3\u6790\u3002\u7531\u65bc\u7b2c\u4e8c\u8df3\u5728\u5f8c\u7e8c\u5c64\u958b\u59cb\uff0c\u56e0\u6b64\u53ef\u80fd\u6703\u51fa\u73fe\u9019\u4e9b\u5c64\u4e0d\u518d\u7de8\u78bc\u6b63\u78ba\u9810\u6e2c\u7b54\u6848\u6240\u9700\u77e5\u8b58\u7684\u60c5\u6cc1\u3002\u53d7\u6b64\u555f\u767c\uff0c\u6211\u5011\u63d0\u51fa\u4e86\u4e00\u7a2e\u65b0\u7a4e\u7684\u300c\u53cd\u5411\u4fee\u88dc\u300d\u5206\u6790\u65b9\u6cd5\uff0c\u85c9\u6b64\u5c07\u5f8c\u7e8c\u5c64\u7684\u96b1\u85cf\u8868\u793a\u4fee\u88dc\u56de\u65e9\u671f\u5c64\u3002\u6211\u5011\u767c\u73fe\uff0c\u5728\u5148\u524d\u4e0d\u6b63\u78ba\u7684\u6848\u4f8b\u4e2d\uff0c\u6709\u9ad8\u9054 57% \u7684\u6848\u4f8b\u5b58\u5728\u53cd\u5411\u4fee\u88dc\uff0c\u9019\u6703\u5c0e\u81f4\u6b63\u78ba\u7522\u751f\u7b54\u6848\uff0c\u986f\u793a\u5f8c\u7e8c\u5c64\u78ba\u5be6\u6709\u6642\u5019\u7f3a\u4e4f\u6240\u9700\u7684\u6a5f\u80fd\u3002\u7e3d\u9ad4\u800c\u8a00\uff0c\u6211\u5011\u7684\u5404\u7a2e\u65b9\u6cd5\u548c\u767c\u73fe\u70ba\u9032\u4e00\u6b65\u4e86\u89e3\u548c\u6539\u9032\u57fa\u65bc\u8f49\u63db\u5668\u7684 LLM \u4e2d\u7684\u6f5b\u5728\u63a8\u7406\u958b\u95e2\u4e86\u66f4\u591a\u6a5f\u6703\u3002", "author": "Eden Biran et.al.", "authors": "Eden Biran, Daniela Gottesman, Sohee Yang, Mor Geva, Amir Globerson", "id": "2406.12775v1", "paper_url": "http://arxiv.org/abs/2406.12775v1", "repo": "null"}}