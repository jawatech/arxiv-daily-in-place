{"2412.06769": {"publish_time": "2024-12-09", "title": "Training Large Language Models to Reason in a Continuous Latent Space", "paper_summary": "Large language models (LLMs) are restricted to reason in the \"language\nspace\", where they typically express the reasoning process with a\nchain-of-thought (CoT) to solve a complex reasoning problem. However, we argue\nthat language space may not always be optimal for reasoning. For example, most\nword tokens are primarily for textual coherence and not essential for\nreasoning, while some critical tokens require complex planning and pose huge\nchallenges to LLMs. To explore the potential of LLM reasoning in an\nunrestricted latent space instead of using natural language, we introduce a new\nparadigm Coconut (Chain of Continuous Thought). We utilize the last hidden\nstate of the LLM as a representation of the reasoning state (termed \"continuous\nthought\"). Rather than decoding this into a word token, we feed it back to the\nLLM as the subsequent input embedding directly in the continuous space.\nExperiments show that Coconut can effectively augment the LLM on several\nreasoning tasks. This novel latent reasoning paradigm leads to emergent\nadvanced reasoning patterns: the continuous thought can encode multiple\nalternative next reasoning steps, allowing the model to perform a breadth-first\nsearch (BFS) to solve the problem, rather than prematurely committing to a\nsingle deterministic path like CoT. Coconut outperforms CoT in certain logical\nreasoning tasks that require substantial backtracking during planning, with\nfewer thinking tokens during inference. These findings demonstrate the promise\nof latent reasoning and offer valuable insights for future research.", "paper_summary_zh": "\u5927\u578b\u8a9e\u8a00\u6a21\u578b (LLM) \u88ab\u9650\u5236\u5728\u300c\u8a9e\u8a00\u7a7a\u9593\u300d\u4e2d\u63a8\u7406\uff0c\u5728\u8a9e\u8a00\u7a7a\u9593\u4e2d\uff0c\u5b83\u5011\u901a\u5e38\u4f7f\u7528\u601d\u60f3\u93c8 (CoT) \u4f86\u8868\u9054\u63a8\u7406\u904e\u7a0b\uff0c\u4ee5\u89e3\u6c7a\u8907\u96dc\u7684\u63a8\u7406\u554f\u984c\u3002\u7136\u800c\uff0c\u6211\u5011\u8a8d\u70ba\u8a9e\u8a00\u7a7a\u9593\u53ef\u80fd\u4e26\u4e0d\u7e3d\u662f\u63a8\u7406\u7684\u6700\u4f73\u9078\u64c7\u3002\u4f8b\u5982\uff0c\u5927\u591a\u6578\u5b57\u5143\u6a19\u8a18\u4e3b\u8981\u7528\u65bc\u6587\u5b57\u9023\u8cab\u6027\uff0c\u800c\u975e\u63a8\u7406\u7684\u5fc5\u8981\u689d\u4ef6\uff0c\u800c\u67d0\u4e9b\u95dc\u9375\u6a19\u8a18\u5247\u9700\u8981\u8907\u96dc\u7684\u898f\u5283\uff0c\u4e26\u5c0d LLM \u69cb\u6210\u5de8\u5927\u6311\u6230\u3002\u70ba\u4e86\u63a2\u7d22 LLM \u5728\u975e\u53d7\u9650\u6f5b\u5728\u7a7a\u9593\u4e2d\u63a8\u7406\u7684\u53ef\u80fd\u6027\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u81ea\u7136\u8a9e\u8a00\uff0c\u6211\u5011\u5f15\u5165\u4e86\u4e00\u500b\u65b0\u7684\u7bc4\u4f8b Coconut\uff08\u9023\u7e8c\u601d\u60f3\u93c8\uff09\u3002\u6211\u5011\u5229\u7528 LLM \u7684\u6700\u5f8c\u96b1\u85cf\u72c0\u614b\u4f5c\u70ba\u63a8\u7406\u72c0\u614b\u7684\u8868\u793a\uff08\u7a31\u70ba\u300c\u9023\u7e8c\u601d\u60f3\u300d\uff09\u3002\u6211\u5011\u4e26\u672a\u5c07\u5176\u89e3\u78bc\u6210\u5b57\u5143\u6a19\u8a18\uff0c\u800c\u662f\u5c07\u5176\u76f4\u63a5\u5728\u9023\u7e8c\u7a7a\u9593\u4e2d\u4f5c\u70ba\u5f8c\u7e8c\u8f38\u5165\u5d4c\u5165\u56de\u994b\u7d66 LLM\u3002\u5be6\u9a57\u8868\u660e\uff0cCoconut \u53ef\u4ee5\u6709\u6548\u5730\u589e\u5f37 LLM \u5728\u591a\u9805\u63a8\u7406\u4efb\u52d9\u4e0a\u7684\u80fd\u529b\u3002\u9019\u7a2e\u65b0\u7a4e\u7684\u6f5b\u5728\u63a8\u7406\u7bc4\u4f8b\u6703\u5c0e\u81f4\u51fa\u73fe\u9032\u968e\u63a8\u7406\u6a21\u5f0f\uff1a\u9023\u7e8c\u601d\u60f3\u53ef\u4ee5\u7de8\u78bc\u591a\u500b\u5099\u9078\u7684\u5f8c\u7e8c\u63a8\u7406\u6b65\u9a5f\uff0c\u4f7f\u6a21\u578b\u80fd\u5920\u57f7\u884c\u5ee3\u5ea6\u512a\u5148\u641c\u5c0b (BFS) \u4f86\u89e3\u6c7a\u554f\u984c\uff0c\u800c\u4e0d\u662f\u50cf CoT \u90a3\u6a23\u904e\u65e9\u5730\u627f\u8afe\u55ae\u4e00\u7684\u78ba\u5b9a\u6027\u8def\u5f91\u3002\u5728\u67d0\u4e9b\u908f\u8f2f\u63a8\u7406\u4efb\u52d9\u4e2d\uff0cCoconut \u512a\u65bc CoT\uff0c\u9019\u4e9b\u4efb\u52d9\u9700\u8981\u5728\u898f\u5283\u904e\u7a0b\u4e2d\u9032\u884c\u5927\u91cf\u7684\u56de\u6eaf\uff0c\u63a8\u7406\u671f\u9593\u7684\u601d\u8003\u6a19\u8a18\u8f03\u5c11\u3002\u9019\u4e9b\u767c\u73fe\u8b49\u660e\u4e86\u6f5b\u5728\u63a8\u7406\u7684\u524d\u666f\uff0c\u4e26\u70ba\u672a\u4f86\u7684\u7814\u7a76\u63d0\u4f9b\u4e86\u5bf6\u8cb4\u7684\u898b\u89e3\u3002", "author": "Shibo Hao et.al.", "authors": "Shibo Hao, Sainbayar Sukhbaatar, DiJia Su, Xian Li, Zhiting Hu, Jason Weston, Yuandong Tian", "id": "2412.06769v1", "paper_url": "http://arxiv.org/abs/2412.06769v1", "repo": "null"}}