{"2405.20320": {"publish_time": "2024-05-30", "title": "Improving the Training of Rectified Flows", "paper_summary": "Diffusion models have shown great promise for image and video generation, but\nsampling from state-of-the-art models requires expensive numerical integration\nof a generative ODE. One approach for tackling this problem is rectified flows,\nwhich iteratively learn smooth ODE paths that are less susceptible to\ntruncation error. However, rectified flows still require a relatively large\nnumber of function evaluations (NFEs). In this work, we propose improved\ntechniques for training rectified flows, allowing them to compete with\nknowledge distillation methods even in the low NFE setting. Our main insight is\nthat under realistic settings, a single iteration of the Reflow algorithm for\ntraining rectified flows is sufficient to learn nearly straight trajectories;\nhence, the current practice of using multiple Reflow iterations is unnecessary.\nWe thus propose techniques to improve one-round training of rectified flows,\nincluding a U-shaped timestep distribution and LPIPS-Huber premetric. With\nthese techniques, we improve the FID of the previous 2-rectified flow by up to\n72% in the 1 NFE setting on CIFAR-10. On ImageNet 64$\\times$64, our improved\nrectified flow outperforms the state-of-the-art distillation methods such as\nconsistency distillation and progressive distillation in both one-step and\ntwo-step settings and rivals the performance of improved consistency training\n(iCT) in FID. Code is available at https://github.com/sangyun884/rfpp.", "paper_summary_zh": "\u64f4\u6563\u6a21\u578b\u5728\u5f71\u50cf\u548c\u5f71\u7247\u751f\u6210\u65b9\u9762\u5c55\u73fe\u51fa\u6975\u5927\u7684\u6f5b\u529b\uff0c\u4f46\u5f9e\u6700\u5148\u9032\u7684\u6a21\u578b\u4e2d\u9032\u884c\u53d6\u6a23\u9700\u8981\u9032\u884c\u7522\u751f\u5f0f ODE \u7684\u6602\u8cb4\u6578\u503c\u7a4d\u5206\u3002\u89e3\u6c7a\u6b64\u554f\u984c\u7684\u4e00\u7a2e\u65b9\u6cd5\u662f\u4fee\u6b63\u6d41\uff0c\u5b83\u53cd\u8986\u5b78\u7fd2\u8f03\u4e0d\u5bb9\u6613\u53d7\u5230\u622a\u65b7\u8aa4\u5dee\u5f71\u97ff\u7684\u5e73\u6ed1 ODE \u8def\u5f91\u3002\u7136\u800c\uff0c\u4fee\u6b63\u6d41\u4ecd\u7136\u9700\u8981\u76f8\u5c0d\u5927\u91cf\u7684\u51fd\u6578\u8a55\u4f30 (NFE)\u3002\u5728\u9019\u9805\u5de5\u4f5c\u4e2d\uff0c\u6211\u5011\u63d0\u51fa\u6539\u9032\u7684\u4fee\u6b63\u6d41\u8a13\u7df4\u6280\u8853\uff0c\u8b93\u5b83\u5011\u5373\u4f7f\u5728\u4f4e NFE \u8a2d\u5b9a\u4e0b\u4e5f\u80fd\u8207\u77e5\u8b58\u8403\u53d6\u65b9\u6cd5\u7af6\u722d\u3002\u6211\u5011\u7684\u898b\u89e3\u5728\u65bc\uff0c\u5728\u73fe\u5be6\u7684\u8a2d\u5b9a\u4e0b\uff0c\u8a13\u7df4\u4fee\u6b63\u6d41\u7684 Reflow \u6f14\u7b97\u6cd5\u53ea\u9700\u53cd\u8986\u904b\u7b97\u4e00\u6b21\u5c31\u8db3\u4ee5\u5b78\u7fd2\u5e7e\u4e4e\u662f\u76f4\u7dda\u7684\u8ecc\u8de1\uff1b\u56e0\u6b64\uff0c\u76ee\u524d\u4f7f\u7528\u591a\u91cd Reflow \u53cd\u8986\u904b\u7b97\u7684\u505a\u6cd5\u662f\u4e0d\u5fc5\u8981\u7684\u3002\u56e0\u6b64\uff0c\u6211\u5011\u63d0\u51fa\u6539\u9032\u4fee\u6b63\u6d41\u4e00\u8f2a\u8a13\u7df4\u7684\u6280\u8853\uff0c\u5305\u62ec U \u5f62\u6642\u9593\u6b65\u9577\u5206\u4f48\u548c LPIPS-Huber \u524d\u5ea6\u91cf\u3002\u6709\u4e86\u9019\u4e9b\u6280\u8853\uff0c\u6211\u5011\u5728 CIFAR-10 \u7684 1 NFE \u8a2d\u5b9a\u4e0b\uff0c\u5c07\u5148\u524d 2 \u4fee\u6b63\u6d41\u7684 FID \u63d0\u5347\u4e86 72%\u3002\u5728 ImageNet 64\u00d764 \u4e0a\uff0c\u6211\u5011\u6539\u826f\u7684\u4fee\u6b63\u6d41\u5728\u55ae\u6b65\u548c\u5169\u6b65\u8a2d\u5b9a\u4e0b\u90fd\u512a\u65bc\u6700\u5148\u9032\u7684\u8403\u53d6\u65b9\u6cd5\uff0c\u4f8b\u5982\u4e00\u81f4\u6027\u8403\u53d6\u548c\u6f38\u9032\u5f0f\u8403\u53d6\uff0c\u4e26\u4e14\u5728 FID \u4e2d\u8207\u6539\u826f\u4e00\u81f4\u6027\u8a13\u7df4 (iCT) \u7684\u6548\u80fd\u76f8\u5339\u6575\u3002\u7a0b\u5f0f\u78bc\u53ef\u5728 https://github.com/sangyun884/rfpp \u53d6\u5f97\u3002", "author": "Sangyun Lee et.al.", "authors": "Sangyun Lee, Zinan Lin, Giulia Fanti", "id": "2405.20320v1", "paper_url": "http://arxiv.org/abs/2405.20320v1", "repo": "https://github.com/sangyun884/rfpp"}}