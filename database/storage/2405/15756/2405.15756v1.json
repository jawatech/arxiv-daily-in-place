{"2405.15756": {"publish_time": "2024-05-24", "title": "Sparse Expansion and Neuronal Disentanglement", "paper_summary": "We show how to improve the inference efficiency of an LLM by expanding it\ninto a mixture of sparse experts, where each expert is a copy of the original\nweights, one-shot pruned for a specific cluster of input values. We call this\napproach $\\textit{Sparse Expansion}$. We show that, for models such as Llama 2\n70B, as we increase the number of sparse experts, Sparse Expansion outperforms\nall other one-shot sparsification approaches for the same inference FLOP budget\nper token, and that this gap grows as sparsity increases, leading to inference\nspeedups.\n  But why? To answer this, we provide strong evidence that the mixture of\nsparse experts is effectively $\\textit{disentangling}$ the input-output\nrelationship of every individual neuron across clusters of inputs.\nSpecifically, sparse experts approximate the dense neuron output distribution\nwith fewer weights by decomposing the distribution into a collection of simpler\nones, each with a separate sparse dot product covering it. Interestingly, we\nshow that the Wasserstein distance between a neuron's output distribution and a\nGaussian distribution is an indicator of its entanglement level and\ncontribution to the accuracy of the model. Every layer of an LLM has a fraction\nof highly entangled Wasserstein neurons, and model performance suffers more\nwhen these are sparsified as opposed to others.", "paper_summary_zh": "\u6211\u5011\u5c55\u793a\u5982\u4f55\u900f\u904e\u5c07 LLM \u64f4\u5145\u70ba\u7a00\u758f\u5c08\u5bb6\u7d44\u5408\u4f86\u63d0\u5347\u63a8\u8ad6\u6548\u7387\uff0c\u5176\u4e2d\u6bcf\u500b\u5c08\u5bb6\u90fd\u662f\u539f\u59cb\u6b0a\u91cd\u7684\u526f\u672c\uff0c\u91dd\u5c0d\u7279\u5b9a\u8f38\u5165\u503c\u7fa4\u96c6\u9032\u884c\u4e00\u6b21\u6027\u526a\u679d\u3002\u6211\u5011\u7a31\u9019\u7a2e\u65b9\u6cd5\u70ba\u300c\u7a00\u758f\u64f4\u5145\u300d\u3002\u6211\u5011\u5c55\u793a\uff0c\u5c0d\u65bc Llama 2 70B \u7b49\u6a21\u578b\uff0c\u96a8\u8457\u6211\u5011\u589e\u52a0\u7a00\u758f\u5c08\u5bb6\u7684\u6578\u91cf\uff0c\u7a00\u758f\u64f4\u5145\u5728\u76f8\u540c\u7684\u6bcf\u4ee4\u724c\u63a8\u8ad6 FLOP \u9810\u7b97\u4e0a\u512a\u65bc\u6240\u6709\u5176\u4ed6\u4e00\u6b21\u6027\u7a00\u758f\u5316\u65b9\u6cd5\uff0c\u4e26\u4e14\u96a8\u8457\u7a00\u758f\u6027\u7684\u589e\u52a0\uff0c\u6b64\u5dee\u8ddd\u6703\u64f4\u5927\uff0c\u5c0e\u81f4\u63a8\u8ad6\u52a0\u901f\u3002\n\u4f46\u70ba\u4ec0\u9ebc\uff1f\u70ba\u4e86\u56de\u7b54\u9019\u500b\u554f\u984c\uff0c\u6211\u5011\u63d0\u4f9b\u4e86\u5f37\u6709\u529b\u7684\u8b49\u64da\uff0c\u8b49\u660e\u7a00\u758f\u5c08\u5bb6\u7d44\u5408\u6709\u6548\u5730\u300c\u89e3\u958b\u300d\u4e86\u6bcf\u500b\u500b\u5225\u795e\u7d93\u5143\u5728\u8f38\u5165\u7fa4\u96c6\u4e2d\u7684\u8f38\u5165\u8f38\u51fa\u95dc\u4fc2\u3002\u5177\u9ad4\u4f86\u8aaa\uff0c\u7a00\u758f\u5c08\u5bb6\u900f\u904e\u5c07\u5206\u4f48\u5206\u89e3\u70ba\u4e00\u7cfb\u5217\u8f03\u7c21\u55ae\u7684\u5206\u4f48\uff08\u6bcf\u500b\u5206\u4f48\u90fd\u6709\u55ae\u7368\u7684\u7a00\u758f\u9ede\u7a4d\u8986\u84cb\u5b83\uff09\u4f86\u8fd1\u4f3c\u5bc6\u96c6\u795e\u7d93\u5143\u8f38\u51fa\u5206\u4f48\uff0c\u4e26\u4f7f\u7528\u8f03\u5c11\u7684\u6b0a\u91cd\u3002\u6709\u8da3\u7684\u662f\uff0c\u6211\u5011\u5c55\u793a\u4e86\u4e00\u500b\u795e\u7d93\u5143\u8f38\u51fa\u5206\u4f48\u8207\u9ad8\u65af\u5206\u4f48\u4e4b\u9593\u7684 Wasserstein \u8ddd\u96e2\u662f\u5176\u7cfe\u7e8f\u7a0b\u5ea6\u548c\u5c0d\u6a21\u578b\u6e96\u78ba\u6027\u8ca2\u737b\u7684\u6307\u6a19\u3002LLM \u7684\u6bcf\u4e00\u5c64\u90fd\u6709\u4e00\u90e8\u5206\u9ad8\u5ea6\u7cfe\u7e8f\u7684 Wasserstein \u795e\u7d93\u5143\uff0c\u4e26\u4e14\u7576\u9019\u4e9b\u795e\u7d93\u5143\u88ab\u7a00\u758f\u5316\uff08\u76f8\u5c0d\u65bc\u5176\u4ed6\u795e\u7d93\u5143\uff09\u6642\uff0c\u6a21\u578b\u6548\u80fd\u6703\u53d7\u5230\u66f4\u5927\u7684\u5f71\u97ff\u3002", "author": "Shashata Sawmya et.al.", "authors": "Shashata Sawmya, Linghao Kong, Ilia Markov, Dan Alistarh, Nir Shavit", "id": "2405.15756v1", "paper_url": "http://arxiv.org/abs/2405.15756v1", "repo": "null"}}