{"2502.12085": {"publish_time": "2025-02-17", "title": "APB: Accelerating Distributed Long-Context Inference by Passing Compressed Context Blocks across GPUs", "paper_summary": "While long-context inference is crucial for advancing large language model\n(LLM) applications, its prefill speed remains a significant bottleneck. Current\napproaches, including sequence parallelism strategies and compute reduction\nthrough approximate attention mechanisms, still fall short of delivering\noptimal inference efficiency. This hinders scaling the inputs to longer\nsequences and processing long-context queries in a timely manner. To address\nthis, we introduce APB, an efficient long-context inference framework that\nleverages multi-host approximate attention to enhance prefill speed by reducing\ncompute and enhancing parallelism simultaneously. APB introduces a\ncommunication mechanism for essential key-value pairs within a sequence\nparallelism framework, enabling a faster inference speed while maintaining task\nperformance. We implement APB by incorporating a tailored FlashAttn kernel\nalongside optimized distribution strategies, supporting diverse models and\nparallelism configurations. APB achieves speedups of up to 9.2x, 4.2x, and 1.6x\ncompared with FlashAttn, RingAttn, and StarAttn, respectively, without any\nobservable task performance degradation. We provide the implementation and\nexperiment code of APB in https://github.com/thunlp/APB.", "paper_summary_zh": "\u96d6\u7136\u9577\u6587\u672c\u63a8\u7406\u5c0d\u65bc\u63a8\u9032\u5927\u578b\u8a9e\u8a00\u6a21\u578b (LLM) \u61c9\u7528\u81f3\u95dc\u91cd\u8981\uff0c\u4f46\u5176\u9810\u586b\u5145\u901f\u5ea6\u4ecd\u7136\u662f\u4e00\u500b\u91cd\u5927\u7684\u74f6\u9838\u3002\u76ee\u524d\u7684\u5404\u7a2e\u65b9\u6cd5\uff0c\u5305\u62ec\u5e8f\u5217\u4e26\u884c\u7b56\u7565\u548c\u900f\u904e\u8fd1\u4f3c\u6ce8\u610f\u529b\u6a5f\u5236\u6e1b\u5c11\u904b\u7b97\uff0c\u4ecd\u7136\u7121\u6cd5\u63d0\u4f9b\u6700\u4f73\u7684\u63a8\u7406\u6548\u7387\u3002\u9019\u6703\u963b\u7919\u5c07\u8f38\u5165\u64f4\u5c55\u5230\u66f4\u9577\u7684\u5e8f\u5217\uff0c\u4ee5\u53ca\u53ca\u6642\u8655\u7406\u9577\u6587\u672c\u67e5\u8a62\u3002\u70ba\u4e86\u89e3\u6c7a\u9019\u500b\u554f\u984c\uff0c\u6211\u5011\u5f15\u5165\u4e86 APB\uff0c\u9019\u662f\u4e00\u500b\u9ad8\u6548\u7684\u9577\u6587\u672c\u63a8\u7406\u67b6\u69cb\uff0c\u5b83\u5229\u7528\u591a\u4e3b\u6a5f\u8fd1\u4f3c\u6ce8\u610f\u529b\u4f86\u6e1b\u5c11\u904b\u7b97\u4e26\u540c\u6642\u63d0\u9ad8\u4e26\u884c\u6027\uff0c\u5f9e\u800c\u63d0\u9ad8\u9810\u586b\u5145\u901f\u5ea6\u3002APB \u5728\u5e8f\u5217\u4e26\u884c\u67b6\u69cb\u4e2d\u5f15\u5165\u4e86\u4e00\u500b\u7528\u65bc\u57fa\u672c\u9375\u503c\u5c0d\u7684\u901a\u8a0a\u6a5f\u5236\uff0c\u5728\u7dad\u6301\u4efb\u52d9\u6548\u80fd\u7684\u540c\u6642\uff0c\u5be6\u73fe\u66f4\u5feb\u7684\u63a8\u7406\u901f\u5ea6\u3002\u6211\u5011\u900f\u904e\u6574\u5408\u4e00\u500b\u91cf\u8eab\u6253\u9020\u7684 FlashAttn \u6838\u5fc3\u4ee5\u53ca\u6700\u4f73\u5316\u7684\u5206\u4f48\u7b56\u7565\u4f86\u5be6\u4f5c APB\uff0c\u652f\u63f4\u5404\u7a2e\u6a21\u578b\u548c\u4e26\u884c\u914d\u7f6e\u3002\u8207 FlashAttn\u3001RingAttn \u548c StarAttn \u76f8\u6bd4\uff0cAPB \u5206\u5225\u5be6\u73fe\u4e86\u9ad8\u9054 9.2 \u500d\u30014.2 \u500d\u548c 1.6 \u500d\u7684\u52a0\u901f\uff0c\u540c\u6642\u6c92\u6709\u4efb\u4f55\u53ef\u89c0\u5bdf\u5230\u7684\u4efb\u52d9\u6548\u80fd\u4e0b\u964d\u3002\u6211\u5011\u5728 https://github.com/thunlp/APB \u4e2d\u63d0\u4f9b\u4e86 APB \u7684\u5be6\u4f5c\u548c\u5be6\u9a57\u7a0b\u5f0f\u78bc\u3002", "author": "Yuxiang Huang et.al.", "authors": "Yuxiang Huang, Mingye Li, Xu Han, Chaojun Xiao, Weilin Zhao, Sun Ao, Hao Zhou, Jie Zhou, Zhiyuan Liu, Maosong Sun", "id": "2502.12085v1", "paper_url": "http://arxiv.org/abs/2502.12085v1", "repo": "null"}}