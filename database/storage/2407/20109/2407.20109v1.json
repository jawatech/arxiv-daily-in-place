{"2407.20109": {"publish_time": "2024-07-29", "title": "Diffusion-DICE: In-Sample Diffusion Guidance for Offline Reinforcement Learning", "paper_summary": "One important property of DIstribution Correction Estimation (DICE) methods\nis that the solution is the optimal stationary distribution ratio between the\noptimized and data collection policy. In this work, we show that DICE-based\nmethods can be viewed as a transformation from the behavior distribution to the\noptimal policy distribution. Based on this, we propose a novel approach,\nDiffusion-DICE, that directly performs this transformation using diffusion\nmodels. We find that the optimal policy's score function can be decomposed into\ntwo terms: the behavior policy's score function and the gradient of a guidance\nterm which depends on the optimal distribution ratio. The first term can be\nobtained from a diffusion model trained on the dataset and we propose an\nin-sample learning objective to learn the second term. Due to the\nmulti-modality contained in the optimal policy distribution, the transformation\nin Diffusion-DICE may guide towards those local-optimal modes. We thus generate\na few candidate actions and carefully select from them to approach\nglobal-optimum. Different from all other diffusion-based offline RL methods,\nthe guide-then-select paradigm in Diffusion-DICE only uses in-sample actions\nfor training and brings minimal error exploitation in the value function. We\nuse a didatic toycase example to show how previous diffusion-based methods fail\nto generate optimal actions due to leveraging these errors and how\nDiffusion-DICE successfully avoids that. We then conduct extensive experiments\non benchmark datasets to show the strong performance of Diffusion-DICE.", "paper_summary_zh": "\u5206\u4f48\u4fee\u6b63\u4f30\u8a08 (DICE) \u65b9\u6cd5\u7684\u4e00\u500b\u91cd\u8981\u5c6c\u6027\u662f\uff0c\u89e3\u70ba\u6700\u4f73\u5316\u548c\u8cc7\u6599\u6536\u96c6\u653f\u7b56\u4e4b\u9593\u7684\u6700\u4f73\u7a69\u614b\u5206\u4f48\u6bd4\u7387\u3002\u5728\u9019\u9805\u5de5\u4f5c\u4e2d\uff0c\u6211\u5011\u5c55\u793a\u57fa\u65bc DICE \u7684\u65b9\u6cd5\u53ef\u4ee5\u8996\u70ba\u5f9e\u884c\u70ba\u5206\u4f48\u5230\u6700\u4f73\u653f\u7b56\u5206\u4f48\u7684\u8f49\u63db\u3002\u57fa\u65bc\u6b64\uff0c\u6211\u5011\u63d0\u51fa\u4e86\u4e00\u7a2e\u65b0\u7a4e\u7684\u65b9\u6cd5\uff0c\u64f4\u6563-DICE\uff0c\u5b83\u4f7f\u7528\u64f4\u6563\u6a21\u578b\u76f4\u63a5\u57f7\u884c\u6b64\u8f49\u63db\u3002\u6211\u5011\u767c\u73fe\u6700\u4f73\u653f\u7b56\u7684\u8a55\u5206\u51fd\u6578\u53ef\u4ee5\u5206\u89e3\u70ba\u5169\u500b\u8853\u8a9e\uff1a\u884c\u70ba\u653f\u7b56\u7684\u8a55\u5206\u51fd\u6578\u548c\u4f9d\u8cf4\u65bc\u6700\u4f73\u5206\u4f48\u6bd4\u7387\u7684\u5f15\u5c0e\u9805\u7684\u68af\u5ea6\u3002\u7b2c\u4e00\u500b\u8853\u8a9e\u53ef\u4ee5\u5f9e\u5728\u8cc7\u6599\u96c6\u4e0a\u8a13\u7df4\u7684\u64f4\u6563\u6a21\u578b\u4e2d\u7372\u5f97\uff0c\u6211\u5011\u63d0\u51fa\u4e86\u4e00\u500b\u6a23\u672c\u5167\u5b78\u7fd2\u76ee\u6a19\u4f86\u5b78\u7fd2\u7b2c\u4e8c\u500b\u8853\u8a9e\u3002\u7531\u65bc\u6700\u4f73\u653f\u7b56\u5206\u4f48\u4e2d\u5305\u542b\u591a\u6a21\u614b\uff0c\u56e0\u6b64\u64f4\u6563-DICE \u4e2d\u7684\u8f49\u63db\u53ef\u80fd\u6703\u671d\u5411\u90a3\u4e9b\u5c40\u90e8\u6700\u4f73\u6a21\u5f0f\u3002\u56e0\u6b64\uff0c\u6211\u5011\u6703\u7522\u751f\u4e00\u4e9b\u5019\u9078\u52d5\u4f5c\uff0c\u4e26\u5f9e\u4e2d\u4ed4\u7d30\u9078\u64c7\u4ee5\u63a5\u8fd1\u5168\u5c40\u6700\u512a\u3002\u8207\u6240\u6709\u5176\u4ed6\u57fa\u65bc\u64f4\u6563\u7684\u96e2\u7dda RL \u65b9\u6cd5\u4e0d\u540c\uff0c\u64f4\u6563-DICE \u4e2d\u7684\u5148\u5f15\u5c0e\u5f8c\u9078\u64c7\u7bc4\u4f8b\u50c5\u4f7f\u7528\u6a23\u672c\u5167\u52d5\u4f5c\u9032\u884c\u8a13\u7df4\uff0c\u4e26\u5728\u50f9\u503c\u51fd\u6578\u4e2d\u5e36\u4f86\u6700\u5c0f\u7684\u932f\u8aa4\u5229\u7528\u3002\u6211\u5011\u4f7f\u7528\u4e00\u500b\u6559\u5b78\u73a9\u5177\u6848\u4f8b\u4f86\u8aaa\u660e\u5148\u524d\u7684\u57fa\u65bc\u64f4\u6563\u7684\u65b9\u6cd5\u5982\u4f55\u56e0\u5229\u7528\u9019\u4e9b\u932f\u8aa4\u800c\u7121\u6cd5\u7522\u751f\u6700\u4f73\u52d5\u4f5c\uff0c\u4ee5\u53ca\u64f4\u6563-DICE \u5982\u4f55\u6210\u529f\u907f\u514d\u9019\u7a2e\u60c5\u6cc1\u3002\u7136\u5f8c\uff0c\u6211\u5011\u5728\u57fa\u6e96\u8cc7\u6599\u96c6\u4e0a\u9032\u884c\u5ee3\u6cdb\u7684\u5be6\u9a57\uff0c\u4ee5\u5c55\u793a\u64f4\u6563-DICE \u7684\u5f37\u5927\u6548\u80fd\u3002", "author": "Liyuan Mao et.al.", "authors": "Liyuan Mao, Haoran Xu, Weinan Zhang, Xianyuan Zhan, Amy Zhang", "id": "2407.20109v1", "paper_url": "http://arxiv.org/abs/2407.20109v1", "repo": "null"}}