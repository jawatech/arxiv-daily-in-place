{"2407.17686": {"publish_time": "2024-07-25", "title": "Transformers on Markov Data: Constant Depth Suffices", "paper_summary": "Attention-based transformers have been remarkably successful at modeling\ngenerative processes across various domains and modalities. In this paper, we\nstudy the behavior of transformers on data drawn from \\kth Markov processes,\nwhere the conditional distribution of the next symbol in a sequence depends on\nthe previous $k$ symbols observed. We observe a surprising phenomenon\nempirically which contradicts previous findings: when trained for sufficiently\nlong, a transformer with a fixed depth and $1$ head per layer is able to\nachieve low test loss on sequences drawn from \\kth Markov sources, even as $k$\ngrows. Furthermore, this low test loss is achieved by the transformer's ability\nto represent and learn the in-context conditional empirical distribution. On\nthe theoretical side, our main result is that a transformer with a single head\nand three layers can represent the in-context conditional empirical\ndistribution for \\kth Markov sources, concurring with our empirical\nobservations. Along the way, we prove that \\textit{attention-only} transformers\nwith $O(\\log_2(k))$ layers can represent the in-context conditional empirical\ndistribution by composing induction heads to track the previous $k$ symbols in\nthe sequence. These results provide more insight into our current understanding\nof the mechanisms by which transformers learn to capture context, by\nunderstanding their behavior on Markov sources.", "paper_summary_zh": "\u57fa\u65bc\u6ce8\u610f\u529b\u7684Transformer\u5728\u5c0d\u5404\u7a2e\u9818\u57df\u548c\u6a21\u614b\u7684\u751f\u6210\u5f0f\u904e\u7a0b\u5efa\u6a21\u65b9\u9762\u53d6\u5f97\u4e86\u986f\u8457\u7684\u6210\u529f\u3002\u5728\u672c\u6587\u4e2d\uff0c\u6211\u5011\u7814\u7a76\u4e86Transformer\u5728\u5f9e k \u968e\u99ac\u53ef\u592b\u904e\u7a0b\u4e2d\u63d0\u53d6\u7684\u8cc7\u6599\u4e0a\u7684\u884c\u70ba\uff0c\u5176\u4e2d\u5e8f\u5217\u4e2d\u4e0b\u4e00\u500b\u7b26\u865f\u7684\u689d\u4ef6\u5206\u4f48\u53d6\u6c7a\u65bc\u89c0\u5bdf\u5230\u7684\u524d k \u500b\u7b26\u865f\u3002\u6211\u5011\u5728\u7d93\u9a57\u4e0a\u89c0\u5bdf\u5230\u4e00\u500b\u9a5a\u4eba\u7684\u73fe\u8c61\uff0c\u9019\u8207\u5148\u524d\u7684\u767c\u73fe\u76f8\u77db\u76fe\uff1a\u7d93\u904e\u5145\u5206\u9577\u7684\u8a13\u7df4\u5f8c\uff0c\u5177\u6709\u56fa\u5b9a\u6df1\u5ea6\u548c\u6bcf\u5c64 1 \u500b\u982d\u7684Transformer\u80fd\u5920\u5728\u5f9e k \u968e\u99ac\u53ef\u592b\u6e90\u4e2d\u63d0\u53d6\u7684\u5e8f\u5217\u4e0a\u5be6\u73fe\u4f4e\u6e2c\u8a66\u640d\u5931\uff0c\u5373\u4f7f k \u589e\u9577\u3002\u6b64\u5916\uff0c\u9019\u7a2e\u4f4e\u6e2c\u8a66\u640d\u5931\u662f\u901a\u904eTransformer\u8868\u793a\u548c\u5b78\u7fd2\u4e0a\u4e0b\u6587\u689d\u4ef6\u7d93\u9a57\u5206\u4f48\u7684\u80fd\u529b\u5be6\u73fe\u7684\u3002\u5728\u7406\u8ad6\u65b9\u9762\uff0c\u6211\u5011\u7684\u7684\u4e3b\u8981\u7d50\u679c\u662f\u5177\u6709\u55ae\u500b\u982d\u548c\u4e09\u5c64\u7684Transformer\u53ef\u4ee5\u8868\u793a k \u968e\u99ac\u53ef\u592b\u6e90\u7684\u4e0a\u4e0b\u6587\u689d\u4ef6\u7d93\u9a57\u5206\u4f48\uff0c\u9019\u8207\u6211\u5011\u7684\u7d93\u9a57\u89c0\u5bdf\u7d50\u679c\u4e00\u81f4\u3002\u5728\u6b64\u904e\u7a0b\u4e2d\uff0c\u6211\u5011\u8b49\u660e\u4e86\u5177\u6709 O(log_2(k)) \u5c64\u7684\u300c\u50c5\u6ce8\u610f\u529b\u300dTransformer\u53ef\u4ee5\u901a\u904e\u7d44\u5408\u6b78\u7d0d\u982d\u90e8\u4f86\u8ffd\u8e64\u5e8f\u5217\u4e2d\u7684\u524d k \u500b\u7b26\u865f\uff0c\u5f9e\u800c\u8868\u793a\u4e0a\u4e0b\u6587\u689d\u4ef6\u7d93\u9a57\u5206\u4f48\u3002\u9019\u4e9b\u7d50\u679c\u901a\u904e\u7406\u89e3Transformer\u5728\u99ac\u53ef\u592b\u6e90\u4e0a\u7684\u884c\u70ba\uff0c\u5c0d\u6211\u5011\u7576\u524d\u5c0dTransformer\u5b78\u7fd2\u6355\u6349\u4e0a\u4e0b\u6587\u7684\u6a5f\u5236\u7684\u7406\u89e3\u63d0\u4f9b\u4e86\u66f4\u591a\u898b\u89e3\u3002", "author": "Nived Rajaraman et.al.", "authors": "Nived Rajaraman, Marco Bondaschi, Kannan Ramchandran, Michael Gastpar, Ashok Vardhan Makkuva", "id": "2407.17686v1", "paper_url": "http://arxiv.org/abs/2407.17686v1", "repo": "null"}}