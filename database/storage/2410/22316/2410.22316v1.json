{"2410.22316": {"publish_time": "2024-10-29", "title": "Understanding Synthetic Context Extension via Retrieval Heads", "paper_summary": "Long-context LLMs are increasingly in demand for applications such as\nretrieval-augmented generation. To defray the cost of pretraining LLMs over\nlong contexts, recent work takes an approach of synthetic context extension:\nfine-tuning LLMs with synthetically generated long-context data in a\npost-training stage. However, it remains unclear how and why this synthetic\ncontext extension imparts abilities for downstream long-context tasks. In this\npaper, we investigate fine-tuning on synthetic data for three long-context\ntasks that require retrieval and reasoning. We vary the realism of \"needle\"\nconcepts to be retrieved and diversity of the surrounding \"haystack\" context,\nfrom using LLMs to construct synthetic documents to using templated relations\nand creating symbolic datasets. We find that models trained on synthetic data\nfall short of the real data, but surprisingly, the mismatch can be interpreted\nand even predicted in terms of a special set of attention heads that are\nresponsible for retrieval over long context: retrieval heads (Wu et al., 2024).\nThe retrieval heads learned on synthetic data are mostly subsets of the\nretrieval heads learned on real data, and there is a strong correlation between\nthe recall of heads learned and the downstream performance of a model.\nFurthermore, with attention knockout and activation patching, we\nmechanistically show that retrieval heads are necessary and explain model\nperformance, although they are not totally sufficient. Our results shed light\non how to interpret synthetic data fine-tuning performance and how to approach\ncreating better data for learning real-world capabilities over long contexts.", "paper_summary_zh": "\u9577\u8a9e\u5883 LLM \u5c0d\u6aa2\u7d22\u589e\u5f37\u751f\u6210\u7b49\u61c9\u7528\u7a0b\u5f0f\u9700\u6c42\u65e5\u589e\u3002\u70ba\u4e86\u964d\u4f4e LLM \u5728\u9577\u8a9e\u5883\u4e0a\u9032\u884c\u9810\u8a13\u7df4\u7684\u6210\u672c\uff0c\u6700\u8fd1\u7684\u7814\u7a76\u63a1\u7528\u5408\u6210\u8a9e\u5883\u5ef6\u4f38\u65b9\u6cd5\uff1a\u5728\u5f8c\u8a13\u7df4\u968e\u6bb5\u4f7f\u7528\u5408\u6210\u7522\u751f\u7684\u9577\u8a9e\u5883\u8cc7\u6599\u5fae\u8abf LLM\u3002\u7136\u800c\uff0c\u5408\u6210\u8a9e\u5883\u5ef6\u4f38\u5982\u4f55\u4ee5\u53ca\u70ba\u4f55\u8ce6\u4e88\u4e0b\u6e38\u9577\u8a9e\u5883\u4efb\u52d9\u80fd\u529b\uff0c\u4ecd\u4e0d\u6e05\u695a\u3002\u5728\u672c\u6587\u4e2d\uff0c\u6211\u5011\u63a2\u8a0e\u91dd\u5c0d\u4e09\u500b\u9700\u8981\u6aa2\u7d22\u548c\u63a8\u7406\u7684\u9577\u8a9e\u5883\u4efb\u52d9\u9032\u884c\u5408\u6210\u8cc7\u6599\u5fae\u8abf\u3002\u6211\u5011\u6539\u8b8a\u4e86\u8981\u6aa2\u7d22\u7684\u300c\u91dd\u300d\u6982\u5ff5\u7684\u771f\u5be6\u6027\uff0c\u4ee5\u53ca\u5468\u570d\u300c\u4e7e\u8349\u5806\u300d\u8a9e\u5883\u7684\u5dee\u7570\u6027\uff0c\u5f9e\u4f7f\u7528 LLM \u5efa\u69cb\u5408\u6210\u6587\u4ef6\u5230\u4f7f\u7528\u7bc4\u672c\u95dc\u4fc2\u4e26\u5efa\u7acb\u7b26\u865f\u8cc7\u6599\u96c6\u3002\u6211\u5011\u767c\u73fe\uff0c\u5728\u5408\u6210\u8cc7\u6599\u4e0a\u8a13\u7df4\u7684\u6a21\u578b\u4e0d\u5982\u771f\u5be6\u8cc7\u6599\uff0c\u4f46\u4ee4\u4eba\u9a5a\u8a1d\u7684\u662f\uff0c\u9019\u7a2e\u4e0d\u5339\u914d\u53ef\u4ee5\u7528\u4e00\u7d44\u7279\u6b8a\u7684\u6ce8\u610f\u529b\u982d\u4f86\u8a6e\u91cb\uff0c\u751a\u81f3\u9810\u6e2c\uff0c\u9019\u4e9b\u6ce8\u610f\u529b\u982d\u8ca0\u8cac\u5728\u9577\u8a9e\u5883\u4e2d\u9032\u884c\u6aa2\u7d22\uff1a\u6aa2\u7d22\u982d\uff08Wu \u7b49\u4eba\uff0c2024\uff09\u3002\u5728\u5408\u6210\u8cc7\u6599\u4e0a\u5b78\u7fd2\u7684\u6aa2\u7d22\u982d\u5927\u591a\u662f\u771f\u5be6\u8cc7\u6599\u4e0a\u5b78\u7fd2\u7684\u6aa2\u7d22\u982d\u7684\u5b50\u96c6\uff0c\u4e26\u4e14\u5b78\u7fd2\u7684\u982d\u7684\u53ec\u56de\u7387\u8207\u6a21\u578b\u7684\u4e0b\u6e38\u6548\u80fd\u4e4b\u9593\u5b58\u5728\u5f88\u5f37\u7684\u95dc\u806f\u6027\u3002\u6b64\u5916\uff0c\u900f\u904e\u6ce8\u610f\u529b\u5254\u9664\u548c\u555f\u7528\u4fee\u88dc\uff0c\u6211\u5011\u6a5f\u68b0\u6027\u5730\u8868\u660e\u6aa2\u7d22\u982d\u662f\u5fc5\u8981\u7684\uff0c\u4e26\u89e3\u91cb\u6a21\u578b\u6548\u80fd\uff0c\u5118\u7ba1\u5b83\u5011\u4e26\u975e\u5b8c\u5168\u8db3\u5920\u3002\u6211\u5011\u7684\u7d50\u679c\u95e1\u660e\u4e86\u5982\u4f55\u8a6e\u91cb\u5408\u6210\u8cc7\u6599\u5fae\u8abf\u6548\u80fd\uff0c\u4ee5\u53ca\u5982\u4f55\u8457\u624b\u5efa\u7acb\u66f4\u597d\u7684\u8cc7\u6599\uff0c\u4ee5\u5b78\u7fd2\u5728\u9577\u8a9e\u5883\u4e2d\u5b78\u7fd2\u771f\u5be6\u4e16\u754c\u7684\u80fd\u529b\u3002", "author": "Xinyu Zhao et.al.", "authors": "Xinyu Zhao, Fangcong Yin, Greg Durrett", "id": "2410.22316v1", "paper_url": "http://arxiv.org/abs/2410.22316v1", "repo": "null"}}