{"2411.11055": {"publish_time": "2024-11-17", "title": "FastDraft: How to Train Your Draft", "paper_summary": "Speculative Decoding has gained popularity as an effective technique for\naccelerating the auto-regressive inference process of Large Language Models\n(LLMs). However, Speculative Decoding entirely relies on the availability of\nefficient draft models, which are often lacking for many existing language\nmodels due to a stringent constraint of vocabulary incompatibility. In this\nwork we introduce FastDraft, a novel and efficient approach for pre-training\nand aligning a draft model to any large language model by incorporating\nefficient pre-training, followed by fine-tuning over synthetic datasets\ngenerated by the target model. We demonstrate FastDraft by training two highly\nparameter efficient drafts for the popular Phi-3-mini and Llama-3.1-8B models.\nUsing FastDraft, we were able to produce a draft with approximately 10 billion\ntokens on a single server with 8 Intel$^\\circledR$ Gaudi$^\\circledR$ 2\naccelerators in under 24 hours. Our results show that the draft model achieves\nimpressive results in key metrics of acceptance rate, block efficiency and up\nto 3x memory bound speed up when evaluated on code completion and up to 2x in\nsummarization, text completion and instruction tasks. We validate our\ntheoretical findings through benchmarking on the latest Intel$^\\circledR$\nCore$^{\\tiny \\text{TM}}$ Ultra, achieving a wall-clock time speedup of up to\n2x, indicating a significant reduction in runtime. Due to its high quality,\nFastDraft unlocks large language models inference on AI-PC and other\nedge-devices.", "paper_summary_zh": "<paragraph>\u63a8\u6e2c\u89e3\u78bc\u4f5c\u70ba\u4e00\u7a2e\u52a0\u901f\u5927\u578b\u8a9e\u8a00\u6a21\u578b (LLM) \u81ea\u8ff4\u6b78\u63a8\u8ad6\u904e\u7a0b\u7684\u6709\u6548\u6280\u8853\u800c\u7372\u5f97\u666e\u53ca\u3002\u7136\u800c\uff0c\u63a8\u6e2c\u89e3\u78bc\u5b8c\u5168\u4f9d\u8cf4\u65bc\u9ad8\u6548\u8349\u7a3f\u6a21\u578b\u7684\u53ef\u7528\u6027\uff0c\u800c\u9019\u5c0d\u65bc\u8a31\u591a\u73fe\u6709\u8a9e\u8a00\u6a21\u578b\u4f86\u8aaa\u5f80\u5f80\u662f\u7f3a\u4e4f\u7684\uff0c\u56e0\u70ba\u5b58\u5728\u8a5e\u5f59\u4e0d\u517c\u5bb9\u7684\u56b4\u683c\u7d04\u675f\u3002\u5728\u672c\u6587\u4e2d\uff0c\u6211\u5011\u4ecb\u7d39\u4e86 FastDraft\uff0c\u9019\u662f\u4e00\u7a2e\u65b0\u7a4e\u4e14\u9ad8\u6548\u7684\u65b9\u6cd5\uff0c\u7528\u65bc\u9810\u8a13\u7df4\u548c\u5c07\u8349\u7a3f\u6a21\u578b\u8207\u4efb\u4f55\u5927\u578b\u8a9e\u8a00\u6a21\u578b\u5c0d\u9f4a\uff0c\u65b9\u6cd5\u662f\u7d50\u5408\u9ad8\u6548\u7684\u9810\u8a13\u7df4\uff0c\u7136\u5f8c\u6839\u64da\u76ee\u6a19\u6a21\u578b\u751f\u6210\u7684\u5408\u6210\u6578\u64da\u96c6\u9032\u884c\u5fae\u8abf\u3002\u6211\u5011\u901a\u904e\u8a13\u7df4\u5169\u500b\u9ad8\u5ea6\u53c3\u6578\u9ad8\u6548\u7684\u8349\u7a3f\u4f86\u5c55\u793a FastDraft\uff0c\u7528\u65bc\u6d41\u884c\u7684 Phi-3-mini \u548c Llama-3.1-8B \u6a21\u578b\u3002\u4f7f\u7528 FastDraft\uff0c\u6211\u5011\u80fd\u5920\u5728\u4e0d\u5230 24 \u5c0f\u6642\u7684\u6642\u9593\u88e1\uff0c\u4f7f\u7528 8 \u500b Intel$^\\circledR$ Gaudi$^\\circledR$ 2 \u52a0\u901f\u5668\u5728\u55ae\u500b\u4f3a\u670d\u5668\u4e0a\u751f\u6210\u7d04 100 \u5104\u500b\u4ee3\u5e63\u7684\u8349\u7a3f\u3002\u6211\u5011\u7684\u7d50\u679c\u8868\u660e\uff0c\u5728\u4ee3\u78bc\u5b8c\u6210\u6642\u8a55\u4f30\u6642\uff0c\u8349\u7a3f\u6a21\u578b\u5728\u63a5\u53d7\u7387\u3001\u5340\u584a\u6548\u7387\u548c\u8a18\u61b6\u9ad4\u9650\u5236\u901f\u5ea6\u65b9\u9762\u53d6\u5f97\u4e86\u4ee4\u4eba\u5370\u8c61\u6df1\u523b\u7684\u7d50\u679c\uff0c\u5206\u5225\u9ad8\u9054 3 \u500d\u548c 2 \u500d\uff0c\u5728\u6458\u8981\u3001\u6587\u672c\u5b8c\u6210\u548c\u6307\u4ee4\u4efb\u52d9\u4e2d\u4e5f\u53d6\u5f97\u4e86\u540c\u6a23\u7684\u7d50\u679c\u3002\u6211\u5011\u901a\u904e\u5728\u6700\u65b0\u7684 Intel$^\\circledR$ Core$^{\\tiny \\text{TM}}$ Ultra \u4e0a\u9032\u884c\u57fa\u6e96\u6e2c\u8a66\u9a57\u8b49\u4e86\u6211\u5011\u7684\u7406\u8ad6\u767c\u73fe\uff0c\u5be6\u73fe\u4e86\u9ad8\u9054 2 \u500d\u7684\u6642\u8108\u6642\u9593\u52a0\u901f\uff0c\u8868\u660e\u57f7\u884c\u6642\u9593\u986f\u8457\u6e1b\u5c11\u3002\u7531\u65bc\u5176\u9ad8\u54c1\u8cea\uff0cFastDraft \u5728 AI-PC \u548c\u5176\u4ed6\u908a\u7de3\u8a2d\u5099\u4e0a\u89e3\u9396\u4e86\u5927\u578b\u8a9e\u8a00\u6a21\u578b\u63a8\u8ad6\u3002</paragraph>", "author": "Ofir Zafrir et.al.", "authors": "Ofir Zafrir, Igor Margulis, Dorin Shteyman, Guy Boudoukh", "id": "2411.11055v1", "paper_url": "http://arxiv.org/abs/2411.11055v1", "repo": "null"}}