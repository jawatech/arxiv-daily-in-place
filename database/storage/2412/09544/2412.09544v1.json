{"2412.09544": {"publish_time": "2024-12-12", "title": "Sail into the Headwind: Alignment via Robust Rewards and Dynamic Labels against Reward Hacking", "paper_summary": "Aligning AI systems with human preferences typically suffers from the\ninfamous reward hacking problem, where optimization of an imperfect reward\nmodel leads to undesired behaviors. In this paper, we investigate reward\nhacking in offline preference optimization, which aims to improve an initial\nmodel using a preference dataset. We identify two types of reward hacking\nstemming from statistical fluctuations in the dataset: Type I Reward Hacking\ndue to subpar choices appearing more favorable, and Type II Reward Hacking due\nto decent choices appearing less favorable. We prove that many (mainstream or\ntheoretical) preference optimization methods suffer from both types of reward\nhacking. To mitigate Type I Reward Hacking, we propose POWER, a new preference\noptimization method that combines Guiasu's weighted entropy with a robust\nreward maximization objective. POWER enjoys finite-sample guarantees under\ngeneral function approximation, competing with the best covered policy in the\ndata. To mitigate Type II Reward Hacking, we analyze the learning dynamics of\npreference optimization and develop a novel technique that dynamically updates\npreference labels toward certain \"stationary labels\", resulting in diminishing\ngradients for untrustworthy samples. Empirically, POWER with dynamic labels\n(POWER-DL) consistently outperforms state-of-the-art methods on alignment\nbenchmarks, achieving improvements of up to 13.0 points on AlpacaEval 2.0 and\n11.5 points on Arena-Hard over DPO, while also improving or maintaining\nperformance on downstream tasks such as mathematical reasoning. Strong\ntheoretical guarantees and empirical results demonstrate the promise of\nPOWER-DL in mitigating reward hacking.", "paper_summary_zh": "\u5c0d\u9f4a\u4eba\u5de5\u667a\u6167\u7cfb\u7d71\u8207\u4eba\u985e\u504f\u597d\u901a\u5e38\u6703\u906d\u9047\u60e1\u540d\u662d\u5f70\u7684\u734e\u52f5\u7834\u89e3\u554f\u984c\uff0c\u5176\u4e2d\u4e0d\u5b8c\u7f8e\u7684\u734e\u52f5\u6a21\u578b\u7684\u6700\u4f73\u5316\u6703\u5c0e\u81f4\u4e0d\u60f3\u8981\u7684\u884c\u70ba\u3002\u5728\u672c\u8ad6\u6587\u4e2d\uff0c\u6211\u5011\u63a2\u8a0e\u96e2\u7dda\u504f\u597d\u6700\u4f73\u5316\u4e2d\u7684\u734e\u52f5\u7834\u89e3\uff0c\u5176\u76ee\u6a19\u662f\u4f7f\u7528\u504f\u597d\u8cc7\u6599\u96c6\u6539\u5584\u521d\u59cb\u6a21\u578b\u3002\u6211\u5011\u627e\u51fa\u6e90\u81ea\u8cc7\u6599\u96c6\u4e2d\u7d71\u8a08\u6ce2\u52d5\u7684\u5169\u7a2e\u734e\u52f5\u7834\u89e3\u985e\u578b\uff1a\u7531\u65bc\u8f03\u5dee\u7684\u9078\u64c7\u770b\u8d77\u4f86\u8f03\u6709\u5229\u800c\u7522\u751f\u7684\u7b2c\u4e00\u578b\u734e\u52f5\u7834\u89e3\uff0c\u4ee5\u53ca\u7531\u65bc\u8f03\u597d\u7684\u9078\u64c7\u770b\u8d77\u4f86\u8f03\u4e0d\u5229\u800c\u7522\u751f\u7684\u7b2c\u4e8c\u578b\u734e\u52f5\u7834\u89e3\u3002\u6211\u5011\u8b49\u660e\u8a31\u591a\uff08\u4e3b\u6d41\u6216\u7406\u8ad6\uff09\u504f\u597d\u6700\u4f73\u5316\u65b9\u6cd5\u90fd\u6703\u906d\u9047\u9019\u5169\u7a2e\u985e\u578b\u7684\u734e\u52f5\u7834\u89e3\u3002\u70ba\u4e86\u6e1b\u8f15\u7b2c\u4e00\u578b\u734e\u52f5\u7834\u89e3\uff0c\u6211\u5011\u63d0\u51fa POWER\uff0c\u9019\u662f\u4e00\u7a2e\u7d50\u5408\u4e86 Guiasu \u7684\u52a0\u6b0a\u71b5\u8207\u7a69\u5065\u734e\u52f5\u6700\u5927\u5316\u76ee\u6a19\u7684\u65b0\u504f\u597d\u6700\u4f73\u5316\u65b9\u6cd5\u3002POWER \u5728\u4e00\u822c\u51fd\u6578\u903c\u8fd1\u4e0b\u4eab\u6709\u6709\u9650\u6a23\u672c\u4fdd\u8b49\uff0c\u8207\u8cc7\u6599\u4e2d\u6db5\u84cb\u6700\u5ee3\u7684\u653f\u7b56\u7af6\u722d\u3002\u70ba\u4e86\u6e1b\u8f15\u7b2c\u4e8c\u578b\u734e\u52f5\u7834\u89e3\uff0c\u6211\u5011\u5206\u6790\u504f\u597d\u6700\u4f73\u5316\u7684\u5b78\u7fd2\u52d5\u614b\uff0c\u4e26\u958b\u767c\u4e00\u7a2e\u65b0\u6280\u8853\uff0c\u5c07\u504f\u597d\u6a19\u7c64\u52d5\u614b\u66f4\u65b0\u70ba\u67d0\u4e9b\u300c\u56fa\u5b9a\u6a19\u7c64\u300d\uff0c\u5c0e\u81f4\u4e0d\u53ef\u4fe1\u6a23\u672c\u7684\u68af\u5ea6\u905e\u6e1b\u3002\u6839\u64da\u7d93\u9a57\uff0c\u5177\u6709\u52d5\u614b\u6a19\u7c64\u7684 POWER\uff08POWER-DL\uff09\u5728\u5c0d\u9f4a\u57fa\u6e96\u4e0a\u59cb\u7d42\u512a\u65bc\u6700\u5148\u9032\u7684\u65b9\u6cd5\uff0c\u5728 AlpacaEval 2.0 \u4e0a\u7684\u6539\u9032\u5e45\u5ea6\u9ad8\u9054 13.0 \u500b\u767e\u5206\u9ede\uff0c\u5728 Arena-Hard \u4e0a\u6bd4 DPO \u9ad8 11.5 \u500b\u767e\u5206\u9ede\uff0c\u540c\u6642\u4e5f\u6539\u5584\u6216\u7dad\u6301\u4e86\u4e0b\u6e38\u4efb\u52d9\uff08\u4f8b\u5982\u6578\u5b78\u63a8\u7406\uff09\u7684\u6548\u80fd\u3002\u5f37\u5927\u7684\u7406\u8ad6\u4fdd\u8b49\u548c\u7d93\u9a57\u7d50\u679c\u8b49\u660e\u4e86 POWER-DL \u5728\u6e1b\u8f15\u734e\u52f5\u7834\u89e3\u65b9\u9762\u7684\u6f5b\u529b\u3002", "author": "Paria Rashidinejad et.al.", "authors": "Paria Rashidinejad, Yuandong Tian", "id": "2412.09544v1", "paper_url": "http://arxiv.org/abs/2412.09544v1", "repo": "null"}}