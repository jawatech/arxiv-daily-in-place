{"2412.19792": {"publish_time": "2024-12-27", "title": "InfAlign: Inference-aware language model alignment", "paper_summary": "Language model alignment has become a critical step in training modern\ngenerative language models. The goal of alignment is to finetune a reference\nmodel such that the win rate of a sample from the aligned model over a sample\nfrom the reference model is high, subject to a KL divergence constraint. Today,\nwe are increasingly using inference-time algorithms (e.g., Best-of-N,\ncontrolled decoding, tree search) to decode from language models rather than\nstandard sampling. However, the alignment objective does not capture such\ninference-time decoding procedures. We show that the existing alignment\nframework is sub-optimal in view of such inference-time methods. We then modify\nthe alignment objective and propose a framework for inference-aware alignment\n(IAPO). We prove that for any inference-time decoding algorithm, the optimal\nsolution that optimizes the inference-time win rate of the aligned policy\nagainst the reference policy is the solution to the typical RLHF problem with a\ntransformation of the reward. This motivates us to provide the KL-regularized\ncalibrate-and-transform RL (CTRL) algorithm to solve this problem, which\ninvolves a reward calibration step and a KL-regularized reward maximization\nstep with a transformation of the calibrated reward. We particularize our study\nto two important inference-time strategies: best-of-N sampling and best-of-N\njailbreaking, where N responses are sampled from the model and the one with the\nhighest or lowest reward is selected. We propose specific transformations for\nthese strategies and demonstrate that our framework offers significant\nimprovements over existing state-of-the-art methods for language model\nalignment. Empirically, we outperform baselines that are designed without\ntaking inference-time decoding into consideration by 8-12% and 4-9% on\ninference-time win rates over the Anthropic helpfulness and harmlessness dialog\nbenchmark datasets.", "paper_summary_zh": "\u8a9e\u8a00\u6a21\u578b\u6bd4\u5c0d\u5df2\u6210\u70ba\u8a13\u7df4\u73fe\u4ee3\u751f\u6210\u5f0f\u8a9e\u8a00\u6a21\u578b\u4e2d\u7684\u95dc\u9375\u6b65\u9a5f\u3002\u6bd4\u5c0d\u7684\u76ee\u6a19\u662f\u5fae\u8abf\u4e00\u500b\u53c3\u8003\u6a21\u578b\uff0c\u4f7f\u5f97\u6bd4\u5c0d\u6a21\u578b\u4e2d\u6a23\u672c\u5728\u53c3\u8003\u6a21\u578b\u4e2d\u6a23\u672c\u4e0a\u7684\u7372\u52dd\u7387\u5f88\u9ad8\uff0c\u4f46\u540c\u6642\u8981\u7b26\u5408 KL \u6563\u5ea6\u7d04\u675f\u3002\u5982\u4eca\uff0c\u6211\u5011\u8d8a\u4f86\u8d8a\u5e38\u4f7f\u7528\u63a8\u8ad6\u6642\u9593\u6f14\u7b97\u6cd5\uff08\u4f8b\u5982\u6700\u4f73 N \u9078\u4e00\u3001\u53d7\u63a7\u89e3\u78bc\u3001\u6a39\u72c0\u641c\u5c0b\uff09\u5f9e\u8a9e\u8a00\u6a21\u578b\u4e2d\u89e3\u78bc\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u6a19\u6e96\u62bd\u6a23\u3002\u7136\u800c\uff0c\u6bd4\u5c0d\u76ee\u6a19\u4e26\u672a\u6db5\u84cb\u6b64\u985e\u63a8\u8ad6\u6642\u9593\u89e3\u78bc\u7a0b\u5e8f\u3002\u6211\u5011\u8868\u660e\uff0c\u73fe\u6709\u7684\u6bd4\u5c0d\u67b6\u69cb\u5c0d\u65bc\u6b64\u985e\u63a8\u8ad6\u6642\u9593\u65b9\u6cd5\u800c\u8a00\u4e26\u975e\u6700\u4f73\u3002\u7136\u5f8c\uff0c\u6211\u5011\u4fee\u6539\u6bd4\u5c0d\u76ee\u6a19\uff0c\u4e26\u63d0\u51fa\u4e00\u500b\u7528\u65bc\u63a8\u7406\u611f\u77e5\u6bd4\u5c0d (IAPO) \u7684\u67b6\u69cb\u3002\u6211\u5011\u8b49\u660e\uff0c\u5c0d\u65bc\u4efb\u4f55\u63a8\u8ad6\u6642\u9593\u89e3\u78bc\u6f14\u7b97\u6cd5\uff0c\u6700\u4f73\u5316\u6bd4\u5c0d\u653f\u7b56\u76f8\u5c0d\u65bc\u53c3\u8003\u653f\u7b56\u7684\u63a8\u8ad6\u6642\u9593\u7372\u52dd\u7387\u7684\u6700\u4f73\u89e3\uff0c\u5c31\u662f\u5177\u6709\u734e\u52f5\u8f49\u63db\u7684\u5178\u578b RLHF \u554f\u984c\u7684\u89e3\u3002\u9019\u4fc3\u4f7f\u6211\u5011\u63d0\u4f9b KL \u6b63\u898f\u5316\u7684\u6821\u6e96\u548c\u8f49\u63db RL (CTRL) \u6f14\u7b97\u6cd5\u4f86\u89e3\u6c7a\u6b64\u554f\u984c\uff0c\u5176\u4e2d\u5305\u62ec\u734e\u52f5\u6821\u6e96\u6b65\u9a5f\u548c\u5177\u6709\u6821\u6e96\u734e\u52f5\u8f49\u63db\u7684 KL \u6b63\u898f\u5316\u734e\u52f5\u6700\u5927\u5316\u6b65\u9a5f\u3002\u6211\u5011\u5c07\u7814\u7a76\u5177\u9ad4\u5316\u70ba\u5169\u500b\u91cd\u8981\u7684\u63a8\u8ad6\u6642\u9593\u7b56\u7565\uff1a\u6700\u4f73 N \u9078\u4e00\u62bd\u6a23\u548c\u6700\u4f73 N \u9078\u4e00\u8d8a\u7344\uff0c\u5176\u4e2d\u5f9e\u6a21\u578b\u4e2d\u62bd\u53d6 N \u500b\u56de\u61c9\uff0c\u4e26\u9078\u64c7\u5177\u6709\u6700\u9ad8\u6216\u6700\u4f4e\u734e\u52f5\u7684\u56de\u61c9\u3002\u6211\u5011\u63d0\u51fa\u9019\u4e9b\u7b56\u7565\u7684\u7279\u5b9a\u8f49\u63db\uff0c\u4e26\u8b49\u660e\u6211\u5011\u7684\u67b6\u69cb\u76f8\u8f03\u65bc\u73fe\u6709\u7684\u8a9e\u8a00\u6a21\u578b\u6bd4\u5c0d\u6700\u65b0\u65b9\u6cd5\u6709\u986f\u8457\u7684\u6539\u5584\u3002\u6839\u64da\u7d93\u9a57\uff0c\u6211\u5011\u5728 Anthropic \u52a9\u76ca\u6027\u548c\u7121\u5bb3\u6027\u5c0d\u8a71\u57fa\u6e96\u8cc7\u6599\u96c6\u4e0a\uff0c\u8d85\u8d8a\u672a\u8003\u616e\u63a8\u8ad6\u6642\u9593\u89e3\u78bc\u800c\u8a2d\u8a08\u7684\u57fa\u6e96\uff0c\u63a8\u8ad6\u6642\u9593\u7372\u52dd\u7387\u9ad8\u51fa 8-12% \u548c 4-9%\u3002", "author": "Ananth Balashankar et.al.", "authors": "Ananth Balashankar, Ziteng Sun, Jonathan Berant, Jacob Eisenstein, Michael Collins, Adrian Hutter, Jong Lee, Chirag Nagpal, Flavien Prost, Aradhana Sinha, and Ananda Theertha Suresh, Ahmad Beirami", "id": "2412.19792v1", "paper_url": "http://arxiv.org/abs/2412.19792v1", "repo": "null"}}