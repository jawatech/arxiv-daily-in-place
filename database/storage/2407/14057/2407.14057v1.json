{"2407.14057": {"publish_time": "2024-07-19", "title": "LazyLLM: Dynamic Token Pruning for Efficient Long Context LLM Inference", "paper_summary": "The inference of transformer-based large language models consists of two\nsequential stages: 1) a prefilling stage to compute the KV cache of prompts and\ngenerate the first token, and 2) a decoding stage to generate subsequent\ntokens. For long prompts, the KV cache must be computed for all tokens during\nthe prefilling stage, which can significantly increase the time needed to\ngenerate the first token. Consequently, the prefilling stage may become a\nbottleneck in the generation process. An open question remains whether all\nprompt tokens are essential for generating the first token. To answer this, we\nintroduce a novel method, LazyLLM, that selectively computes the KV for tokens\nimportant for the next token prediction in both the prefilling and decoding\nstages. Contrary to static pruning approaches that prune the prompt at once,\nLazyLLM allows language models to dynamically select different subsets of\ntokens from the context in different generation steps, even though they might\nbe pruned in previous steps. Extensive experiments on standard datasets across\nvarious tasks demonstrate that LazyLLM is a generic method that can be\nseamlessly integrated with existing language models to significantly accelerate\nthe generation without fine-tuning. For instance, in the multi-document\nquestion-answering task, LazyLLM accelerates the prefilling stage of the LLama\n2 7B model by 2.34x while maintaining accuracy.", "paper_summary_zh": "\u57fa\u65bc Transformer \u7684\u5927\u578b\u8a9e\u8a00\u6a21\u578b\u7684\u63a8\u8ad6\u5305\u542b\u5169\u500b\u9806\u5e8f\u968e\u6bb5\uff1a1) \u9810\u586b\u5145\u968e\u6bb5\uff0c\u7528\u65bc\u8a08\u7b97\u63d0\u793a\u7684 KV \u5feb\u53d6\u4e26\u7522\u751f\u7b2c\u4e00\u500b\u7b26\u865f\uff0c\u4ee5\u53ca 2) \u89e3\u78bc\u968e\u6bb5\uff0c\u7528\u65bc\u7522\u751f\u5f8c\u7e8c\u7b26\u865f\u3002\u5c0d\u65bc\u9577\u63d0\u793a\uff0c\u5fc5\u9808\u5728\u9810\u586b\u5145\u968e\u6bb5\u70ba\u6240\u6709\u7b26\u865f\u8a08\u7b97 KV \u5feb\u53d6\uff0c\u9019\u6703\u5927\u5e45\u589e\u52a0\u7522\u751f\u7b2c\u4e00\u500b\u7b26\u865f\u6240\u9700\u7684\u6642\u9593\u3002\u56e0\u6b64\uff0c\u9810\u586b\u5145\u968e\u6bb5\u53ef\u80fd\u6703\u6210\u70ba\u7522\u751f\u904e\u7a0b\u4e2d\u7684\u74f6\u9838\u3002\u4e00\u500b\u958b\u653e\u6027\u7684\u554f\u984c\u4ecd\u7136\u662f\uff0c\u6240\u6709\u63d0\u793a\u7b26\u865f\u5c0d\u65bc\u7522\u751f\u7b2c\u4e00\u500b\u7b26\u865f\u662f\u5426\u90fd\u662f\u5fc5\u8981\u7684\u3002\u70ba\u4e86\u56de\u7b54\u9019\u500b\u554f\u984c\uff0c\u6211\u5011\u5f15\u5165\u4e86\u4e00\u500b\u65b0\u65b9\u6cd5\uff0cLazyLLM\uff0c\u5b83\u5728\u9810\u586b\u5145\u548c\u89e3\u78bc\u968e\u6bb5\u6709\u9078\u64c7\u5730\u8a08\u7b97\u5c0d\u65bc\u4e0b\u4e00\u500b\u7b26\u865f\u9810\u6e2c\u5f88\u91cd\u8981\u7684\u7b26\u865f\u7684 KV\u3002\u8207\u4e00\u6b21\u4fee\u526a\u63d0\u793a\u7684\u975c\u614b\u4fee\u526a\u65b9\u6cd5\u76f8\u53cd\uff0cLazyLLM \u5141\u8a31\u8a9e\u8a00\u6a21\u578b\u5728\u4e0d\u540c\u7684\u7522\u751f\u6b65\u9a5f\u4e2d\u5f9e\u4e0a\u4e0b\u6587\u4e2d\u52d5\u614b\u9078\u64c7\u7b26\u865f\u7684\u4e0d\u540c\u5b50\u96c6\uff0c\u5373\u4f7f\u5b83\u5011\u53ef\u80fd\u5728\u5148\u524d\u7684\u6b65\u9a5f\u4e2d\u88ab\u4fee\u526a\u3002\u5728\u5404\u7a2e\u4efb\u52d9\u4e0a\u5c0d\u6a19\u6e96\u8cc7\u6599\u96c6\u9032\u884c\u7684\u5ee3\u6cdb\u5be6\u9a57\u8868\u660e\uff0cLazyLLM \u662f\u4e00\u7a2e\u901a\u7528\u65b9\u6cd5\uff0c\u53ef\u4ee5\u7121\u7e2b\u5730\u8207\u73fe\u6709\u8a9e\u8a00\u6a21\u578b\u6574\u5408\uff0c\u4ee5\u5728\u4e0d\u9032\u884c\u5fae\u8abf\u7684\u60c5\u6cc1\u4e0b\u986f\u8457\u52a0\u901f\u7522\u751f\u3002\u4f8b\u5982\uff0c\u5728\u591a\u6587\u4ef6\u554f\u7b54\u4efb\u52d9\u4e2d\uff0cLazyLLM \u5c07 LLama 2 7B \u6a21\u578b\u7684\u9810\u586b\u5145\u968e\u6bb5\u52a0\u901f\u4e86 2.34 \u500d\uff0c\u540c\u6642\u4fdd\u6301\u4e86\u6e96\u78ba\u6027\u3002", "author": "Qichen Fu et.al.", "authors": "Qichen Fu, Minsik Cho, Thomas Merth, Sachin Mehta, Mohammad Rastegari, Mahyar Najibi", "id": "2407.14057v1", "paper_url": "http://arxiv.org/abs/2407.14057v1", "repo": "null"}}