{"2410.07145": {"publish_time": "2024-10-09", "title": "Stuffed Mamba: State Collapse and State Capacity of RNN-Based Long-Context Modeling", "paper_summary": "One essential advantage of recurrent neural networks (RNNs) over\ntransformer-based language models is their linear computational complexity\nconcerning the sequence length, which makes them much faster in handling long\nsequences during inference. However, most publicly available RNNs (e.g., Mamba\nand RWKV) are trained on sequences with less than 10K tokens, and their\neffectiveness in longer contexts remains largely unsatisfying so far. In this\npaper, we study the cause of the inability to process long context for RNNs and\nsuggest critical mitigations. We examine two practical concerns when applying\nstate-of-the-art RNNs to long contexts: (1) the inability to extrapolate to\ninputs longer than the training length and (2) the upper bound of memory\ncapacity. Addressing the first concern, we first investigate *state collapse*\n(SC), a phenomenon that causes severe performance degradation on sequence\nlengths not encountered during training. With controlled experiments, we\nattribute this to overfitting due to the recurrent state being\noverparameterized for the training length. For the second concern, we train a\nseries of Mamba-2 models on long documents to empirically estimate the\nrecurrent state capacity in language modeling and passkey retrieval. Then,\nthree SC mitigation methods are proposed to improve Mamba-2's length\ngeneralizability, allowing the model to process more than 1M tokens without SC.\nWe also find that the recurrent state capacity in passkey retrieval scales\nexponentially to the state size, and we empirically train a Mamba-2 370M with\nnear-perfect passkey retrieval accuracy on 256K context length. This suggests a\npromising future for RNN-based long-context modeling.", "paper_summary_zh": "\u905e\u8ff4\u795e\u7d93\u7db2\u8def (RNN) \u76f8\u8f03\u65bc\u57fa\u65bcTransformer\u7684\u8a9e\u8a00\u6a21\u578b\uff0c\u6709\u4e00\u500b\u91cd\u8981\u7684\u512a\u52e2\uff0c\u5c31\u662f\u5176\u7dda\u6027\u8a08\u7b97\u8907\u96dc\u5ea6\u8207\u5e8f\u5217\u9577\u5ea6\u6709\u95dc\uff0c\u9019\u4f7f\u5f97\u5b83\u5011\u5728\u63a8\u7406\u904e\u7a0b\u4e2d\u8655\u7406\u9577\u5e8f\u5217\u6642\u5feb\u5f88\u591a\u3002\u7136\u800c\uff0c\u5927\u591a\u6578\u516c\u958b\u7684 RNN\uff08\u4f8b\u5982 Mamba \u548c RWKV\uff09\u90fd\u662f\u91dd\u5c0d\u5c11\u65bc 10K \u7b26\u865f\u7684\u5e8f\u5217\u9032\u884c\u8a13\u7df4\uff0c\u800c\u5b83\u5011\u5728\u8f03\u9577\u8108\u7d61\u4e2d\u7684\u6709\u6548\u6027\u81f3\u4eca\u4ecd\u6975\u4e0d\u4ee4\u4eba\u6eff\u610f\u3002\u5728\u672c\u6587\u4e2d\uff0c\u6211\u5011\u7814\u7a76\u4e86 RNN \u7121\u6cd5\u8655\u7406\u9577\u8108\u7d61\u7684\u539f\u56e0\uff0c\u4e26\u63d0\u51fa\u91cd\u8981\u7684\u89e3\u6c7a\u65b9\u6848\u3002\u6211\u5011\u63a2\u8a0e\u4e86\u5728\u5c07\u6700\u5148\u9032\u7684 RNN \u61c9\u7528\u65bc\u9577\u8108\u7d61\u6642\u9047\u5230\u7684\u5169\u500b\u5be6\u969b\u554f\u984c\uff1a(1) \u7121\u6cd5\u5916\u63a8\u5230\u9577\u65bc\u8a13\u7df4\u9577\u5ea6\u7684\u8f38\u5165\uff0c\u4ee5\u53ca (2) \u8a18\u61b6\u5bb9\u91cf\u7684\u4e0a\u9650\u3002\u91dd\u5c0d\u7b2c\u4e00\u500b\u554f\u984c\uff0c\u6211\u5011\u9996\u5148\u63a2\u8a0e\u300c\u72c0\u614b\u5d29\u6f70\u300d(SC)\uff0c\u9019\u662f\u4e00\u500b\u6703\u5c0e\u81f4\u5728\u8a13\u7df4\u904e\u7a0b\u4e2d\u672a\u9047\u5230\u7684\u5e8f\u5217\u9577\u5ea6\u4e0a\u9020\u6210\u56b4\u91cd\u6548\u80fd\u4e0b\u964d\u7684\u73fe\u8c61\u3002\u900f\u904e\u53d7\u63a7\u5be6\u9a57\uff0c\u6211\u5011\u5c07\u6b64\u6b78\u56e0\u65bc\u7531\u65bc\u905e\u8ff4\u72c0\u614b\u5c0d\u65bc\u8a13\u7df4\u9577\u5ea6\u800c\u8a00\u904e\u5ea6\u53c3\u6578\u5316\u800c\u5c0e\u81f4\u7684\u904e\u5ea6\u64ec\u5408\u3002\u91dd\u5c0d\u7b2c\u4e8c\u500b\u554f\u984c\uff0c\u6211\u5011\u5728\u9577\u6587\u4ef6\u4e2d\u8a13\u7df4\u4e86\u4e00\u7cfb\u5217 Mamba-2 \u6a21\u578b\uff0c\u4ee5\u7d93\u9a57\u4f30\u8a08\u8a9e\u8a00\u5efa\u6a21\u548c\u5bc6\u9470\u6aa2\u7d22\u4e2d\u7684\u905e\u8ff4\u72c0\u614b\u5bb9\u91cf\u3002\u7136\u5f8c\uff0c\u63d0\u51fa\u4e86\u4e09\u7a2e SC \u7de9\u89e3\u65b9\u6cd5\u4f86\u6539\u5584 Mamba-2 \u7684\u9577\u5ea6\u6cdb\u5316\u6027\uff0c\u8b93\u6a21\u578b\u80fd\u5920\u8655\u7406\u8d85\u904e 100 \u842c\u500b\u7b26\u865f\u800c\u4e0d\u6703\u767c\u751f SC\u3002\u6211\u5011\u9084\u767c\u73fe\u5bc6\u9470\u6aa2\u7d22\u4e2d\u7684\u905e\u8ff4\u72c0\u614b\u5bb9\u91cf\u8207\u72c0\u614b\u5927\u5c0f\u5448\u6307\u6578\u6bd4\u4f8b\uff0c\u4e26\u4e14\u6211\u5011\u7d93\u9a57\u8a13\u7df4\u4e86\u4e00\u500b\u5177\u6709 256K \u8108\u7d61\u9577\u5ea6\u8fd1\u4e4e\u5b8c\u7f8e\u7684\u5bc6\u9470\u6aa2\u7d22\u7cbe\u78ba\u5ea6\u7684 Mamba-2 370M\u3002\u9019\u8868\u660e\u57fa\u65bc RNN \u7684\u9577\u8108\u7d61\u5efa\u6a21\u5177\u6709\u5149\u660e\u7684\u672a\u4f86\u3002", "author": "Yingfa Chen et.al.", "authors": "Yingfa Chen, Xinrong Zhang, Shengding Hu, Xu Han, Zhiyuan Liu, Maosong Sun", "id": "2410.07145v1", "paper_url": "http://arxiv.org/abs/2410.07145v1", "repo": "null"}}