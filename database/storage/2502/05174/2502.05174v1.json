{"2502.05174": {"publish_time": "2025-02-07", "title": "MELON: Indirect Prompt Injection Defense via Masked Re-execution and Tool Comparison", "paper_summary": "Recent research has explored that LLM agents are vulnerable to indirect\nprompt injection (IPI) attacks, where malicious tasks embedded in\ntool-retrieved information can redirect the agent to take unauthorized actions.\nExisting defenses against IPI have significant limitations: either require\nessential model training resources, lack effectiveness against sophisticated\nattacks, or harm the normal utilities. We present MELON (Masked re-Execution\nand TooL comparisON), a novel IPI defense. Our approach builds on the\nobservation that under a successful attack, the agent's next action becomes\nless dependent on user tasks and more on malicious tasks. Following this, we\ndesign MELON to detect attacks by re-executing the agent's trajectory with a\nmasked user prompt modified through a masking function. We identify an attack\nif the actions generated in the original and masked executions are similar. We\nalso include three key designs to reduce the potential false positives and\nfalse negatives. Extensive evaluation on the IPI benchmark AgentDojo\ndemonstrates that MELON outperforms SOTA defenses in both attack prevention and\nutility preservation. Moreover, we show that combining MELON with a SOTA prompt\naugmentation defense (denoted as MELON-Aug) further improves its performance.\nWe also conduct a detailed ablation study to validate our key designs.", "paper_summary_zh": "\u8fd1\u671f\u7814\u7a76\u63a2\u7d22\u51fa LLM \u4ee3\u7406\u5bb9\u6613\u53d7\u5230\u95f4\u63a5\u63d0\u793a\u6ce8\u5165 (IPI) \u653b\u51fb\uff0c\u5176\u4e2d\u5d4c\u5165\u5728\u5de5\u5177\u68c0\u7d22\u4fe1\u606f\u4e2d\u7684\u6076\u610f\u4efb\u52a1\u4f1a\u5c06\u4ee3\u7406\u91cd\u5b9a\u5411\u5230\u6267\u884c\u672a\u7ecf\u6388\u6743\u7684\u64cd\u4f5c\u3002\u73b0\u6709\u7684\u9488\u5bf9 IPI \u7684\u9632\u5fa1\u63aa\u65bd\u6709\u5f88\u5927\u7684\u5c40\u9650\u6027\uff1a\u8981\u4e48\u9700\u8981\u57fa\u672c\u7684\u6a21\u578b\u8bad\u7ec3\u8d44\u6e90\uff0c\u8981\u4e48\u7f3a\u4e4f\u5bf9\u590d\u6742\u653b\u51fb\u7684\u6709\u6548\u6027\uff0c\u8981\u4e48\u635f\u5bb3\u6b63\u5e38\u7684\u5b9e\u7528\u7a0b\u5e8f\u3002\u6211\u4eec\u63d0\u51fa\u4e86 MELON\uff08\u63a9\u7801\u91cd\u65b0\u6267\u884c\u548c\u5de5\u5177\u6bd4\u8f83\uff09\uff0c\u4e00\u79cd\u65b0\u9896\u7684 IPI \u9632\u5fa1\u63aa\u65bd\u3002\u6211\u4eec\u7684\u65b9\u6cd5\u5efa\u7acb\u5728\u8fd9\u6837\u7684\u89c2\u5bdf\u4e4b\u4e0a\uff1a\u5728\u6210\u529f\u7684\u653b\u51fb\u4e0b\uff0c\u4ee3\u7406\u7684\u4e0b\u4e00\u6b65\u884c\u52a8\u53d8\u5f97\u4e0d\u518d\u4f9d\u8d56\u4e8e\u7528\u6237\u4efb\u52a1\uff0c\u800c\u66f4\u591a\u5730\u4f9d\u8d56\u4e8e\u6076\u610f\u4efb\u52a1\u3002\u5728\u6b64\u4e4b\u540e\uff0c\u6211\u4eec\u8bbe\u8ba1 MELON \u901a\u8fc7\u91cd\u65b0\u6267\u884c\u4ee3\u7406\u7684\u8f68\u8ff9\u6765\u68c0\u6d4b\u653b\u51fb\uff0c\u8be5\u8f68\u8ff9\u901a\u8fc7\u63a9\u7801\u51fd\u6570\u4fee\u6539\u4e86\u63a9\u7801\u7684\u7528\u6237\u63d0\u793a\u3002\u5982\u679c\u5728\u539f\u59cb\u6267\u884c\u548c\u63a9\u7801\u6267\u884c\u4e2d\u751f\u6210\u7684\u64cd\u4f5c\u76f8\u4f3c\uff0c\u6211\u4eec\u5c31\u4f1a\u8bc6\u522b\u51fa\u653b\u51fb\u3002\u6211\u4eec\u8fd8\u5305\u62ec\u4e09\u4e2a\u5173\u952e\u8bbe\u8ba1\u6765\u51cf\u5c11\u6f5c\u5728\u7684\u8bef\u62a5\u548c\u6f0f\u62a5\u3002\u5728 IPI \u57fa\u51c6 AgentDojo \u4e0a\u8fdb\u884c\u7684\u5e7f\u6cdb\u8bc4\u4f30\u8868\u660e\uff0cMELON \u5728\u653b\u51fb\u9884\u9632\u548c\u5b9e\u7528\u7a0b\u5e8f\u4fdd\u7559\u65b9\u9762\u90fd\u4f18\u4e8e SOTA \u9632\u5fa1\u63aa\u65bd\u3002\u6b64\u5916\uff0c\u6211\u4eec\u8868\u660e\u5c06 MELON \u4e0e SOTA \u63d0\u793a\u589e\u5f3a\u9632\u5fa1\u63aa\u65bd\uff08\u8868\u793a\u4e3a MELON-Aug\uff09\u76f8\u7ed3\u5408\u53ef\u4ee5\u8fdb\u4e00\u6b65\u63d0\u9ad8\u5176\u6027\u80fd\u3002\u6211\u4eec\u8fd8\u8fdb\u884c\u4e86\u8be6\u7ec6\u7684\u6d88\u878d\u7814\u7a76\u6765\u9a8c\u8bc1\u6211\u4eec\u7684\u5173\u952e\u8bbe\u8ba1\u3002", "author": "Kaijie Zhu et.al.", "authors": "Kaijie Zhu, Xianjun Yang, Jindong Wang, Wenbo Guo, William Yang Wang", "id": "2502.05174v1", "paper_url": "http://arxiv.org/abs/2502.05174v1", "repo": "null"}}