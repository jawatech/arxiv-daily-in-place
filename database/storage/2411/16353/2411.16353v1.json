{"2411.16353": {"publish_time": "2024-11-25", "title": "The Two-Hop Curse: LLMs trained on A->B, B->C fail to learn A-->C", "paper_summary": "While LLMs excel at multi-hop questions (e.g. \"Who is the spouse of the\nperformer of Imagine?\") when using chain-of-thought reasoning (CoT), they\nstruggle when forced to reason internally (without CoT). Previous work on the\nsize and nature of this gap produced mixed evidence with inconclusive results.\nIn this paper, we introduce a controlled setting for investigating two-hop\nreasoning in LLMs, where the above-chance performance constitutes undeniable\nevidence for latent reasoning. We fine-tune LLMs (including Llama 3 8B Instruct\nand GPT-4o) on fictional facts and confirm that they generalize to answering\ntwo-hop questions about them using CoT. We find that models can perform latent\nreasoning when facts appear together during training or in the prompt. However,\nto our surprise, models completely fail at two-hop reasoning without CoT when\nlearned facts only appear in different documents, achieving chance-level\naccuracy and chance-level test loss. We call this complete failure to compose\nseparately learned facts the Two-Hop Curse. Moreover, we evaluate 9 frontier\nLLMs on real-world facts, finding that models completely fail at two-hop no-CoT\nreasoning for over half of question categories while maintaining partial\nsuccess with CoT across most categories. These results suggest that LLMs lack a\ngeneral capability for latent multi-hop reasoning independent of the question\ntype.", "paper_summary_zh": "\u5927\u578b\u8a9e\u8a00\u6a21\u578b\u5728\u591a\u8df3\u554f\u984c\uff08\u4f8b\u5982\u300c\u6f14\u5531 Imagine \u7684\u8868\u6f14\u8005\u7684\u914d\u5076\u662f\u8ab0\uff1f\u300d\uff09\u4e0a\u8868\u73fe\u51fa\u8272\uff0c\u4f7f\u7528\u601d\u8003\u93c8\uff08CoT\uff09\u63a8\u7406\u6642\uff0c\u4f46\u7576\u88ab\u8feb\u5728\u5167\u90e8\u63a8\u7406\uff08\u6c92\u6709 CoT\uff09\u6642\uff0c\u5b83\u5011\u6703\u9677\u5165\u56f0\u5883\u3002\u5148\u524d\u5c0d\u6b64\u5dee\u8ddd\u7684\u5927\u5c0f\u548c\u6027\u8cea\u7684\u7814\u7a76\u7522\u751f\u4e86\u4e0d\u540c\u7684\u8b49\u64da\uff0c\u7d50\u679c\u6c92\u6709\u5b9a\u8ad6\u3002\u5728\u672c\u6587\u4e2d\uff0c\u6211\u5011\u5f15\u5165\u4e86\u4e00\u500b\u53d7\u63a7\u8a2d\u5b9a\uff0c\u7528\u65bc\u8abf\u67e5\u5927\u578b\u8a9e\u8a00\u6a21\u578b\u4e2d\u7684\u5169\u8df3\u63a8\u7406\uff0c\u5176\u4e2d\u9ad8\u65bc\u6a5f\u6703\u7684\u8868\u73fe\u69cb\u6210\u6f5b\u5728\u63a8\u7406\u7684\u7121\u53ef\u8faf\u99c1\u7684\u8b49\u64da\u3002\u6211\u5011\u5fae\u8abf\u5927\u578b\u8a9e\u8a00\u6a21\u578b\uff08\u5305\u62ec Llama 3 8B Instruct \u548c GPT-4o\uff09\u7684\u865b\u69cb\u4e8b\u5be6\uff0c\u4e26\u78ba\u8a8d\u5b83\u5011\u53ef\u4ee5\u6982\u62ec\u70ba\u4f7f\u7528 CoT \u56de\u7b54\u6709\u95dc\u5b83\u5011\u7684\u5169\u8df3\u554f\u984c\u3002\u6211\u5011\u767c\u73fe\uff0c\u7576\u4e8b\u5be6\u51fa\u73fe\u5728\u8a13\u7df4\u671f\u9593\u6216\u63d0\u793a\u4e2d\u6642\uff0c\u6a21\u578b\u53ef\u4ee5\u57f7\u884c\u6f5b\u5728\u63a8\u7406\u3002\u7136\u800c\uff0c\u4ee4\u6211\u5011\u9a5a\u8a1d\u7684\u662f\uff0c\u7576\u5b78\u7fd2\u5230\u7684\u4e8b\u5be6\u50c5\u51fa\u73fe\u5728\u4e0d\u540c\u7684\u6587\u4ef6\u4e2d\u6642\uff0c\u6a21\u578b\u5728\u6c92\u6709 CoT \u7684\u60c5\u6cc1\u4e0b\u5b8c\u5168\u7121\u6cd5\u9032\u884c\u5169\u8df3\u63a8\u7406\uff0c\u9054\u5230\u6a5f\u6703\u6c34\u5e73\u7684\u6e96\u78ba\u6027\u548c\u6a5f\u6703\u6c34\u5e73\u7684\u6e2c\u8a66\u640d\u5931\u3002\u6211\u5011\u5c07\u9019\u7a2e\u5b8c\u5168\u7121\u6cd5\u7d44\u5408\u55ae\u7368\u5b78\u7fd2\u7684\u4e8b\u5be6\u7a31\u70ba\u5169\u8df3\u8a5b\u5492\u3002\u6b64\u5916\uff0c\u6211\u5011\u5728\u73fe\u5be6\u4e16\u754c\u7684\u4e8b\u5be6\u4e0a\u8a55\u4f30\u4e86 9 \u500b\u524d\u6cbf\u5927\u578b\u8a9e\u8a00\u6a21\u578b\uff0c\u767c\u73fe\u6a21\u578b\u5728\u8d85\u904e\u4e00\u534a\u7684\u554f\u984c\u985e\u5225\u4e2d\u5b8c\u5168\u7121\u6cd5\u9032\u884c\u5169\u8df3\u7121 CoT \u63a8\u7406\uff0c\u540c\u6642\u5728\u5927\u591a\u6578\u985e\u5225\u4e2d\u4f7f\u7528 CoT \u4fdd\u6301\u90e8\u5206\u6210\u529f\u3002\u9019\u4e9b\u7d50\u679c\u8868\u660e\uff0c\u5927\u578b\u8a9e\u8a00\u6a21\u578b\u7f3a\u4e4f\u7368\u7acb\u65bc\u554f\u984c\u985e\u578b\u7684\u6f5b\u5728\u591a\u8df3\u63a8\u7406\u7684\u4e00\u822c\u80fd\u529b\u3002", "author": "Mikita Balesni et.al.", "authors": "Mikita Balesni, Tomek Korbak, Owain Evans", "id": "2411.16353v1", "paper_url": "http://arxiv.org/abs/2411.16353v1", "repo": "null"}}