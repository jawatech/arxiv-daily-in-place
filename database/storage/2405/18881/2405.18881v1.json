{"2405.18881": {"publish_time": "2024-05-29", "title": "Tuning-Free Alignment of Diffusion Models with Direct Noise Optimization", "paper_summary": "In this work, we focus on the alignment problem of diffusion models with a\ncontinuous reward function, which represents specific objectives for downstream\ntasks, such as improving human preference. The central goal of the alignment\nproblem is to adjust the distribution learned by diffusion models such that the\ngenerated samples maximize the target reward function. We propose a novel\nalignment approach, named Direct Noise Optimization (DNO), that optimizes the\ninjected noise during the sampling process of diffusion models. By design, DNO\nis tuning-free and prompt-agnostic, as the alignment occurs in an online\nfashion during generation. We rigorously study the theoretical properties of\nDNO and also propose variants to deal with non-differentiable reward functions.\nFurthermore, we identify that naive implementation of DNO occasionally suffers\nfrom the out-of-distribution reward hacking problem, where optimized samples\nhave high rewards but are no longer in the support of the pretrained\ndistribution. To remedy this issue, we leverage classical high-dimensional\nstatistics theory and propose to augment the DNO loss with certain probability\nregularization. We conduct extensive experiments on several popular reward\nfunctions trained on human feedback data and demonstrate that the proposed DNO\napproach achieves state-of-the-art reward scores as well as high image quality,\nall within a reasonable time budget for generation.", "paper_summary_zh": "\u5728\u9019\u9805\u5de5\u4f5c\u4e2d\uff0c\u6211\u5011\u5c08\u6ce8\u65bc\u64f4\u6563\u6a21\u578b\u8207\u9023\u7e8c\u734e\u52f5\u51fd\u6578\u7684\u5c0d\u9f4a\u554f\u984c\uff0c\u8a72\u51fd\u6578\u8868\u793a\u4e0b\u6e38\u4efb\u52d9\u7684\u5177\u9ad4\u76ee\u6a19\uff0c\u4f8b\u5982\u6539\u5584\u4eba\u985e\u504f\u597d\u3002\u5c0d\u9f4a\u554f\u984c\u7684\u6838\u5fc3\u76ee\u6a19\u662f\u8abf\u6574\u64f4\u6563\u6a21\u578b\u6240\u5b78\u7fd2\u7684\u5206\u5e03\uff0c\u4f7f\u5f97\u751f\u6210\u7684\u6a23\u672c\u6700\u5927\u5316\u76ee\u6a19\u734e\u52f5\u51fd\u6578\u3002\u6211\u5011\u63d0\u51fa\u4e86\u4e00\u7a2e\u65b0\u7a4e\u7684\u5c0d\u9f4a\u65b9\u6cd5\uff0c\u7a31\u70ba\u76f4\u63a5\u566a\u8072\u512a\u5316 (DNO)\uff0c\u5b83\u512a\u5316\u4e86\u64f4\u6563\u6a21\u578b\u63a1\u6a23\u904e\u7a0b\u4e2d\u6ce8\u5165\u7684\u566a\u8072\u3002\u6839\u64da\u8a2d\u8a08\uff0cDNO \u662f\u7121\u8abf\u8ae7\u4e14\u63d0\u793a\u7121\u95dc\u7684\uff0c\u56e0\u70ba\u5c0d\u9f4a\u5728\u751f\u6210\u904e\u7a0b\u4e2d\u4ee5\u5728\u7dda\u65b9\u5f0f\u767c\u751f\u3002\u6211\u5011\u56b4\u8b39\u5730\u7814\u7a76\u4e86 DNO \u7684\u7406\u8ad6\u7279\u6027\uff0c\u4e26\u63d0\u51fa\u4e86\u8655\u7406\u4e0d\u53ef\u5fae\u5206\u734e\u52f5\u51fd\u6578\u7684\u8b8a\u9ad4\u3002\u6b64\u5916\uff0c\u6211\u5011\u767c\u73fe DNO \u7684\u5929\u771f\u5be6\u73fe\u5076\u723e\u6703\u906d\u53d7\u5206\u5e03\u5916\u734e\u52f5\u7834\u89e3\u554f\u984c\uff0c\u5176\u4e2d\u512a\u5316\u7684\u6a23\u672c\u5177\u6709\u9ad8\u734e\u52f5\uff0c\u4f46\u4e0d\u518d\u53d7\u904e\u8a13\u7df4\u5206\u5e03\u7684\u652f\u6301\u3002\u70ba\u4e86\u89e3\u6c7a\u6b64\u554f\u984c\uff0c\u6211\u5011\u5229\u7528\u7d93\u5178\u7684\u9ad8\u7dad\u7d71\u8a08\u7406\u8ad6\uff0c\u4e26\u63d0\u51fa\u7528\u67d0\u500b\u6a5f\u7387\u6b63\u5247\u5316\u4f86\u64f4\u5145 DNO \u640d\u5931\u3002\u6211\u5011\u5c0d\u5728\u4eba\u985e\u56de\u994b\u8cc7\u6599\u4e0a\u8a13\u7df4\u7684\u5e7e\u500b\u6d41\u884c\u734e\u52f5\u51fd\u6578\u9032\u884c\u4e86\u5ee3\u6cdb\u7684\u5be6\u9a57\uff0c\u4e26\u8b49\u660e\u6240\u63d0\u51fa\u7684 DNO \u65b9\u6cd5\u9054\u5230\u4e86\u6700\u5148\u9032\u7684\u734e\u52f5\u5206\u6578\u4ee5\u53ca\u9ad8\u5f71\u50cf\u54c1\u8cea\uff0c\u6240\u6709\u9019\u4e9b\u90fd\u5728\u5408\u7406\u7684\u751f\u6210\u6642\u9593\u9810\u7b97\u5167\u3002", "author": "Zhiwei Tang et.al.", "authors": "Zhiwei Tang, Jiangweizhi Peng, Jiasheng Tang, Mingyi Hong, Fan Wang, Tsung-Hui Chang", "id": "2405.18881v1", "paper_url": "http://arxiv.org/abs/2405.18881v1", "repo": "null"}}