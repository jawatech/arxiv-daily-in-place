{"2407.09093": {"publish_time": "2024-07-12", "title": "On Exact Bit-level Reversible Transformers Without Changing Architectures", "paper_summary": "In the literature, various reversible deep neural networks (DNN) models have\nbeen proposed to reduce memory consumption or improve data-throughput in the\ntraining process. However, almost all existing reversible DNNs either are\nconstrained to have special structures or are constructed by modifying the\noriginal DNN architectures considerably to enable reversibility. In this work,\nwe propose exact bit-level reversible transformers without changing the\narchitectures in the inference procedure. The basic idea is to first treat each\ntransformer block as the Euler integration approximation for solving an\nordinary differential equation (ODE) and then incorporate the technique of\nbidirectional integration approximation (BDIA) (see [26]) for BDIA-based\ndiffusion inversion) into the neural architecture together with activation\nquantization to make it exactly bit-level reversible, referred to as\nBDIA-transformer. In the training process, we let a hyper-parameter $\\gamma$ in\nBDIA-transformer randomly take one of the two values $\\{0.5, -0.5\\}$ per\ntransformer block for averaging two consecutive integration approximations,\nwhich regularizes the models for improving the validation accuracy.\nLight-weight side information per transformer block is required to be stored in\nthe forward process to account for binary quantization loss to enable exact\nbit-level reversibility. In the inference procedure, the expectation\n$\\mathbb{E}(\\gamma)=0$ is taken to make the resulting architectures of\nBDIA-transformer be identical to transformers up to activation quantization.\nEmpirical study indicates that BDIA-transformers outperform their original\ncounterparts notably due to the regularization effect of the $\\gamma$\nparameter.", "paper_summary_zh": "<paragraph>\u5728\u6587\u737b\u4e2d\uff0c\u5df2\u63d0\u51fa\u5404\u7a2e\u53ef\u9006\u6df1\u5ea6\u795e\u7d93\u7db2\u8def (DNN) \u6a21\u578b\uff0c\u4ee5\u6e1b\u5c11\u8a13\u7df4\u904e\u7a0b\u4e2d\u8a18\u61b6\u9ad4\u6d88\u8017\u6216\u6539\u5584\u8cc7\u6599\u50b3\u8f38\u91cf\u3002\u7136\u800c\uff0c\u5e7e\u4e4e\u6240\u6709\u73fe\u6709\u7684\u53ef\u9006 DNN \u7686\u53d7\u9650\u65bc\u5177\u6709\u7279\u6b8a\u7d50\u69cb\uff0c\u6216\u900f\u904e\u5927\u5e45\u4fee\u6539\u539f\u59cb DNN \u67b6\u69cb\u4f86\u5efa\u69cb\uff0c\u4ee5\u5be6\u73fe\u53ef\u9006\u6027\u3002\u5728\u9019\u9805\u5de5\u4f5c\u4e2d\uff0c\u6211\u5011\u63d0\u51fa\u7cbe\u78ba\u4f4d\u5143\u7d1a\u53ef\u9006Transformer\uff0c\u800c\u4e0d\u6703\u5728\u63a8\u7406\u7a0b\u5e8f\u4e2d\u8b8a\u66f4\u67b6\u69cb\u3002\u57fa\u672c\u6982\u5ff5\u662f\u9996\u5148\u5c07\u6bcf\u500bTransformer\u5340\u584a\u8996\u70ba\u6b50\u62c9\u7a4d\u5206\u8fd1\u4f3c\uff0c\u7528\u65bc\u6c42\u89e3\u5e38\u5fae\u5206\u65b9\u7a0b\u5f0f (ODE)\uff0c\u7136\u5f8c\u5c07\u96d9\u5411\u7a4d\u5206\u8fd1\u4f3c (BDIA) \u6280\u8853\uff08\u8acb\u53c3\u95b1 [26]\uff09\u7528\u65bc\u57fa\u65bc BDIA \u7684\u64f4\u6563\u53cd\u6f14\uff09\u7d0d\u5165\u795e\u7d93\u67b6\u69cb\uff0c\u4e26\u7d50\u5408\u555f\u7528\u91cf\u5316\uff0c\u4f7f\u5176\u6210\u70ba\u7cbe\u78ba\u4f4d\u5143\u7d1a\u53ef\u9006\uff0c\u7a31\u70ba BDIA Transformer\u3002\u5728\u8a13\u7df4\u904e\u7a0b\u4e2d\uff0c\u6211\u5011\u8b93 BDIA Transformer\u4e2d\u7684\u8d85\u53c3\u6578 $\\gamma$ \u96a8\u6a5f\u53d6\u5169\u500b\u503c $\\{0.5, -0.5\\}$ \u4e2d\u7684\u4e00\u500b\uff0c\u6bcf\u500bTransformer\u5340\u584a\u7528\u65bc\u5e73\u5747\u5169\u500b\u9023\u7e8c\u7684\u7a4d\u5206\u8fd1\u4f3c\uff0c\u9019\u6703\u8abf\u6574\u6a21\u578b\u4ee5\u63d0\u9ad8\u9a57\u8b49\u6e96\u78ba\u5ea6\u3002\u9700\u8981\u5728\u524d\u9032\u904e\u7a0b\u4e2d\u5132\u5b58\u6bcf\u500bTransformer\u5340\u584a\u7684\u8f15\u91cf\u7d1a\u5074\u908a\u8cc7\u8a0a\uff0c\u4ee5\u8003\u91cf\u4e8c\u9032\u5236\u91cf\u5316\u640d\u5931\uff0c\u4ee5\u5be6\u73fe\u7cbe\u78ba\u4f4d\u5143\u7d1a\u53ef\u9006\u6027\u3002\u5728\u63a8\u7406\u904e\u7a0b\u4e2d\uff0c\u53d6\u671f\u671b\u503c $\\mathbb{E}(\\gamma)=0$\uff0c\u4ee5\u4f7f BDIA Transformer\u7684\u6700\u7d42\u67b6\u69cb\u8207Transformer\u76f8\u540c\uff0c\u76f4\u81f3\u555f\u7528\u91cf\u5316\u3002\u5be6\u8b49\u7814\u7a76\u8868\u660e\uff0cBDIA Transformer\u7531\u65bc $\\gamma$ \u53c3\u6578\u7684\u6b63\u5247\u5316\u6548\u679c\uff0c\u660e\u986f\u512a\u65bc\u5176\u539f\u59cb\u5c0d\u61c9\u9805\u3002</paragraph>", "author": "Guoqiang Zhang et.al.", "authors": "Guoqiang Zhang, J. P. Lewis, W. B. Kleijn", "id": "2407.09093v1", "paper_url": "http://arxiv.org/abs/2407.09093v1", "repo": "null"}}