{"2406.14088": {"publish_time": "2024-06-20", "title": "ReaLHF: Optimized RLHF Training for Large Language Models through Parameter Reallocation", "paper_summary": "Reinforcement Learning from Human Feedback (RLHF) stands as a pivotal\ntechnique in empowering large language model (LLM) applications. Since RLHF\ninvolves diverse computational workloads and intricate dependencies among\nmultiple LLMs, directly adopting parallelization techniques from supervised\ntraining can result in sub-optimal performance. To overcome this limitation, we\npropose a novel approach named parameter ReaLlocation, which dynamically\nredistributes LLM parameters in the cluster and adapts parallelization\nstrategies during training. Building upon this idea, we introduce ReaLHF, a\npioneering system capable of automatically discovering and running efficient\nexecution plans for RLHF training given the desired algorithmic and hardware\nconfigurations. ReaLHF formulates the execution plan for RLHF as an augmented\ndataflow graph. Based on this formulation, ReaLHF employs a tailored search\nalgorithm with a lightweight cost estimator to discover an efficient execution\nplan. Subsequently, the runtime engine deploys the selected plan by effectively\nparallelizing computations and redistributing parameters. We evaluate ReaLHF on\nthe LLaMA-2 models with up to $4\\times70$ billion parameters and 128 GPUs. The\nexperiment results showcase ReaLHF's substantial speedups of $2.0-10.6\\times$\ncompared to baselines. Furthermore, the execution plans generated by ReaLHF\nexhibit an average of $26\\%$ performance improvement over heuristic approaches\nbased on Megatron-LM. The source code of ReaLHF is publicly available at\nhttps://github.com/openpsi-project/ReaLHF .", "paper_summary_zh": "\u5f37\u5316\u5b78\u7fd2\u4f86\u81ea\u4eba\u985e\u56de\u994b (RLHF) \u662f\u4e00\u7a2e\u95dc\u9375\u6280\u8853\uff0c\u7528\u65bc\u8ce6\u80fd\u5927\u578b\u8a9e\u8a00\u6a21\u578b (LLM) \u61c9\u7528\u7a0b\u5f0f\u3002\u7531\u65bc RLHF \u6d89\u53ca\u591a\u7a2e\u904b\u7b97\u5de5\u4f5c\u8ca0\u8f09\u548c\u591a\u500b LLM \u4e4b\u9593\u7684\u8907\u96dc\u4f9d\u8cf4\u95dc\u4fc2\uff0c\u76f4\u63a5\u63a1\u7528\u76e3\u7763\u5f0f\u8a13\u7df4\u7684\u5e73\u884c\u5316\u6280\u8853\u53ef\u80fd\u6703\u5c0e\u81f4\u6b21\u4f73\u6548\u80fd\u3002\u70ba\u4e86\u514b\u670d\u9019\u500b\u9650\u5236\uff0c\u6211\u5011\u63d0\u51fa\u4e86\u4e00\u7a2e\u540d\u70ba\u53c3\u6578\u91cd\u65b0\u914d\u7f6e\u7684\u65b0\u65b9\u6cd5\uff0c\u5b83\u6703\u52d5\u614b\u91cd\u65b0\u5206\u914d\u53e2\u96c6\u4e2d\u7684 LLM \u53c3\u6578\uff0c\u4e26\u5728\u8a13\u7df4\u671f\u9593\u8abf\u6574\u5e73\u884c\u5316\u7b56\u7565\u3002\u5728\u6b64\u6982\u5ff5\u7684\u57fa\u790e\u4e0a\uff0c\u6211\u5011\u5f15\u5165\u4e86 ReaLHF\uff0c\u9019\u662f\u4e00\u500b\u958b\u5275\u6027\u7684\u7cfb\u7d71\uff0c\u80fd\u5920\u81ea\u52d5\u767c\u73fe\u4e26\u57f7\u884c RLHF \u8a13\u7df4\u7684\u9ad8\u6548\u57f7\u884c\u8a08\u756b\uff0c\u4e26\u8003\u91cf\u6240\u9700\u7684\u6f14\u7b97\u6cd5\u548c\u786c\u9ad4\u7d44\u614b\u3002ReaLHF \u5c07 RLHF \u7684\u57f7\u884c\u8a08\u756b\u5236\u5b9a\u70ba\u4e00\u500b\u64f4\u589e\u8cc7\u6599\u6d41\u5716\u3002\u57fa\u65bc\u6b64\u5236\u5b9a\uff0cReaLHF \u63a1\u7528\u91cf\u8eab\u6253\u9020\u7684\u641c\u5c0b\u6f14\u7b97\u6cd5\uff0c\u642d\u914d\u8f15\u91cf\u7d1a\u6210\u672c\u4f30\u8a08\u5668\uff0c\u4ee5\u767c\u73fe\u9ad8\u6548\u7684\u57f7\u884c\u8a08\u756b\u3002\u96a8\u5f8c\uff0c\u57f7\u884c\u6642\u9593\u5f15\u64ce\u900f\u904e\u6709\u6548\u5e73\u884c\u5316\u904b\u7b97\u548c\u91cd\u65b0\u5206\u914d\u53c3\u6578\uff0c\u4f86\u90e8\u7f72\u6240\u9078\u7684\u8a08\u756b\u3002\u6211\u5011\u5728 LLaMA-2 \u6a21\u578b\u4e0a\u8a55\u4f30 ReaLHF\uff0c\u8a72\u6a21\u578b\u6700\u591a\u6709 $4\\times70$0 \u5104\u500b\u53c3\u6578\u548c 128 \u500b GPU\u3002\u5be6\u9a57\u7d50\u679c\u986f\u793a\uff0c\u8207\u57fa\u6e96\u76f8\u6bd4\uff0cReaLHF \u7684\u901f\u5ea6\u63d0\u5347\u4e86 $2.0-10.6\\times$\u3002\u6b64\u5916\uff0cReaLHF \u751f\u6210\u7684\u57f7\u884c\u8a08\u756b\u6bd4\u57fa\u65bc Megatron-LM \u7684\u555f\u767c\u5f0f\u65b9\u6cd5\uff0c\u5e73\u5747\u6548\u80fd\u63d0\u5347\u4e86 $26\\%$\u3002ReaLHF \u7684\u539f\u59cb\u7a0b\u5f0f\u78bc\u516c\u958b\u65bc https://github.com/openpsi-project/ReaLHF\u3002", "author": "Zhiyu Mei et.al.", "authors": "Zhiyu Mei, Wei Fu, Kaiwei Li, Guangju Wang, Huanchen Zhang, Yi Wu", "id": "2406.14088v1", "paper_url": "http://arxiv.org/abs/2406.14088v1", "repo": "https://github.com/openpsi-project/realhf"}}