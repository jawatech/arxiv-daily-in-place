{"2408.08146": {"publish_time": "2024-08-15", "title": "KOALA: Enhancing Speculative Decoding for LLM via Multi-Layer Draft Heads with Adversarial Learning", "paper_summary": "Large Language Models (LLMs) exhibit high inference latency due to their\nautoregressive decoding nature. While the draft head in speculative decoding\nmitigates this issue, its full potential remains unexplored. In this paper, we\nintroduce KOALA (K-layer Optimized Adversarial Learning Architecture), an\northogonal approach to the draft head. By transforming the conventional\nsingle-layer draft head into a multi-layer architecture and incorporating\nadversarial learning into the traditional supervised training, KOALA\nsignificantly improves the accuracy of the draft head in predicting subsequent\ntokens, thus more closely mirroring the functionality of LLMs. Although this\nimprovement comes at the cost of slightly increased drafting overhead, KOALA\nsubstantially unlocks the draft head's potential, greatly enhancing speculative\ndecoding. We conducted comprehensive evaluations of KOALA, including both\nautoregressive and non-autoregressive draft heads across various tasks,\ndemonstrating a latency speedup ratio improvement of 0.24x-0.41x, which is\n10.57%-14.09% faster than the original draft heads.", "paper_summary_zh": "\u5927\u578b\u8a9e\u8a00\u6a21\u578b\uff08LLM\uff09\u7531\u65bc\u5176\u81ea\u8ff4\u6b78\u89e3\u78bc\u6027\u8cea\u800c\u5c55\u73fe\u51fa\u9ad8\u63a8\u8ad6\u5ef6\u9072\u3002\u96d6\u7136\u63a8\u6e2c\u89e3\u78bc\u4e2d\u7684\u8349\u7a3f\u982d\u7de9\u89e3\u4e86\u9019\u500b\u554f\u984c\uff0c\u4f46\u5176\u5168\u90e8\u6f5b\u529b\u4ecd\u672a\u88ab\u63a2\u7d22\u3002\u5728\u672c\u6587\u4e2d\uff0c\u6211\u5011\u5f15\u5165\u4e86 KOALA\uff08K \u5c64\u6700\u4f73\u5316\u5c0d\u6297\u5b78\u7fd2\u67b6\u69cb\uff09\uff0c\u9019\u662f\u4e00\u7a2e\u8207\u8349\u7a3f\u982d\u6b63\u4ea4\u7684\u65b9\u6cd5\u3002\u900f\u904e\u5c07\u50b3\u7d71\u7684\u55ae\u5c64\u8349\u7a3f\u982d\u8f49\u63db\u6210\u591a\u5c64\u67b6\u69cb\uff0c\u4e26\u5c07\u5c0d\u6297\u5b78\u7fd2\u7d0d\u5165\u50b3\u7d71\u7684\u76e3\u7763\u8a13\u7df4\u4e2d\uff0cKOALA \u5927\u5e45\u63d0\u5347\u4e86\u8349\u7a3f\u982d\u5728\u9810\u6e2c\u5f8c\u7e8c\u7b26\u865f\u6642\u7684\u6e96\u78ba\u5ea6\uff0c\u56e0\u6b64\u66f4\u63a5\u8fd1\u65bc\u53cd\u6620 LLM \u7684\u529f\u80fd\u3002\u96d6\u7136\u9019\u7a2e\u6539\u9032\u662f\u4ee5\u7565\u5fae\u589e\u52a0\u7684\u8349\u7a3f\u958b\u92b7\u70ba\u4ee3\u50f9\uff0c\u4f46 KOALA \u5927\u5e45\u89e3\u9396\u4e86\u8349\u7a3f\u982d\u7684\u6f5b\u529b\uff0c\u6975\u5927\u5730\u589e\u5f37\u4e86\u63a8\u6e2c\u89e3\u78bc\u3002\u6211\u5011\u5c0d KOALA \u9032\u884c\u4e86\u5168\u9762\u7684\u8a55\u4f30\uff0c\u5305\u62ec\u5404\u7a2e\u4efb\u52d9\u4e2d\u7684\u81ea\u8ff4\u6b78\u548c\u975e\u81ea\u8ff4\u6b78\u8349\u7a3f\u982d\uff0c\u8b49\u660e\u5ef6\u9072\u52a0\u901f\u6bd4\u6539\u9032\u4e86 0.24x-0.41x\uff0c\u6bd4\u539f\u59cb\u8349\u7a3f\u982d\u5feb\u4e86 10.57%-14.09%\u3002", "author": "Kaiqi Zhang et.al.", "authors": "Kaiqi Zhang, Jing Zhao, Rui Chen", "id": "2408.08146v1", "paper_url": "http://arxiv.org/abs/2408.08146v1", "repo": "null"}}