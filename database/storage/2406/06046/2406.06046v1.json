{"2406.06046": {"publish_time": "2024-06-10", "title": "MATES: Model-Aware Data Selection for Efficient Pretraining with Data Influence Models", "paper_summary": "Pretraining data selection has the potential to improve language model\npretraining efficiency by utilizing higher-quality data from massive web data\ncorpora. Current data selection methods, which rely on either hand-crafted\nrules or larger reference models, are conducted statically and do not capture\nthe evolving data preferences during pretraining. In this paper, we introduce\nmodel-aware data selection with data influence models (MATES), where a data\ninfluence model continuously adapts to the evolving data preferences of the\npretraining model and then selects the data most effective for the current\npretraining progress. Specifically, we fine-tune a small data influence model\nto approximate oracle data preference signals collected by locally probing the\npretraining model and to select data accordingly for the next pretraining\nstage. Experiments on Pythia and the C4 dataset demonstrate that MATES\nsignificantly outperforms random data selection on extensive downstream tasks\nin both zero- and few-shot settings. It doubles the gains achieved by recent\ndata selection approaches that leverage larger reference models and reduces the\ntotal FLOPs required to reach certain performances by half. Further analysis\nvalidates the ever-changing data preferences of pretraining models and the\neffectiveness of our data influence models to capture them. Our code is\nopen-sourced at https://github.com/cxcscmu/MATES.", "paper_summary_zh": "\u9810\u8a13\u7df4\u8cc7\u6599\u7684\u9078\u53d6\u6709\u6f5b\u529b\u900f\u904e\u5229\u7528\u4f86\u81ea\u5927\u91cf\u7db2\u8def\u8cc7\u6599\u8a9e\u6599\u5eab\u8f03\u9ad8\u54c1\u8cea\u7684\u8cc7\u6599\u4f86\u63d0\u5347\u8a9e\u8a00\u6a21\u578b\u9810\u8a13\u7df4\u6548\u7387\u3002\u76ee\u524d\u7684\u8cc7\u6599\u9078\u53d6\u65b9\u6cd5\u4ef0\u8cf4\u4eba\u5de5\u898f\u5247\u6216\u8f03\u5927\u7684\u53c3\u8003\u6a21\u578b\uff0c\u63a1\u53d6\u975c\u614b\u57f7\u884c\uff0c\u4e14\u4e0d\u6703\u6355\u6349\u9810\u8a13\u7df4\u671f\u9593\u4e0d\u65b7\u8b8a\u5316\u7684\u8cc7\u6599\u504f\u597d\u3002\u5728\u672c\u6587\u4e2d\uff0c\u6211\u5011\u5f15\u9032\u5177\u5099\u8cc7\u6599\u5f71\u97ff\u6a21\u578b\u7684\u6a21\u578b\u611f\u77e5\u8cc7\u6599\u9078\u53d6\uff08MATES\uff09\uff0c\u5176\u4e2d\u4e00\u500b\u8cc7\u6599\u5f71\u97ff\u6a21\u578b\u6703\u6301\u7e8c\u9069\u61c9\u9810\u8a13\u7df4\u6a21\u578b\u4e0d\u65b7\u8b8a\u5316\u7684\u8cc7\u6599\u504f\u597d\uff0c\u7136\u5f8c\u9078\u53d6\u5c0d\u76ee\u524d\u7684\u9810\u8a13\u7df4\u9032\u5ea6\u6700\u6709\u6548\u7684\u8cc7\u6599\u3002\u5177\u9ad4\u4f86\u8aaa\uff0c\u6211\u5011\u5fae\u8abf\u4e00\u500b\u5c0f\u578b\u8cc7\u6599\u5f71\u97ff\u6a21\u578b\uff0c\u4ee5\u8fd1\u4f3c\u900f\u904e\u5c40\u90e8\u63a2\u6e2c\u9810\u8a13\u7df4\u6a21\u578b\u800c\u6536\u96c6\u7684\u795e\u8aed\u8cc7\u6599\u504f\u597d\u8a0a\u865f\uff0c\u4e26\u64da\u6b64\u70ba\u4e0b\u4e00\u500b\u9810\u8a13\u7df4\u968e\u6bb5\u9078\u53d6\u8cc7\u6599\u3002\u5728 Pythia \u548c C4 \u8cc7\u6599\u96c6\u4e0a\u7684\u5be6\u9a57\u8b49\u660e\uff0cMATES \u5728\u5ee3\u6cdb\u7684\u4e0b\u6e38\u4efb\u52d9\u4e2d\uff0c\u7121\u8ad6\u662f\u96f6\u6b21\u5b78\u7fd2\u6216\u5c11\u6b21\u5b78\u7fd2\u8a2d\u5b9a\uff0c\u90fd\u986f\u8457\u512a\u65bc\u96a8\u6a5f\u8cc7\u6599\u9078\u53d6\u3002\u5b83\u8b93\u63a1\u7528\u8f03\u5927\u53c3\u8003\u6a21\u578b\u7684\u6700\u65b0\u8cc7\u6599\u9078\u53d6\u65b9\u6cd5\u6240\u7372\u5f97\u7684\u6536\u76ca\u52a0\u500d\uff0c\u4e26\u5c07\u9054\u5230\u7279\u5b9a\u6548\u80fd\u6240\u9700\u7684\u7e3d FLOP \u6e1b\u534a\u3002\u9032\u4e00\u6b65\u7684\u5206\u6790\u9a57\u8b49\u4e86\u9810\u8a13\u7df4\u6a21\u578b\u4e0d\u65b7\u8b8a\u5316\u7684\u8cc7\u6599\u504f\u597d\uff0c\u4ee5\u53ca\u6211\u5011\u7684\u8cc7\u6599\u5f71\u97ff\u6a21\u578b\u6355\u6349\u9019\u4e9b\u504f\u597d\u7684\u6709\u6548\u6027\u3002\u6211\u5011\u7684\u7a0b\u5f0f\u78bc\u5728 https://github.com/cxcscmu/MATES \u958b\u6e90\u3002", "author": "Zichun Yu et.al.", "authors": "Zichun Yu, Spandan Das, Chenyan Xiong", "id": "2406.06046v1", "paper_url": "http://arxiv.org/abs/2406.06046v1", "repo": "https://github.com/cxcscmu/mates"}}